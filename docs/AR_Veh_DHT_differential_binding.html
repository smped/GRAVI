<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>AR Differential Binding: DHT Vs. Veh</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="site_libs/react-17.0.0/react.min.js"></script>
<script src="site_libs/react-17.0.0/react-dom.min.js"></script>
<script src="site_libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/reactable-binding-0.2.3/reactable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GRAVI</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Annotations
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="annotation_description.html">Genome and Transcriptome Annotations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    MACS2 Peak Calling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="AR_macs2_summary.html">AR</a>
    </li>
    <li>
      <a href="ER_macs2_summary.html">ER</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Differential Binding
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">AR</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="AR_Veh_DHT_differential_binding.html">DHT Vs. Veh</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">ER</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="ER_Veh_DHT_differential_binding.html">DHT Vs. Veh</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pairwise Comparisons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">AR-ER</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="AR_Veh_DHT_ER_Veh_DHT_pairwise_comparison.html">DHT Vs. Veh / DHT Vs. Veh</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/steveped/GRAVI">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">AR Differential Binding: DHT Vs. Veh</h1>
<h4 class="date">04 April, 2022</h4>

</div>


<pre class="r"><code>target &lt;- &quot;AR&quot;
treat_levels &lt;- c(&quot;Veh&quot;, &quot;DHT&quot;)
threads &lt;- 6</code></pre>
<pre class="r"><code>library(tidyverse)
library(glue)
library(pander)
library(BiocParallel)
library(yaml)
library(plyranges)
library(rtracklayer)
library(GenomeInfoDb)
library(Rsamtools)
library(cowplot)
library(ngsReports)
library(csaw)
library(edgeR)
library(scales)
library(quantro)
library(qsmooth)
library(magrittr)
library(statmod)
library(IHW)
library(ggrepel)
library(rlang)
library(ggside)
library(InteractionSet)
library(GenomicInteractions)
library(reactable)
library(htmltools)
library(msigdbr)
library(goseq)</code></pre>
<pre class="r"><code>if (!&quot;extraChIPs&quot; %in% rownames(installed.packages()))
  BiocManager::install(&quot;steveped/extraChIPs&quot;)

stopifnot(library(extraChIPs, logical.return = TRUE))</code></pre>
<pre class="r"><code>panderOptions(&quot;big.mark&quot;, &quot;,&quot;)
panderOptions(&quot;missing&quot;, &quot;&quot;)
panderOptions(&quot;table.split.table&quot;, Inf)
theme_set(
  theme_bw() +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
)
register(MulticoreParam(workers = threads))
source(here::here(&quot;workflow&quot;, &quot;scripts&quot;, &quot;custom_functions.R&quot;))</code></pre>
<pre class="r"><code>params &lt;- read_yaml(here::here(&quot;config&quot;, &quot;params.yml&quot;))
config &lt;- read_yaml(here::here(&quot;config&quot;, &quot;config.yml&quot;))
samples &lt;- here::here(&quot;output&quot;, target, &quot;qc_samples.tsv&quot;) %&gt;% 
  read_tsv() %&gt;% 
  dplyr::filter(
    qc == &quot;pass&quot;,
    treat %in% treat_levels
  ) %&gt;% 
  mutate(treat = factor(treat, levels = treat_levels)) %&gt;% 
  droplevels()
stopifnot(nrow(samples) &gt; 0)
rep_col &lt;- setdiff(
  colnames(samples), c(&quot;sample&quot;, &quot;treat&quot;, &quot;target&quot;, &quot;input&quot;, &quot;label&quot;, &quot;qc&quot;)
)
samples[[rep_col]] &lt;- as.factor(samples[[rep_col]])
fdr_alpha &lt;- config$comparisons$fdr</code></pre>
<pre class="r"><code>bam_path &lt;- here::here(config$paths$bam)
stopifnot(dir.exists(bam_path))
annotation_path &lt;- here::here(&quot;output&quot;, &quot;annotations&quot;)
stopifnot(dir.exists(annotation_path))
bw_path &lt;- here::here(config$paths$bigwig, target)
stopifnot(dir.exists(bw_path))
out_path &lt;- here::here(&quot;output&quot;, target)
if (!dir.exists(out_path)) dir.create(out_path)</code></pre>
<pre class="r"><code>sq &lt;- file.path(annotation_path, &quot;seqinfo.rds&quot;) %&gt;% 
  read_rds()
blacklist &lt;- here::here(annotation_path, &quot;blacklist.bed.gz&quot;) %&gt;%
  import.bed(seqinfo = sq) %&gt;%
  sort()

cb &lt;- config$genome$build %&gt;% 
  str_to_lower() %&gt;% 
  paste0(&quot;.cytobands&quot;) 
data(list = list(cb))
bands_df &lt;- mget(cb)[[cb]]

stopifnot(
  colnames(bands_df) == c(&quot;chrom&quot;, &quot;chromStart&quot;, &quot;chromEnd&quot;, &quot;name&quot;, &quot;gieStain&quot;)
)

genes_gr &lt;- file.path(annotation_path, &quot;all_gr.rds&quot;) %&gt;% 
  read_rds() %&gt;% 
  .[[&quot;gene&quot;]]
id2gene &lt;- structure(genes_gr$gene_name, names = genes_gr$gene_id)
trans_models &lt;- file.path(annotation_path, &quot;trans_models.rds&quot;) %&gt;% 
  read_rds() 

external_features &lt;- GRanges(seqinfo = sq)
if (!is.null(config$external$features)) {
  external_features &lt;- suppressWarnings(
    import.gff(here::here(config$external$features), genome = sq)
  )
  keep_cols &lt;- !vapply(
    mcols(external_features), function(x) all(is.na(x)), logical(1)
  )
  mcols(external_features) &lt;- mcols(external_features)[keep_cols]
}
has_features &lt;- length(external_features) &gt; 0
gene_regions &lt;- file.path(annotation_path, &quot;gene_regions.rds&quot;) %&gt;% 
  read_rds()
regions &lt;- vapply(gene_regions, function(x) unique(x$region), character(1))
any_detected &lt;- gene_regions %&gt;% 
  vapply(function(x) any(x$detected), logical(1)) %&gt;% 
  any()

rna_path &lt;- here::here(config$external$rnaseq)
rnaseq &lt;- tibble(gene_id = character())
if (length(rna_path) &gt; 0) {
  stopifnot(file.exists(rna_path))
  if (str_detect(rna_path, &quot;tsv$&quot;)) rnaseq &lt;- read_tsv(rna_path)
  if (str_detect(rna_path, &quot;csv$&quot;)) rnaseq &lt;- read_csv(rna_path)
  if (!&quot;gene_id&quot; %in% colnames(rnaseq)) stop(&quot;Supplied RNA-Seq data must contain the column &#39;gene_id&#39;&quot;)
}
tx_col &lt;- intersect(c(&quot;tx_id&quot;, &quot;transcript_id&quot;), colnames(rnaseq))
rna_gr_col &lt;- ifelse(length(tx_col) &gt; 0, &quot;transcript_id&quot;, &quot;gene_id&quot;)
rna_col &lt;- c(tx_col, &quot;gene_id&quot;)[[1]]</code></pre>
<pre class="r"><code>colours &lt;- read_rds(here::here(&quot;output&quot;, &quot;annotations&quot;, &quot;colours.rds&quot;)) %&gt;% 
  lapply(unlist)
region_colours &lt;- setNames(colours$regions, regions[names(colours$regions)])
if (has_features)
  feature_colours &lt;- setNames(
    colours$features, str_sep_to_title(names(colours$features))
  )
direction_colours &lt;- colours$direction %&gt;% 
  setNames(str_to_title(names(.))) %&gt;% 
  .[c(&quot;Up&quot;, &quot;Down&quot;, &quot;Unchanged&quot;)]
treat_colours &lt;- colours$treat[treat_levels]</code></pre>
<pre class="r"><code>hic &lt;- GInteractions()
hic_path &lt;- here::here(config$external$hic)
has_hic &lt;- FALSE
if (length(hic_path) &gt; 0)
  if (file.exists(hic_path)) {
    has_hic &lt;- TRUE
    hic &lt;- makeGenomicInteractionsFromFile(hic_path, type = &quot;bedpe&quot;)
    reg_combs &lt;- expand.grid(regions, regions) %&gt;% 
      as.matrix() %&gt;% 
      apply(
        MARGIN = 1, 
        function(x) {
          x &lt;- sort(factor(x, levels = regions))
          paste(as.character(x), collapse = &quot; - &quot;)
        }
      ) %&gt;% 
      unique()
    hic$regions &lt;- anchors(hic) %&gt;% 
      vapply(
        bestOverlap,
        y = GRangesList(lapply(gene_regions, granges)),
        character(length(hic))
      ) %&gt;% 
      apply(MARGIN = 2, function(x) regions[x]) %&gt;% 
      apply(
        MARGIN = 1, 
        function(x) {
          x &lt;- sort(factor(x, levels = regions))
          paste(as.character(x), collapse = &quot; - &quot;)
        }
      ) %&gt;% 
      factor(levels = reg_combs) %&gt;%
      fct_relabel(
        str_replace_all,
        pattern = &quot;Promoter \\([0-9kbp/\\+-]+\\)&quot;, replacement = &quot;Promoter&quot;
      )
    if (has_features) {
      feat_combs &lt;- expand.grid(names(feature_colours), names(feature_colours)) %&gt;% 
        as.matrix() %&gt;% 
        apply(
          MARGIN = 1, 
          function(x) {
            x &lt;- sort(factor(x, levels = names(feature_colours)))
            paste(as.character(x), collapse = &quot; - &quot;)
          }
        ) %&gt;% 
        unique()
      hic$features &lt;- vapply(
        anchors(hic),
        function(x) bestOverlap(
          x, external_features, var = &quot;feature&quot;, missing = &quot;no_feature&quot;
        ),
        character(length(hic))
      )  %&gt;% 
        apply(
          MARGIN = 1, 
          function(x) {
            x &lt;- sort(factor(x, levels = names(feature_colours)))
            paste(as.character(x), collapse = &quot; - &quot;)
          }
        ) %&gt;% 
        factor(levels = feat_combs) %&gt;%
        fct_relabel(str_sep_to_title, pattern = &quot;_&quot;)
    }
  }
stopifnot(is(hic, &quot;GInteractions&quot;))
seqlevels(hic) &lt;- seqlevels(sq)
seqinfo(hic) &lt;- sq
hic &lt;- hic[!overlapsAny(hic, blacklist)]</code></pre>
<pre class="r"><code>facet_labeller &lt;- as_labeller(
  c(
    c(
      `TRUE` = &quot;Consensus Peak&quot;,
      `FALSE` = &quot;No Consensus Peak&quot;
    ),
    structure(treat_levels, names = treat_levels),
    c(
      Up = glue(&quot;Increased {target} Binding&quot;),
      Down = glue(&quot;Decreased {target} Binding&quot;)
    ),
    c(
      AveExpr = &quot;logCPM&quot;, logFC = &quot;logFC&quot;
    )
  )
)</code></pre>
<pre class="r"><code>all_out &lt;- list(
  results = file.path(
    out_path, 
    glue(&quot;{treat_levels[[1]]}_{treat_levels[[2]]}_differential_binding.rds&quot;)
  ),
  csv = file.path(
    out_path, 
    glue(&quot;{target}_{treat_levels[[1]]}_{treat_levels[[2]]}_differential_binding.csv&quot;)
  ),
  windows  = file.path(
    out_path,
    glue(&quot;{treat_levels[[1]]}_{treat_levels[[2]]}_filtered_windows.rds&quot;)
  ),
  up_regions = file.path(
    out_path, glue(&quot;{treat_levels[[1]]}_{treat_levels[[2]]}_up.bed&quot;)
  ),
  down_regions = file.path(
    out_path, glue(&quot;{treat_levels[[1]]}_{treat_levels[[2]]}_down.bed&quot;)
  ),
  renv = here::here(
    &quot;output/envs&quot;,
    glue(
      &quot;{target}_{treat_levels[[1]]}_{treat_levels[[2]]}_differential_binding.RData&quot;
    )
  )
)</code></pre>
<div id="data-preparation" class="section level1">
<h1>Data Preparation</h1>
<pre class="r"><code>consensus_peaks &lt;- here::here(&quot;output&quot;, target, &quot;consensus_peaks.bed&quot;) %&gt;%
    import.bed(seqinfo = sq)</code></pre>
<pre class="r"><code>bfl &lt;- bam_path %&gt;%
  file.path(target, glue(&quot;{samples$sample}.bam&quot;)) %&gt;%
  c(
    file.path(bam_path, &quot;Input&quot;, glue(&quot;{unique(samples$input)}.bam&quot;))
  ) %&gt;% 
  BamFileList() %&gt;%
  setNames(c(samples$sample, unique(samples$input)))</code></pre>
<pre class="r"><code>ys &lt;- 1000
bfl_summary &lt;- bfl %&gt;%
    bplapply(
        function(x) {
            yieldSize(x) &lt;- ys
            sbp &lt;- ScanBamParam(what = c(&quot;qwidth&quot;, &quot;mapq&quot;))
            open(x)
            vals &lt;- scanBam(x, param = sbp)[[1]]
            close(x)
            list(as_tibble(vals))
        }
    ) %&gt;% 
    as_tibble() %&gt;%
    pivot_longer(everything(), names_to = &quot;sample&quot;) %&gt;%
    unnest(value) %&gt;% 
    pivot_longer(
        cols = c(&quot;qwidth&quot;, &quot;mapq&quot;),
        names_to = &quot;stat&quot;,
        values_to = &quot;value&quot;
    ) %&gt;%
    left_join(samples, by = &quot;sample&quot;) %&gt;% 
    mutate(
        across(
            all_of(c(&quot;target&quot;, &quot;label&quot;, &quot;treat&quot;)),
            str_replace_na, replacement = &quot;Input&quot;
        ),
        treat = factor(treat, levels = c(&quot;Input&quot;, treat_levels)),
        label = fct_inorder(label)
    ) %&gt;% 
    split(f = .$stat)
anyDups &lt;- bplapply(
    bfl,
    function(x) {
        sbp &lt;- ScanBamParam(
            flag = scanBamFlag(isDuplicate = TRUE),
            which = GRanges(sq)[which.min(seqlengths(sq))],
            what = &quot;qname&quot;
            )
        length(scanBam(x, param = sbp)[[1]]$qname)  &gt; 0
    }
) %&gt;%
  unlist()
anyPE &lt;- bplapply(
    bfl,
    function(x){
        yieldSize(x) &lt;- ys
        open(x)
        flag &lt;- scanBam(x, param=ScanBamParam(what=&quot;flag&quot;))[[1]]$flag
        close(x)
        any(bamFlagTest(flag, &quot;isPaired&quot;))
    }
) %&gt;% 
  unlist()</code></pre>
<p>Taking the first 1,000 alignments, a brief inspection of the Bam Files revealed:</p>
<ul>
<li>Aligned read lengths ranged between 17 and 76. The median length was 76.</li>
<li>MAPQ scores of aligned reads ranged between 11 and 42. The median score was 42.</li>
<li>All bam files have been de-duplicated</li>
<li>All alignments were single-end</li>
</ul>
<div id="sliding-window-counts" class="section level2">
<h2>Sliding Window Counts</h2>
<pre class="r"><code>macs2_merged_logs &lt;- here::here(
    &quot;data&quot;, &quot;macs2&quot;, target, glue(&quot;{treat_levels}_merged_callpeak.log&quot;)
    ) %&gt;%
    importNgsLogs()
fl &lt;- max(macs2_merged_logs$fragment_length)
rp &lt;- readParam(
  pe = ifelse(any(anyPE), &quot;both&quot;, &quot;none&quot;),
  dedup = any(anyDups),
  restrict = seqnames(sq),
  discard = blacklist,
)
win_step &lt;- 10*(1 + fl %/% 30)
win_size &lt;- 3*win_step
window_counts &lt;- windowCounts(
  bam.files = bfl,
  spacing = win_step,
  width = win_size,
  ext = fl,
  filter = length(bfl) - 1,
  param = rp,
  BPPARAM = bpparam()
)
colData(window_counts) &lt;- colData(window_counts) %&gt;% 
  as_tibble(rownames = &quot;sample&quot;) %&gt;% 
  dplyr::select(all_of(c(&quot;sample&quot;, &quot;bam.files&quot;, &quot;totals&quot;, &quot;ext&quot;, &quot;rlen&quot;))) %&gt;% 
  left_join(samples, by = &quot;sample&quot;) %&gt;% 
  mutate(
    treat = fct_explicit_na(treat, &quot;Input&quot;), 
    target = str_replace_na(target, &quot;Input&quot;)
  ) %&gt;% 
  as.data.frame() %&gt;% 
  column_to_rownames(&quot;sample&quot;) %&gt;% 
  DataFrame()
window_counts &lt;- sortSeqlevels(window_counts)
seqinfo(window_counts) &lt;- sq</code></pre>
<p>Using the estimated fragment length of 299nt, a set of genomic sliding windows were defined using a window size of 300bp, sliding in increments of 100bp. With the exclusion of black-listed regions, all alignments within each window were counted for each AR-associated sample, and all relevant input samples. Any windows with fewer than 6 alignments across all samples were discarded, leaving a total of 1,262,642 sliding windows, covering 4% of the reference genome.</p>
<p>These windows were then filtered, discarding windows with low counts.</p>
<pre class="r"><code>filtered_counts &lt;- dualFilter(
  x = window_counts[, samples$sample],
  bg = window_counts[, samples$input],
  ref = consensus_peaks,
  keep.totals = TRUE,
  q = config$comparisons$filter_q
)
colData(filtered_counts) &lt;- droplevels(colData(filtered_counts))
n_max &lt;- min(5e4, nrow(filtered_counts))</code></pre>
<pre class="r"><code>list(
  `Genomic Windows` = window_counts,
  `Retained Windows` = filtered_counts,
  `Consensus Peaks` = consensus_peaks
) %&gt;% 
  lapply(granges) %&gt;% 
  lapply(
    function(x) {
      tibble(
        N = comma(length(x)),
        `Total Width (kb)` = comma(sum(width(reduce(x))) / 1e3),
        `Median Width (bp)` = median(width(x))
      )
    }
  ) %&gt;% 
  lapply(list) %&gt;% 
  as_tibble() %&gt;% 
  pivot_longer(everything(), names_to = &quot;Dataset&quot;) %&gt;% 
  unnest(everything()) %&gt;% 
  left_join(
    tibble(
      Dataset = c(&quot;Retained Windows&quot;, &quot;Consensus Peaks&quot;),
      `Unique (kb)` = c(
        round(sum(width(setdiff(granges(filtered_counts), consensus_peaks))) / 1e3, 1),
        round(sum(width(setdiff(consensus_peaks, granges(filtered_counts)))) / 1e3, 1)
      ),
      `% Unique` = percent(
        1e3*`Unique (kb)` / c(
          sum(width(reduce(granges(filtered_counts)))),
          sum(width(consensus_peaks))
        ),
        0.1
      )
    )
  ) %&gt;% 
  pander(
    justify = &quot;lrrrrr&quot;,
    caption = paste(
      &quot;A dual filtering strategy was used based on retaining&quot;, 
      percent(config$comparisons$filter_q, 0.1), 
      &quot;of genomic windows overlapping the consensus peaks identified by &quot;, 
      &quot;`macs2 callpeak` on merged samples. This approach combined both &quot;, 
      &quot;1) expression percentiles, and 2) signal strength in relation to the input sample.&quot;,
      &quot;The complete set of sliding windows covered the majority of the genome,&quot;,
      &quot;whilst those retained after filtering were focussed on strong binding&quot;,
      &quot;signal. Consensus peaks were as identified by `macs2 callpeak` in a&quot;, 
      &quot;previous step of the workflow.&quot;,
      &quot;Importantly, consensus peaks are non-overlapping, whilst the other two&quot;,
      &quot;datasets are derived from overlapping sliding windows.&quot;,
      &quot;This strategy of filtering the set of initial sliding windows retained&quot;,
      percent(
        1 - sum(width(setdiff(consensus_peaks, rowRanges(filtered_counts)))) / sum(width(consensus_peaks))
      ), 
      &quot;of the genomic regions covered by consensus peaks, with&quot;, 
      percent(
        sum(width(setdiff(rowRanges(filtered_counts), consensus_peaks))) / sum(width(reduce(granges(filtered_counts)))))
      , 
      &quot;of the retained windows being outside genomic regions covered by consensus peaks.&quot;,
      ifelse(
        n_max == 5e4, 
        &quot;For subsequent density and RLE plots, a subsample of 50,000 genomic regions will be used for speed.&quot;, 
        &quot;&quot;
      )
    )
  )</code></pre>
<table>
<caption>A dual filtering strategy was used based on retaining 60.0% of genomic windows overlapping the consensus peaks identified by <code>macs2 callpeak</code> on merged samples. This approach combined both 1) expression percentiles, and 2) signal strength in relation to the input sample. The complete set of sliding windows covered the majority of the genome, whilst those retained after filtering were focussed on strong binding signal. Consensus peaks were as identified by <code>macs2 callpeak</code> in a previous step of the workflow. Importantly, consensus peaks are non-overlapping, whilst the other two datasets are derived from overlapping sliding windows. This strategy of filtering the set of initial sliding windows retained 88% of the genomic regions covered by consensus peaks, with 57% of the retained windows being outside genomic regions covered by consensus peaks.</caption>
<colgroup>
<col width="20%" />
<col width="12%" />
<col width="20%" />
<col width="21%" />
<col width="14%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Dataset</th>
<th align="right">N</th>
<th align="right">Total Width (kb)</th>
<th align="right">Median Width (bp)</th>
<th align="right">Unique (kb)</th>
<th align="right">% Unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Genomic Windows</td>
<td align="right">1,262,642</td>
<td align="right">127,031</td>
<td align="right">300</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">Retained Windows</td>
<td align="right">1,079</td>
<td align="right">163</td>
<td align="right">300</td>
<td align="right">93</td>
<td align="right">57.1%</td>
</tr>
<tr class="odd">
<td align="left">Consensus Peaks</td>
<td align="right">182</td>
<td align="right">80</td>
<td align="right">416.5</td>
<td align="right">9.7</td>
<td align="right">12.2%</td>
</tr>
</tbody>
</table>
</div>
<div id="normalisation" class="section level2 tabset">
<h2 class="tabset">Normalisation</h2>
<pre class="r"><code>qtest &lt;- quantro(
  assay(filtered_counts, &quot;logCPM&quot;),
  groupFactor = filtered_counts$treat
)
pander(
  anova(qtest), 
  caption = paste(
    &quot;*Results from qtest suggesting that the two treatment groups are drawn from&quot;,
    ifelse(
      qtest@anova$`Pr(&gt;F)`[[1]] &lt; 0.05,
      &quot;different distributions.*&quot;,
      &quot;the same distribution.*&quot;
    )
  )
)</code></pre>
<table style="width:87%;">
<caption><em>Results from qtest suggesting that the two treatment groups are drawn from different distributions.</em></caption>
<colgroup>
<col width="25%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>groupFactor</strong></td>
<td align="center">1</td>
<td align="center">5.76</td>
<td align="center">5.76</td>
<td align="center">47.78</td>
<td align="center">0.002298</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">4</td>
<td align="center">0.4822</td>
<td align="center">0.1205</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<pre class="r"><code>qs &lt;-qsmooth(
  assay(filtered_counts, &quot;logCPM&quot;), group_factor = filtered_counts$treat
)
assay(filtered_counts, &quot;qsmooth&quot;) &lt;- qsmoothData(qs)</code></pre>
<p>Smooth-Quantile normalisation was performed, grouping by treatment</p>
<div id="qsmooth-weights" class="section level3">
<h3>QSmooth Weights</h3>
<pre class="r"><code>qsmoothPlotWeights(qs)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-qs-weights-1.png" alt="*Quantile-specific weights used by the Smooth-Quantile normalisation. Low weights indicate expression quantiles which appear to be more specific within a group, whilst higher weights indicate similarity between groups.*" width="960" />
<p class="caption">
<em>Quantile-specific weights used by the Smooth-Quantile normalisation. Low weights indicate expression quantiles which appear to be more specific within a group, whilst higher weights indicate similarity between groups.</em>
</p>
</div>
</div>
<div id="density-plot-sliding-windows" class="section level3">
<h3>Density Plot: Sliding Windows</h3>
<pre class="r"><code>plotAssayDensities(
  window_counts, trans = &quot;log1p&quot;, n_max = n_max, colour = &quot;treat&quot;,
  linetype = &quot;target&quot;
) +
  scale_colour_manual(values = colours$treat) + 
  labs(
    x = &quot;log(counts + 1)&quot;, y = &quot;Density&quot;, colour = &quot;Treat&quot;, linetype = &quot;Target&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-density-windows-1.png" alt="*Density plot for all windows prior to selection of those more likely to contain true signal.*" width="960" />
<p class="caption">
<em>Density plot for all windows prior to selection of those more likely to contain true signal.</em>
</p>
</div>
</div>
<div id="density-plot-logcpm" class="section level3">
<h3>Density Plot: logCPM</h3>
<pre class="r"><code>filtered_counts %&gt;% 
  plotAssayDensities(&quot;logCPM&quot;, colour = &quot;treat&quot;, n_max = n_max) +
  scale_colour_manual(values = treat_colours) +
  labs(colour = &quot;Treat&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-logcpm-densities-1.png" alt="*logCPM distributions for all retained windows prior to smooth quantile normalisation*" width="960" />
<p class="caption">
<em>logCPM distributions for all retained windows prior to smooth quantile normalisation</em>
</p>
</div>
</div>
<div id="density-plot-normalised" class="section level3">
<h3>Density Plot: Normalised</h3>
<pre class="r"><code>filtered_counts %&gt;% 
  plotAssayDensities(&quot;qsmooth&quot;, colour = &quot;treat&quot;, n_max = n_max) +
  scale_colour_manual(values = treat_colours) +
  labs(
    x = &quot;Normalised logCPM&quot;, colour = &quot;Treat&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-qsmooth-densities-1.png" alt="*SQ-normalised logCPM distributions for all retained windows.*" width="960" />
<p class="caption">
<em>SQ-normalised logCPM distributions for all retained windows.</em>
</p>
</div>
</div>
<div id="rle-logcpm" class="section level3">
<h3>RLE: logCPM</h3>
<pre class="r"><code>filtered_counts %&gt;% 
  plotAssayRle(
  &quot;logCPM&quot;, fill = &quot;treat&quot;, rle_group = &quot;treat&quot;, x_col = &quot;label&quot;, n_max = n_max
) +
  geom_hline(yintercept = 0) + 
  facet_grid(.~treat, scales = &quot;free_x&quot;, space = &quot;free_x&quot;) +
  scale_fill_manual(values = treat_colours) +
  labs(x = &quot;Sample&quot;, fill = &quot;Treat&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-rle-logcpm-1.png" alt="*RLE plot showing logCPM values prior to normalisation. RLE values were calculated within each treatment group to account for the potentially different binding dynamics of AR.*" width="960" />
<p class="caption">
<em>RLE plot showing logCPM values prior to normalisation. RLE values were calculated within each treatment group to account for the potentially different binding dynamics of AR.</em>
</p>
</div>
</div>
<div id="rle-normalised" class="section level3">
<h3>RLE: Normalised</h3>
<pre class="r"><code>filtered_counts %&gt;% 
  plotAssayRle(
  &quot;qsmooth&quot;, fill = &quot;treat&quot;, rle_group = &quot;treat&quot;, x_col = &quot;label&quot;, n_max = n_max
) +
  geom_hline(yintercept = 0) + 
  facet_grid(.~treat, scales = &quot;free_x&quot;, space = &quot;free_x&quot;) +
  scale_fill_manual(values = treat_colours) +
  labs(x = &quot;Sample&quot;, fill = &quot;Treat&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-rle-normalised-1.png" alt="*RLE plot showing logCPM values after Smooth Quantile normalisation. RLE values were calculated within each treatment group to account for the potentially different binding dynamics of AR.*" width="960" />
<p class="caption">
<em>RLE plot showing logCPM values after Smooth Quantile normalisation. RLE values were calculated within each treatment group to account for the potentially different binding dynamics of AR.</em>
</p>
</div>
</div>
<div id="pca" class="section level3">
<h3>PCA</h3>
<pre class="r"><code>a &lt;- plotAssayPCA(filtered_counts, &quot;logCPM&quot;, colour = &quot;treat&quot;, label = &quot;label&quot;) +
  scale_colour_manual(values = treat_colours)
b &lt;- plotAssayPCA(filtered_counts, &quot;qsmooth&quot;, colour = &quot;treat&quot;, label = &quot;label&quot;) +
  scale_colour_manual(values = treat_colours) 
plot_grid(
  a + theme(legend.position = &quot;none&quot;), b + theme(legend.position = &quot;none&quot;), 
  get_legend(b + labs(colour = &quot;Treat&quot;)), rel_widths = c(1, 1, 0.2), 
  nrow = 1, labels = c(&quot;A&quot;, &quot;B&quot;)
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-pca-1.png" alt="*PCA plots for A) logCPM and B) SQ-Normalised logCPM*" width="960" />
<p class="caption">
<em>PCA plots for A) logCPM and B) SQ-Normalised logCPM</em>
</p>
</div>
</div>
</div>
</div>
<div id="differential-binding-analysis" class="section level1">
<h1>Differential Binding Analysis</h1>
<div id="primary-analysis" class="section level2 tabset">
<h2 class="tabset">Primary Analysis</h2>
<pre class="r"><code>X &lt;- model.matrix(~treat, data = colData(filtered_counts)) %&gt;%
  set_colnames(str_remove(colnames(.), &quot;treat&quot;))
colData(filtered_counts)$design &lt;- X
paired_cors &lt;- block &lt;- NULL
if (config$comparisons$paired) {
  block &lt;- colData(filtered_counts)[[rep_col]]
  set.seed(1e6)
  ind &lt;- sample.int(nrow(filtered_counts), n_max, replace = FALSE)
  paired_cors &lt;- duplicateCorrelation(
    object = assay(filtered_counts, &quot;qsmooth&quot;)[ind, ],
    design = X,
    block = block
  )$consensus.correlation
}
fc &lt;- ifelse(is.null(config$comparisons$fc), 1, config$comparisons$fc)
fit &lt;- assay(filtered_counts, &quot;qsmooth&quot;) %&gt;%
  lmFit(design = X, block = block, correlation = paired_cors) %&gt;% 
  treat(fc = fc, trend = TRUE, robust = FALSE)
res_cols &lt;- c(&quot;logFC&quot;, &quot;AveExpr&quot;, &quot;t&quot;, &quot;P.Value&quot;, &quot;fdr&quot;)
rowData(filtered_counts) &lt;- rowData(filtered_counts) %&gt;% 
  .[!colnames(.) %in% res_cols] %&gt;% 
  cbind(
    fit %&gt;% 
      topTable(sort.by = &quot;none&quot;, number = Inf) %&gt;% 
      DataFrame() %&gt;% 
      setNames(res_cols)
  )</code></pre>
<p>After SQ-normalisation of logCPM values, the <code>limma-trend</code> method was applied to all retained windows. A simple linear model was fitted taking Veh as the baseline and estimating the effects of DHT on AR binding within each sliding window, incorporating a trended prior-variance. After fitting, hypothesis testing was performed testing:</p>
<p><span class="math display">\[
H_0: -\lambda &lt; \mu &lt; \lambda
\]</span> against <span class="math display">\[
H_A: |\mu| &gt; \lambda
\]</span> where <span class="math inline">\(\mu\)</span> represents the true mean change in AR binding. The value <span class="math inline">\(\lambda =\)</span> 0.26 was chosen as this corresponds to a 20% change in detected signal on the log<sub>2</sub> scale. This is the <code>treat</code> methodology as developed by McCarthy &amp; Smyth, and p-values were obtained for each initial window, before merging adjoining windows.</p>
<pre class="r"><code>merged_results &lt;- mergeByCol(
  filtered_counts, col = &quot;AveExpr&quot;, merge_within = 2 * win_step
) %&gt;% 
  mutate(
    overlaps_ref = overlapsAny(., consensus_peaks),
    direction = case_when(
      n_up == 0 &amp; n_down == 0 ~ &quot;Unchanged&quot;,
      n_up &gt; n_down ~ &quot;Up&quot;,
      n_down &gt; n_up ~ &quot;Down&quot;,
      n_up == n_down ~ &quot;Ambiguous&quot;
    ) %&gt;% 
      factor(levels = c(&quot;Up&quot;, &quot;Down&quot;, &quot;Ambiguous&quot;, &quot;Unchanged&quot;)) %&gt;% 
      droplevels()
  ) </code></pre>
<p>After selection of the 1,079 sliding windows (300bp), these were merged into 261 genomic regions with size ranging from 300 to 1600bp, with the median width being 600bp. Representative estimates of differential binding (i.e. logFC) were taken from the sliding window with the <em>highest average signal</em> across all samples, within each set of windows to be merged. Similarly, p-values from the above tests were also selected from the same sliding window as representative of the merged region. The number of windows showing increased or decreased binding within each merged region were also included, by counting those within each set of windows with p-values lower than the selected window. FDR-adjustment was performed with 249 regions (95.4%) showing significance, based on an FDR-adjusted p-value alone.</p>
<div id="merged-windows" class="section level3">
<h3>Merged Windows</h3>
<pre class="r"><code>merged_results %&gt;% 
  mutate(kb = width / 1e3) %&gt;% 
  as_tibble() %&gt;% 
  mutate(
    overlaps_ref = unlist(facet_labeller(overlaps_ref)) %&gt;% 
      str_replace_all(&quot; Peak&quot;, &quot;\nPeak&quot;)
  ) %&gt;% 
  ggplot(aes(AveExpr, kb)) +
  geom_jitter(
    aes(colour = overlaps_ref), 
    alpha = 0.6, width = 0, height = 0.04
  ) +
  geom_xsideboxplot(
    aes(y = overlaps_ref, fill = overlaps_ref), orientation = &quot;y&quot;
  ) +
  geom_ysideboxplot(
    aes(x = overlaps_ref, fill = overlaps_ref), orientation = &quot;x&quot;
  ) +
  scale_xsidey_discrete() +
  scale_ysidex_discrete() +
  scale_colour_brewer(palette = &quot;Set1&quot;) +
  scale_fill_brewer(palette = &quot;Set1&quot;) +
  labs(
    x = &quot;logCPM&quot;, y = &quot;Merged Window Size (kb)&quot;,
    fill = glue(&quot;{target} Macs2 Peak&quot;), colour = glue(&quot;{target} Macs2 Peak&quot;)
  ) +
  theme(
    axis.title.x = element_text(hjust = 0.45),
    axis.title.y = element_text(hjust = 0.4),
    ggside.axis.text.y = element_text(hjust = 0.5),
    ggside.panel.scale.x = 0.3,
    ggside.panel.scale.y = 0.25,
    legend.position = c(0.9, 0.9)
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-merged-size-1.png" alt="*Comparison of AR signal intensity (logCPM) and merged window size (kb) for windows which overlap a macs2 consensus peak and those which don't. A mall amount of jitter has been added to the y-axis in the lower-left panel.*" width="960" />
<p class="caption">
<em>Comparison of AR signal intensity (logCPM) and merged window size (kb) for windows which overlap a macs2 consensus peak and those which don’t. A mall amount of jitter has been added to the y-axis in the lower-left panel.</em>
</p>
</div>
</div>
<div id="mean-variance-relationship" class="section level3">
<h3>Mean-Variance Relationship</h3>
<pre class="r"><code>tibble(A = fit$Amean, pre = fit$sigma, post = sqrt(fit$s2.post)) %&gt;% 
  sample_n(n_max) %&gt;% 
  pivot_longer(c(&quot;pre&quot;, &quot;post&quot;), names_to = &quot;step&quot;, values_to = &quot;sigma&quot;) %&gt;%
  mutate(step = factor(step, levels = c(&quot;pre&quot;, &quot;post&quot;))) %&gt;% 
  ggplot(aes(A, sigma, colour = step)) +
  geom_point(size = 1, alpha = 0.5) +
  geom_smooth(
    se = FALSE, method = &quot;loess&quot;, formula = y ~ x,
    data = . %&gt;% dplyr::filter(step == &quot;pre&quot;),
    colour = &quot;blue&quot;,
    show.legend = FALSE
  ) +
  labs(
    x = &quot;logCPM&quot;, y = expression(hat(sigma)), colour = &quot;Analytic\nStep&quot;
  ) +
  scale_colour_manual(values = c(pre = &quot;black&quot;, post = &quot;red&quot;)) +
  theme(axis.title.y = element_text(angle = 0, vjust = 0.5))</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-mean-var-1.png" alt="*Mean-variance for all retained windows. Black dots indicate the estimated standard deviation for each window as a function of signal. Red dots are the shrunken estimates after applying limma-trend, whilst the loess curve through the initial estimates is shown in blue.*" width="960" />
<p class="caption">
<em>Mean-variance for all retained windows. Black dots indicate the estimated standard deviation for each window as a function of signal. Red dots are the shrunken estimates after applying limma-trend, whilst the loess curve through the initial estimates is shown in blue.</em>
</p>
</div>
</div>
</div>
<div id="independent-hypothesis-weighting" class="section level2 tabset">
<h2 class="tabset">Independent Hypothesis Weighting</h2>
<pre class="r"><code>ihw_opts &lt;- c(&quot;regions&quot;, &quot;features&quot;, &quot;targets&quot;)
ihw_method &lt;- c(
  intersect(str_to_lower(config$comparisons$ihw), ihw_opts), &quot;none&quot;
)
ihw_method &lt;- ihw_method[[1]]
fdr_column &lt;- str_subset(names(mcols(merged_results)), &quot;fdr|FDR&quot;)
## Add status (direction) for the ihw = &quot;none&quot; possibility
merged_results &lt;- merged_results %&gt;% 
  mutate(
    status = case_when(
      !!sym(fdr_column) &lt; fdr_alpha ~ as.character(direction),
      !!sym(fdr_column) &gt;= fdr_alpha ~ &quot;Unchanged&quot;
    ) %&gt;% 
      factor(levels = str_to_title(names(colours$direction))) %&gt;% 
      fct_drop(only = &quot;Undetected&quot;)
  )</code></pre>
<pre class="r"><code>ihw_all &lt;- gene_regions %&gt;% 
  .[names(.) != &quot;tss&quot;] %&gt;% 
  lapply(
    function(x) propOverlap(merged_results, x)
  ) %&gt;% 
  as_tibble() %&gt;% 
  mutate(
    range = as.character(merged_results), id = seq_along(range)
  ) %&gt;% 
  pivot_longer(
    cols = any_of(names(gene_regions)),
    names_to = &quot;region&quot;,
    values_to = &quot;prop&quot;
  ) %&gt;% 
  group_by(id, range) %&gt;% 
  dplyr::filter(prop == max(prop)) %&gt;% 
  ungroup() %&gt;% 
  distinct(id, range, .keep_all = TRUE) %&gt;% 
  mutate(
    region = factor(region, levels = names(colours$region))
  ) %&gt;% 
  arrange(id) %&gt;% 
  .[[&quot;region&quot;]]
n_levels &lt;- sum(table(ihw_all) &gt; 1e3) - 1
merged_results$ihw_covariate &lt;- fct_lump_n(ihw_all, n = n_levels)
ihw_proceed &lt;- length(levels(merged_results$ihw_covariate)) &gt; 1
if (ihw_proceed)  fdr_column &lt;- &quot;fdr_ihw&quot;
ihw_cols &lt;- colours$regions
if (ihw_proceed) {
  ihw &lt;- ihw(
    pvalues = merged_results$P.Value,
    covariates = merged_results$ihw_covariate,
    alpha &lt;- fdr_alpha,
    covariate_type = &quot;nominal&quot;
  )
  merged_results &lt;- mutate(merged_results, fdr_ihw = adj_pvalues(ihw))
} 
merged_results &lt;- merged_results %&gt;% 
  mutate(
    status = case_when(
      !!sym(fdr_column) &lt; fdr_alpha ~ as.character(direction),
      !!sym(fdr_column) &gt;= fdr_alpha ~ &quot;Unchanged&quot;
    ) %&gt;% 
      factor(levels = str_to_title(names(colours$direction))) %&gt;% 
      fct_drop(only = &quot;Undetected&quot;)
  )</code></pre>
<p>Independent Hypothesis Weighting (IHW) was then used to partition the raw p-values for AR differential binding by genomic regions defined previously, and estimate weights to apply to each p-value as a divisor. This allows recalculation of the FDR using <em>weighted p-values</em> instead of <em>raw p-values</em>. In order for IHW to be a viable strategy, partitions should be greater than 1000. The provided genomic regions were used as initial partitions, merging the smallest groups below this size until all partitions were of a suitable size.</p>
<p>Windows were classified as overlapping a region if any section of the window overlapped the region Where multiple overlapping regions were found, the region with the <em>largest</em> overlap was selected.</p>
<p>Only one partition &gt; 1000 was able to be formed and IHW was not executed.</p>
<div id="initial-group-sizes" class="section level3">
<h3>Initial Group Sizes</h3>
<pre class="r"><code>tibble(ihw = ihw_all) %&gt;% 
  mutate(
    ihw_label = regions[as.character(ihw)] %&gt;% 
      fct_infreq()
  ) %&gt;% 
  ggplot(
    aes(ihw_label, fill = ihw)
  ) +
  geom_bar() +
  geom_hline(yintercept = 1e3, colour = &quot;blue&quot;) +
  geom_text(
    aes(y = n + 0.025*max(n), label = comma(n, 1)),
    data = . %&gt;%
      group_by(ihw_label, ihw) %&gt;%
      summarise(n = dplyr::n(), .groups = &quot;drop&quot;) 
  ) +
  scale_y_continuous(expand = expansion(c(0, 0.05)), labels = comma) +
  scale_fill_manual(values = ihw_cols) +
  labs(x = str_to_title(ihw_method), y = &quot;Total&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/ihw-partitions-raw-1.png" alt="*Breakdown of all windows which overlapped the regions previously defined. Any partitions with fewer than 1000 windows (indicated as the blue horizontal line) were combined into the next smallest partition consecutively, until all partitions contained &gt; 1000 windows.*" width="960" />
<p class="caption">
<em>Breakdown of all windows which overlapped the regions previously defined. Any partitions with fewer than 1000 windows (indicated as the blue horizontal line) were combined into the next smallest partition consecutively, until all partitions contained &gt; 1000 windows.</em>
</p>
</div>
</div>
<div id="p-value-distributions" class="section level3">
<h3>P-Value Distributions</h3>
<pre class="r"><code>lblr &lt;- as_labeller(c(regions, &quot;Other&quot; = &quot;Other&quot;))
y &lt;- ggplot_build(
  tibble(P.Value = merged_results$P.Value,) %&gt;% 
    ggplot(aes(P.Value, stat(density))) + 
    geom_histogram(bins = 100) 
) %&gt;% .[[&quot;data&quot;]] %&gt;% 
  .[[1]] %&gt;% 
  .[[&quot;y&quot;]] %&gt;% 
  max()
merged_results %&gt;% 
  select(P.Value, ihw_covariate) %&gt;% 
  mcols() %&gt;% 
  as_tibble() %&gt;% 
  ggplot(aes(P.Value, stat(density))) +
  geom_histogram(fill = &quot;grey&quot;, colour = &quot;black&quot;, bins = 100) +
  geom_text(
    aes(0.8, y, label = lab),
    data = . %&gt;% 
      group_by(ihw_covariate) %&gt;% 
      summarise(n = dplyr::n(), .groups = &quot;drop&quot;) %&gt;% 
      mutate(
        lab = glue(&quot;N = {comma(n, 1)}&quot;),
        y = y
      )
  ) +
  facet_wrap(~ihw_covariate, ncol = 3, labeller = lblr) +
  scale_y_continuous(expand = expansion(c(0, 0.05))) +
  labs(x = &quot;P Value&quot;, y = &quot;Density&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-ihw-pvals-1.png" alt="*P-Value distributions within all final data partitions. The size of each parition is given within each panel.*" width="960" />
<p class="caption">
<em>P-Value distributions within all final data partitions. The size of each parition is given within each panel.</em>
</p>
</div>
</div>
<div id="ihw-weights" class="section level3">
<h3>IHW Weights</h3>
<pre class="r"><code>plot(ihw) +
  geom_hline(yintercept = 1) +
  facet_wrap(~group, labeller =lblr) +
  scale_y_continuous(expand = expansion(c(0, 0.05))) +
  labs(x = &quot;Fold&quot;, y = &quot;Weight&quot;, fill = &quot;Fold&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-ihw-weights-1.png" alt="*Weights applied to p-values within each partition. 'Folds' represent random sub-partitions within each larger partition generated as part of the IHW process.*" width="960" />
<p class="caption">
<em>Weights applied to p-values within each partition. ‘Folds’ represent random sub-partitions within each larger partition generated as part of the IHW process.</em>
</p>
</div>
</div>
<div id="fdr-comparison" class="section level3">
<h3>FDR Comparison</h3>
<pre class="r"><code>ihw %&gt;%
  as.data.frame() %&gt;% 
  ggplot(
    aes(-log10(pvalue), -log10(weighted_pvalue), colour = fold)
  ) +
  geom_point(size = 0.4) +
  geom_hline(
    aes(yintercept = -log10(weighted_pvalue)),
    data = . %&gt;% 
      dplyr::select(-group) %&gt;% 
      dplyr::filter(adj_pvalue &lt; fdr_alpha) %&gt;% 
      dplyr::filter(weighted_pvalue == max(weighted_pvalue)),
    linetype = 2, colour = &quot;blue&quot;
  ) +
  geom_vline(
    aes(xintercept = -log10(pvalue)),
    data =. %&gt;% 
      dplyr::filter(p.adjust(pvalue, &quot;fdr&quot;) &lt; fdr_alpha) %&gt;% 
      dplyr::filter(pvalue == max(pvalue)) %&gt;% 
      dplyr::select(-group),
    linetype = 2, colour = &quot;blue&quot;
  ) +
  facet_wrap(~group, scales = &quot;free&quot;, labeller = lblr) +
  coord_cartesian(xlim = c(0, 5), ylim = c(0, 5)) +
  labs(
    x = expression(-log[10](p)),
    y = expression(-log[10](p[IHW])),
    colour = &quot;Fold&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-fdr-comparison-1.png" alt="*Comparison of raw and weighted p-values for each partition. Blue dashed lines indicate FDR = 0.05 for each set of p-values. Those in the lower-right qudrant would no longer be considered significant after IHW, whilst those in the upper-left quadrant would only be considered as significant after the IHW process. Those in the upper-right quadrant would be considered as significant regardless of the methodology.*" width="960" />
<p class="caption">
<em>Comparison of raw and weighted p-values for each partition. Blue dashed lines indicate FDR = 0.05 for each set of p-values. Those in the lower-right qudrant would no longer be considered significant after IHW, whilst those in the upper-left quadrant would only be considered as significant after the IHW process. Those in the upper-right quadrant would be considered as significant regardless of the methodology.</em>
</p>
</div>
</div>
<div id="summary-table" class="section level3">
<h3>Summary Table</h3>
<pre class="r"><code>ihw %&gt;%
  as.data.frame() %&gt;% 
  mutate(
    fdr = p.adjust(pvalue, &quot;fdr&quot;),
    status = case_when(
      fdr &lt; fdr_alpha &amp; adj_pvalue &gt; fdr_alpha ~ &quot;Lost&quot;,
      fdr &lt; fdr_alpha &amp; adj_pvalue &lt; fdr_alpha ~ &quot;Retained&quot;,
      fdr &gt; fdr_alpha &amp; adj_pvalue &lt; fdr_alpha ~ &quot;Gained&quot;,
      fdr &gt; fdr_alpha &amp; adj_pvalue &gt; fdr_alpha ~ &quot;Never Significant&quot;
    ) %&gt;% 
      factor(
        levels = c(&quot;Never Significant&quot;, &quot;Retained&quot;, &quot;Gained&quot;, &quot;Lost&quot;)
      )
  ) %&gt;% 
  as_tibble() %&gt;% 
  group_by(covariate, status) %&gt;% 
  tally() %&gt;% 
  ungroup() %&gt;% 
  complete(status = status, covariate = covariate, fill = list(n = 0)) %&gt;% 
  pivot_wider(
    names_from = status, values_from = n, values_fill = 0
  ) %&gt;% 
  mutate(
    covariate = unlist(lblr(covariate)),
    `Nett Change` = Gained - Lost
  ) %&gt;% 
  bind_rows(
    summarise_if(., is.numeric, sum)
  ) %&gt;% 
  mutate(
    covariate = str_replace_na(covariate, &quot;Total&quot;),
    Significant = Retained + Gained
  ) %&gt;% 
  dplyr::select(
    Covariate = covariate, ends_with(&quot;Significant&quot;), Retained, everything()
  ) %&gt;% 
  pander(
    justify = &quot;lrrrrrr&quot;,
    caption = paste(
      &quot;*Summary of changes introduced by IHW for windows considered as&quot;,
      paste0(&quot;differentially bound by &quot;, target, &quot;.&quot;), 
      &quot;This corresponds to a nett change of&quot;, 
        dplyr::slice(., nrow(.)) %&gt;% 
        mutate(p = `Nett Change` / (Significant - `Nett Change`)) %&gt;% 
        .[[&quot;p&quot;]] %&gt;% 
        percent(0.1),
      &quot;from the initial list.*&quot;
    ),
    emphasize.strong.rows = nrow(.)
  )</code></pre>
<table>
<caption><em>Summary of changes introduced by IHW for windows considered as differentially bound by AR. This corresponds to a nett change of 0.0% from the initial list.</em></caption>
<colgroup>
<col width="13%" />
<col width="22%" />
<col width="15%" />
<col width="12%" />
<col width="10%" />
<col width="9%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Covariate</th>
<th align="right">Never Significant</th>
<th align="right">Significant</th>
<th align="right">Retained</th>
<th align="right">Gained</th>
<th align="right">Lost</th>
<th align="right">Nett Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Exon</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Other</td>
<td align="right">12</td>
<td align="right">240</td>
<td align="right">240</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left"><strong>Total</strong></td>
<td align="right"><strong>12</strong></td>
<td align="right"><strong>249</strong></td>
<td align="right"><strong>249</strong></td>
<td align="right"><strong>0</strong></td>
<td align="right"><strong>0</strong></td>
<td align="right"><strong>0</strong></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="mapping-windows" class="section level2">
<h2>Mapping Windows</h2>
<pre class="r"><code>merged_results &lt;- merged_results %&gt;% 
  mutate(
    region = bestOverlap(
      ., 
      gene_regions %&gt;% 
        lapply(select, region) %&gt;% 
        GRangesList() %&gt;% 
        unlist(),
      var = &quot;region&quot;
    ) %&gt;% 
      factor(levels = regions)
  )</code></pre>
<pre class="r"><code>merged_results &lt;- merged_results %&gt;% 
  mutate(
    feature = bestOverlap(
      ., external_features, &quot;feature&quot;, missing = &quot;no_feature&quot;
    ) %&gt;% 
      factor(levels = names(colours$features)) %&gt;% 
      fct_relabel(str_sep_to_title)
  )</code></pre>
<p>Merged windows were first mapped to the gene-centric region with the largest overlap. Windows were then mapped to the external features provided in the same manner.</p>
<pre class="r"><code>merged_results &lt;- merged_results %&gt;%
  mapByFeature(
    genes = genes_gr, 
    prom = GRangesList(
      ## Add any external features which appear to be promoters
      ifelse(
        &quot;feature&quot; %in% colnames(mcols(external_features)), 
        list(granges(subset(external_features, str_detect(feature, &quot;[Pp]rom&quot;)))), 
        list(GRanges())
      )[[1]], 
      granges(gene_regions$promoters)) %&gt;% 
      unlist() %&gt;% 
      reduce(),
    enh = ifelse(
      &quot;feature&quot; %in% colnames(mcols(external_features)), 
      list(granges(subset(external_features, str_detect(feature, &quot;[Ee]nhanc&quot;)))), 
      list(GRanges())
    )[[1]],
    gi = hic
  ) %&gt;% 
  mutate(
    detected = lapply(
      gene_id,
      function(x) {
        id2gene[intersect(x, rnaseq$gene_id)]
      }
    ) %&gt;% 
      as(&quot;CharacterList&quot;)
  )</code></pre>
<p>In addition to statistical analysis, the regions produced by merging windows were mapped to all annotated genes. Promoters were the union of all regions defined based on transcript-level annotation, and any external features which were defined as promoters. Enhancers were any regions defined in h3k27ac_features.gtf as enhancers. The set of 1338 HiC-interactions were also used to define long-range interactions.</p>
<p>These features were used to map merged windows to features using the process defined in the function <code>mapByFeature()</code>:</p>
<ol style="list-style-type: decimal">
<li>Ranges <em>overlapping a promoter</em> are assigned to genes for that specific promoter</li>
<li>Ranges <em>overlapping an enhancer</em> are assigned to all genes within 100kb</li>
<li>Ranges <em>overlapping a long-range interaction</em> are assigned to all genes connected by the interaction</li>
<li>Ranges with <em>no gene assignment from the previous steps</em> are assigned to all overlapping genes, or the nearest gene within 100kb</li>
</ol>
<p>Notably, genes are only passed to step 4 if no gene assignment has been made in steps 1, 2 or 3. For visualisation purposes, only genes which were considered as detected in any provided RNA-Seq data will be shown as the mapping targets.</p>
</div>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<div id="summary-plots" class="section level2 tabset">
<h2 class="tabset">Summary Plots</h2>
<pre class="r"><code>profile_width &lt;- 5e3
n_bins &lt;- 100
bwfl &lt;- file.path(bw_path, glue(&quot;{treat_levels}_merged_treat_pileup.bw&quot;)) %&gt;% 
  BigWigFileList() %&gt;% 
  setNames(treat_levels) 
sig_ranges &lt;- merged_results %&gt;% 
  filter(!!sym(fdr_column) &lt; fdr_alpha) %&gt;% 
  colToRanges(&quot;keyval_range&quot;) %&gt;% 
  splitAsList(f = .$direction) %&gt;% 
  .[vapply(., length, integer(1)) &gt; 0] 
sig_profiles &lt;- bplapply(
  sig_ranges, 
  function(x) getProfileData(
    bwfl, x, upstream = profile_width / 2, bins = n_bins
  ),
  BPPARAM = MulticoreParam(length(sig_ranges))
)
profile_heatmaps &lt;- sig_profiles %&gt;% 
  bplapply(
    plotProfileHeatmap,
    profileCol = &quot;profile_data&quot;, 
    facetY = &quot;overlaps_ref&quot;,
    colour = &quot;name&quot;,
    linetype = &quot;overlaps_ref&quot;,
    xLab = &quot;Distance from Centre (bp)&quot;,
    fillLab = &quot;CPM&quot;,
    labeller = as_labeller(
        c(
          setNames(treat_levels, treat_levels),
          `TRUE` = &quot;Consensus\nPeak&quot;,
          `FALSE` = &quot;No\nConsensus\nPeak&quot;
        )
    ),
    BPPARAM = MulticoreParam(length(sig_ranges))
  ) 
fill_range &lt;- profile_heatmaps %&gt;% 
  lapply(function(x) x$data[,&quot;score&quot;]) %&gt;% 
  unlist() %&gt;%
  range()
sidey_range &lt;- profile_heatmaps %&gt;% 
  lapply(function(x) x$layers[[3]]$data$y) %&gt;% 
  unlist() %&gt;% 
  range()
profile_heatmaps &lt;- profile_heatmaps %&gt;% 
  lapply(function(x) {
    x + 
      scale_fill_viridis_c(
        option = &quot;inferno&quot;, direction = -1, limits = fill_range
      ) +
      scale_xsidey_continuous(limits = sidey_range) +
      scale_colour_manual(values = treat_colours) +
      scale_linetype_manual(values = c(&quot;TRUE&quot; = 1, &quot;FALSE&quot; = 2)) +
      labs(
        x = &quot;Distance from Centre (bp)&quot;,
        fill = &quot;CPM&quot;, linetype = &quot;Consensus\nPeak\nOverlap&quot;,
        colour = &quot;Treat&quot;
      ) +
      theme(
        strip.text.y = element_text(angle = 0)
      )
  }
  )</code></pre>
<div id="ma-plot" class="section level3">
<h3>MA Plot</h3>
<pre class="r"><code>merged_results %&gt;% 
  as_tibble() %&gt;%
  ggplot(aes(AveExpr, logFC)) +
  geom_point(aes(colour = status), alpha = 0.5) +
  geom_smooth(se = FALSE, method = &quot;gam&quot;, formula = y ~ s(x, bs = &quot;cs&quot;)) +
  geom_hline(yintercept = 0) +
  geom_label_repel(
    aes(y = 1.1*logFC, label = annot, colour = status),
    data= . %&gt;%
      dplyr::filter(logFC == max(logFC) | logFC == min(logFC)) %&gt;%
      mutate(
        detected = detected %&gt;%
          lapply(paste, collapse = &quot;, &quot;) %&gt;%
          unlist() %&gt;%
          str_replace(&quot;^NA$&quot;, &quot;&quot;) %&gt;%
          str_wrap(width = 40),
        range = ifelse(detected == &quot;&quot;, range, paste0(range, &quot;\n&quot;)),
        annot = glue(&quot;{range}{detected}&quot;)
      ),
    fill = rgb(1, 1, 1, 0.2),
    size = 3,
    show.legend = FALSE
  ) +
  facet_grid(
    .~overlaps_ref, 
    scales = &quot;free_x&quot;, space = &quot;free_x&quot;,
    labeller = facet_labeller
  ) +
  scale_colour_manual(values = direction_colours) +
  labs(
    x = &quot;Ave Signal (logCPM)&quot;,
    colour = &quot;Status&quot;
  ) </code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-ma-1.png" alt="*MA plot showing the status of each window under consideration. The two most extreme regions are labelled by region and any associated genes, whilst the overall pattern of association between signal level (logCPM) and changed signal (logFC) is shown as the blue curve. Windows are plotted in separate panels based on those which overlap a `macs2` consensus peak.*" width="960" />
<p class="caption">
<em>MA plot showing the status of each window under consideration. The two most extreme regions are labelled by region and any associated genes, whilst the overall pattern of association between signal level (logCPM) and changed signal (logFC) is shown as the blue curve. Windows are plotted in separate panels based on those which overlap a <code>macs2</code> consensus peak.</em>
</p>
</div>
</div>
<div id="volcano-plot" class="section level3">
<h3>Volcano Plot</h3>
<pre class="r"><code>merged_results %&gt;% 
  as_tibble() %&gt;% 
  ggplot(aes(logFC, -log10(P.Value))) +
  geom_point(aes(colour = status), alpha = 0.6) +
  geom_label_repel(
    aes(label = annot, colour = status),
    data= . %&gt;%
      arrange(sign(logFC)*log10(P.Value)) %&gt;% 
      dplyr::slice(1:2) %&gt;% 
      dplyr::filter(logFC &gt; 1) %&gt;%
      mutate(
        detected = detected %&gt;%
          lapply(paste, collapse = &quot;, &quot;) %&gt;%
          unlist() %&gt;%
          str_replace(&quot;^NA$&quot;, &quot;&quot;) %&gt;%
          str_wrap(width = 40),
        range = ifelse(detected == &quot;&quot;, range, paste0(range, &quot;\n&quot;)),
        annot = glue(&quot;{range}{detected}&quot;)
      ),
    fill = rgb(1, 1, 1, 0.2),
    size = 3,
    show.legend = FALSE
  ) +
  geom_label_repel(
    aes(label = annot, colour = status),
    data= . %&gt;%
      arrange(-sign(logFC)*log10(P.Value)) %&gt;% 
      dplyr::slice(1:2) %&gt;% 
      dplyr::filter(logFC &lt; -1) %&gt;% 
      mutate(
        detected = detected %&gt;%
          lapply(paste, collapse = &quot;, &quot;) %&gt;%
          unlist() %&gt;%
          str_replace(&quot;^NA$&quot;, &quot;&quot;) %&gt;%
          str_wrap(width = 40),
        range = ifelse(detected == &quot;&quot;, range, paste0(range, &quot;\n&quot;)),
        annot = glue(&quot;{range}{detected}&quot;)
      ),
    fill = rgb(1, 1, 1, 0.2),
    size = 3,
    show.legend = FALSE
  ) +
  scale_colour_manual(values = direction_colours) +
  labs(
    x = &quot;logFC&quot;,
    y = expression(paste(-log[10], &quot;p&quot;)),
    colour = &quot;Status&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-volcano-1.png" alt="*Volcano plot showing regions with evidence of differential AR binding. Regions overlapping a consensus peak are coloured separately to those which are not. The most significant regions are labelled along with any genes these regions are mapped to.*" width="960" />
<p class="caption">
<em>Volcano plot showing regions with evidence of differential AR binding. Regions overlapping a consensus peak are coloured separately to those which are not. The most significant regions are labelled along with any genes these regions are mapped to.</em>
</p>
</div>
</div>
<div id="heatmaps-up" class="section level3">
<h3>Heatmaps: Up</h3>
<pre class="r"><code>profile_heatmaps$Up</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-up-heatmap-1.png" alt="*Heatmap and histogram for all regions considered to show evidence of increased AR binding in the DHT group, separated by those which did or did not overlap a consensus peak. A total of 249 regions were in this group.*" width="960" />
<p class="caption">
<em>Heatmap and histogram for all regions considered to show evidence of increased AR binding in the DHT group, separated by those which did or did not overlap a consensus peak. A total of 249 regions were in this group.</em>
</p>
</div>
</div>
<div id="results-by-chromosome" class="section level3">
<h3>Results By Chromosome</h3>
<pre class="r"><code>merged_results %&gt;% 
  select(overlaps_ref, status) %&gt;% 
  as.data.frame() %&gt;% 
  mutate(status = str_remove(as.character(status), &quot; \\+ Ref Peak&quot;)) %&gt;% 
  ggplot(aes(seqnames, fill = status, alpha = overlaps_ref)) +
  geom_bar() +
  facet_grid(status~., scales = &quot;free_y&quot;) +
  scale_y_continuous(expand = expansion(c(0, 0.05)), labels = comma) +
  scale_fill_manual(values =  direction_colours) +
  scale_alpha_manual(values = c(0.5, 1)) +
  labs(
    x = &quot;Chromosome&quot;, y = &quot;Number of Windows&quot;, 
    fill = &quot;Status&quot;, alpha = &quot;Macs2 Peak&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-res-by-chromosome-1.png" alt="*Results for differential binding separated by chromosome*" width="960" />
<p class="caption">
<em>Results for differential binding separated by chromosome</em>
</p>
</div>
</div>
<div id="signal-by-region" class="section level3">
<h3>Signal By Region</h3>
<pre class="r"><code>merged_results %&gt;% 
  select(AveExpr, logFC, region) %&gt;% 
  as_tibble() %&gt;% 
  mutate(
    x = fct_relabel(
      region, str_replace_all, pattern = &quot; \\(&quot;, replacement = &quot;\n(&quot;
    ),
  ) %&gt;% 
  pivot_longer(cols = c(&quot;AveExpr&quot;, &quot;logFC&quot;)) %&gt;% 
  ggplot(aes(x, value, fill = region)) +
  geom_boxplot() +
  facet_grid(
    name~., scales = &quot;free&quot;, labeller = facet_labeller, switch = &quot;y&quot;
  ) +
  scale_fill_manual(values = region_colours) +
  labs(x = &quot;Region&quot;, y = c(), fill = &quot;Overlaps&quot;) </code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/boxplot-regions-1.png" alt="*Distributions of overall signal (logCPM) and changed signal (logFC) for each genomic region.*" width="960" />
<p class="caption">
<em>Distributions of overall signal (logCPM) and changed signal (logFC) for each genomic region.</em>
</p>
</div>
</div>
<div id="differential-binding-by-region" class="section level3">
<h3>Differential Binding By Region</h3>
<pre class="r"><code>merged_results %&gt;% 
  select(status, region) %&gt;% 
  as_tibble() %&gt;% 
  mutate(
    x = fct_relabel(
      region, str_replace_all, pattern = &quot; \\(&quot;, replacement = &quot;\n(&quot;
    )
  ) %&gt;% 
  group_by(x, region, status) %&gt;% 
  tally() %&gt;% 
  arrange(region, desc(status)) %&gt;% 
  mutate(y = cumsum(n)) %&gt;% 
  ggplot(
    aes(x, n, fill = status)
  ) +
  geom_col() +
  geom_label(
    aes(y = y - 0.5*n, label = comma(n, 1), colour = status),
    data = . %&gt;% dplyr::filter(n &gt; 0.2*max(y)),
    fill = &quot;white&quot;, alpha = 0.8,
    show.legend = FALSE
  ) +
  geom_text(
    aes(y = y1, label = comma(y, 1)),
    data = . %&gt;% 
      dplyr::filter(y == max(y)) %&gt;% 
      ungroup() %&gt;% 
      mutate(y1 = y + 0.03*max(y))
  ) +
  scale_y_continuous(expand = expansion(c(0, 0.5)), labels = comma) +
  scale_fill_manual(values = direction_colours) +
  scale_colour_manual(values = direction_colours) +
  labs(x = &quot;Region&quot;, y = &quot;Merged Windows&quot;, fill = &quot;Status&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-db-regions-1.png" alt="*Merged windows considered as showing differential AR binding across all genomic regions.*" width="960" />
<p class="caption">
<em>Merged windows considered as showing differential AR binding across all genomic regions.</em>
</p>
</div>
</div>
<div id="signal-by-feature" class="section level3">
<h3>Signal By Feature</h3>
<pre class="r"><code>merged_results %&gt;% 
  select(AveExpr, logFC, feature) %&gt;% 
  as_tibble() %&gt;% 
  pivot_longer(cols = c(&quot;AveExpr&quot;, &quot;logFC&quot;)) %&gt;% 
  ggplot(aes(feature, value, fill = feature)) +
  geom_boxplot() +
  facet_grid(
    name~., scales = &quot;free&quot;, labeller = facet_labeller, switch = &quot;y&quot;
  ) +
  scale_fill_manual(values = feature_colours) +
  labs(x = &quot;Region&quot;, y = c(), fill = &quot;Overlaps&quot;) </code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/boxplot-features-1.png" alt="*Distributions of overall signal (logCPM) and changed signal (logFC) for each external features.*" width="960" />
<p class="caption">
<em>Distributions of overall signal (logCPM) and changed signal (logFC) for each external features.</em>
</p>
</div>
</div>
<div id="differential-binding-by-feature" class="section level3">
<h3>Differential Binding By Feature</h3>
<pre class="r"><code>merged_results %&gt;% 
  select(status, feature) %&gt;% 
  as_tibble() %&gt;% 
  group_by(feature, status) %&gt;% 
  tally() %&gt;% 
  arrange(feature, desc(status)) %&gt;% 
  mutate(y = cumsum(n)) %&gt;% 
  ggplot(
    aes(feature, n, fill = status)
  ) +
  geom_col() +
  geom_label(
    aes(y = y - 0.5*n, label = comma(n, 1), colour = status),
    data = . %&gt;% dplyr::filter(n &gt; 0.2*max(y)),
    fill = &quot;white&quot;, alpha = 0.8,
    show.legend = FALSE
  ) +
  geom_text(
    aes(y = y1, label = comma(y, 1)),
    data = . %&gt;% 
      dplyr::filter(y == max(y)) %&gt;% 
      ungroup() %&gt;% 
      mutate(y1 = y + 0.03*max(y))
  ) +
  scale_y_continuous(expand = expansion(c(0, 0.5)), labels = comma) +
  scale_fill_manual(values = direction_colours) +
  scale_colour_manual(values = direction_colours) +
  labs(x = &quot;Feature&quot;, y = &quot;Merged Windows&quot;, fill = &quot;Status&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-db-features-1.png" alt="*Merged windows considered as showing differential AR binding across all external features.*" width="960" />
<p class="caption">
<em>Merged windows considered as showing differential AR binding across all external features.</em>
</p>
</div>
</div>
<div id="differential-binding-by-region-and-feature" class="section level3">
<h3>Differential Binding By Region And Feature</h3>
<pre class="r"><code>merged_results %&gt;% 
  mutate(region = fct_relabel(region, str_wrap, width = 15)) %&gt;% 
  plotPie(x = &quot;region&quot;, y = &quot;feature&quot;, fill = &quot;status&quot;) +
  scale_fill_manual(values = direction_colours) +
  labs(
    x = &quot;Region&quot;, y = &quot;Feature&quot;, fill = &quot;Status&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/scatterpie-region-feature-1.png" alt="*Comparison of changes in AR binding separated by gene-centric region and external features provided in h3k27ac_features.gtf*" width="960" />
<p class="caption">
<em>Comparison of changes in AR binding separated by gene-centric region and external features provided in h3k27ac_features.gtf</em>
</p>
</div>
</div>
</div>
<div id="result-tables" class="section level2 tabset">
<h2 class="tabset">Result Tables</h2>
<pre class="r"><code>up_col &lt;- function(x) {
  rgb(
    colorRamp(c(&quot;#ffffff&quot;, colours$direction[[&quot;up&quot;]]))(x), maxColorValue = 255
  )
}
down_col &lt;- function(x) {
  rgb(
    colorRamp(c(&quot;#ffffff&quot;, colours$direction[[&quot;down&quot;]]))(x), maxColorValue = 255
  )
}
unch_col &lt;- function(x) {
  rgb(
    colorRamp(c(&quot;#ffffff&quot;, colours$direction[[&quot;unchanged&quot;]]))(x), 
    maxColorValue = 255
  )
}
lfc_col &lt;- function(x){
  rgb(
    colorRamp(c(colours$direction[[&quot;down&quot;]], &quot;#ffffff&quot;, colours$direction[[&quot;up&quot;]]))(x), 
    maxColorValue = 255
  )
}
expr_col &lt;- function(x){
  rgb(colorRamp(hcl.colors(9, &quot;TealRose&quot;))(x), maxColorValue = 255)
}
bar_style &lt;- function(width = 1, fill = &quot;#e6e6e6&quot;, height = &quot;75%&quot;, align = c(&quot;left&quot;, &quot;right&quot;), color = NULL) {
  align &lt;- match.arg(align)
  if (align == &quot;left&quot;) {
    position &lt;- paste0(width * 100, &quot;%&quot;)
    image &lt;- sprintf(&quot;linear-gradient(90deg, %1$s %2$s, transparent %2$s)&quot;, fill, position)
  } else {
    position &lt;- paste0(100 - width * 100, &quot;%&quot;)
    image &lt;- sprintf(&quot;linear-gradient(90deg, transparent %1$s, %2$s %1$s)&quot;, position, fill)
  }
  list(
    backgroundImage = image,
    backgroundSize = paste(&quot;100%&quot;, height),
    backgroundRepeat = &quot;no-repeat&quot;,
    backgroundPosition = &quot;center&quot;,
    color = color
  )
}
with_tooltip &lt;- function(value, width = 30) {
  tags$span(title = value, str_trunc(value, width))
}</code></pre>
<div id="overall-results" class="section level3">
<h3>Overall Results</h3>
<pre class="r"><code>df &lt;- merged_results %&gt;% 
  as_tibble() %&gt;% 
  group_by(overlaps_ref, status) %&gt;% 
  summarise(n = dplyr::n(), .groups = &quot;drop&quot;) %&gt;% 
  complete(overlaps_ref, status, fill = list(n = 0)) %&gt;% 
  group_by(overlaps_ref) %&gt;% 
  mutate(Total = sum(n)) %&gt;%
  ungroup() %&gt;% 
  pivot_wider(names_from = &quot;status&quot;, values_from = &quot;n&quot;, values_fill = 0) %&gt;% 
  mutate(
    overlaps_ref = unlist(facet_labeller(overlaps_ref)),
    `% Changed` = 1 - Unchanged / Total
  ) %&gt;% 
  dplyr::rename(`Macs2 Peak` = overlaps_ref) 
cp &lt;- htmltools::em(
  glue(
    &quot;Overall results for changed {target} binding after {treat_levels[[2]]} &quot;,
    &quot;treament, broken down by whether each merged window overlaps a macs2-&quot;,
    &quot;derived consensus peak.&quot;
  )
)
tbl &lt;- df %&gt;%
  reactable(
    columns = list(
      `Macs2 Peak` = colDef(footer = htmltools::tags$b(&quot;Total&quot;)),
      Up = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / (length(merged_results) - sum(df$Unchanged))
          color &lt;- up_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      Down = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / (length(merged_results) - sum(df$Unchanged))
          color &lt;- down_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      Unchanged = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / length(merged_results)#sum(df$Unchanged)
          color &lt;- unch_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      `% Changed` = colDef(
        cell = function(value) percent(value, 0.1),
        style = function(value) bar_style(width = value, fill = &quot;#B3B3B3&quot;),
        align = &quot;left&quot;,
        footer = htmltools::tags$b(
          percent(sum(1 - sum(df$Unchanged) / sum(df$Total)), 0.1)
        )
      ),
      Total = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          bar_style(width = value / length(merged_results), fill = &quot;#B3B3B3&quot;)
        },
        align = &quot;left&quot;,
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      )
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Overall results for changed AR binding after DHT treament, broken down by whether each merged window overlaps a macs2-derived consensus peak.</em>
</div>
<div id="htmlwidget-2dfb70b34a18625565c2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2dfb70b34a18625565c2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Macs2 Peak":["No Consensus Peak","Consensus Peak"],"Total":[103,158],"Up":[91,158],"Down":[0,0],"Unchanged":[12,0],"% Changed":[0.883495145631068,1]},"columns":[{"accessor":"Macs2 Peak","name":"Macs2 Peak","type":"character","footer":{"name":"b","attribs":{},"children":["Total"]}},{"accessor":"Total","name":"Total","type":"numeric","cell":["103","158"],"footer":{"name":"b","attribs":{},"children":["261"]},"align":"left","style":[{"backgroundImage":"linear-gradient(90deg, #B3B3B3 39.463601532567%, transparent 39.463601532567%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 60.536398467433%, transparent 60.536398467433%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]},{"accessor":"Up","name":"Up","type":"numeric","cell":["91","158"],"footer":{"name":"b","attribs":{},"children":["249"]},"style":[{"background":"#EBA1AD"},{"background":"#DD5D71"}]},{"accessor":"Down","name":"Down","type":"numeric","cell":["0","0"],"footer":{"name":"b","attribs":{},"children":["0"]},"style":[{"background":"#FFFFFF"},{"background":"#FFFFFF"}]},{"accessor":"Unchanged","name":"Unchanged","type":"numeric","cell":["12","0"],"footer":{"name":"b","attribs":{},"children":["12"]},"style":[{"background":"#F9F9F9"},{"background":"#FFFFFF"}]},{"accessor":"% Changed","name":"% Changed","type":"numeric","cell":["88.3%","100.0%"],"footer":{"name":"b","attribs":{},"children":["95.4%"]},"align":"left","style":[{"backgroundImage":"linear-gradient(90deg, #B3B3B3 88.3495145631068%, transparent 88.3495145631068%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 100%, transparent 100%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"fb3356d0bf9b072779c8662d26426f75","key":"fb3356d0bf9b072779c8662d26426f75"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="summary-by-region" class="section level3">
<h3>Summary By Region</h3>
<pre class="r"><code>df &lt;- merged_results %&gt;% 
  select(
    overlaps_ref, status, all_of(fdr_column), region
  ) %&gt;% 
  as_tibble() %&gt;% 
  group_by(region, status) %&gt;% 
  summarise(n = dplyr::n(), .groups = &quot;drop&quot;) %&gt;% 
  complete(region, status, fill = list(n = 0)) %&gt;% 
  pivot_wider(names_from = &quot;status&quot;, values_from = &quot;n&quot;) %&gt;% 
  ungroup() %&gt;% 
  mutate(
    Total = Up + Down + Unchanged,
    `% Of All Windows` = Total / length(merged_results),
    `% Changed` = 1 - Unchanged / Total
  ) %&gt;% 
  arrange(region) %&gt;% 
  dplyr::select(
    Region = region,
    any_of(str_to_title(names(colours$direction))),
    `% Changed`, Total, `% Of All Windows`
  )
cp &lt;- htmltools::em(
  glue(
    &quot;Overall results for changed {target} binding after {treat_levels[[2]]} &quot;,
    &quot;treament, broken down by which genomic region contains the largest &quot;, 
    &quot;overlap with each merged window.&quot;
  )
)
tbl &lt;- df %&gt;%
  reactable(
    columns = list(
      Region = colDef(footer = htmltools::tags$b(&quot;Total&quot;)),
      Up = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / (length(merged_results) - sum(df$Unchanged))
          color &lt;- up_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      Down = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / (length(merged_results) - sum(df$Unchanged))
          color &lt;- down_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      Unchanged = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / length(merged_results)#sum(df$Unchanged)
          color &lt;- unch_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      `% Changed` = colDef(
        cell = function(value) percent(value, 0.1),
        footer = htmltools::tags$b(
          percent(sum(1 - sum(df$Unchanged) / sum(df$Total)), 0.1)
        )
      ),
      Total = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          bar_style(width = value / length(merged_results), fill = &quot;#B3B3B3&quot;)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      `% Of All Windows` = colDef(
        cell = function(value) percent(value, 0.1),
        footer = htmltools::tags$b(&quot;100%&quot;)
      )
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Overall results for changed AR binding after DHT treament, broken down by which genomic region contains the largest overlap with each merged window.</em>
</div>
<div id="htmlwidget-96a3add99576a5798bee" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-96a3add99576a5798bee">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["Promoter (-1500/+500bp)","Upstream Promoter (<5kb)","Exon","Intron","Intergenic (<10kb)","Intergenic (>10kb)"],"Up":[17,11,9,140,18,54],"Down":[0,0,0,0,0,0],"Unchanged":[0,0,0,8,1,3],"% Changed":[1,1,1,0.945945945945946,0.947368421052632,0.947368421052632],"Total":[17,11,9,148,19,57],"% Of All Windows":[0.0651340996168582,0.0421455938697318,0.0344827586206897,0.567049808429119,0.0727969348659004,0.218390804597701]},"columns":[{"accessor":"Region","name":"Region","type":"factor","footer":{"name":"b","attribs":{},"children":["Total"]}},{"accessor":"Up","name":"Up","type":"numeric","cell":["17","11","9","140","18","54"],"footer":{"name":"b","attribs":{},"children":["249"]},"style":[{"background":"#FBEDEF"},{"background":"#FCF3F5"},{"background":"#FDF5F6"},{"background":"#E16F81"},{"background":"#FBECEE"},{"background":"#F3C7CE"}]},{"accessor":"Down","name":"Down","type":"numeric","cell":["0","0","0","0","0","0"],"footer":{"name":"b","attribs":{},"children":["0"]},"style":[{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FFFFFF"}]},{"accessor":"Unchanged","name":"Unchanged","type":"numeric","cell":["0","0","0","8","1","3"],"footer":{"name":"b","attribs":{},"children":["12"]},"style":[{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FBFBFB"},{"background":"#FEFEFE"},{"background":"#FDFDFD"}]},{"accessor":"% Changed","name":"% Changed","type":"numeric","cell":["100.0%","100.0%","100.0%","94.6%","94.7%","94.7%"],"footer":{"name":"b","attribs":{},"children":["95.4%"]}},{"accessor":"Total","name":"Total","type":"numeric","cell":["17","11","9","148","19","57"],"footer":{"name":"b","attribs":{},"children":["261"]},"style":[{"backgroundImage":"linear-gradient(90deg, #B3B3B3 6.51340996168582%, transparent 6.51340996168582%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 4.21455938697318%, transparent 4.21455938697318%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 3.44827586206897%, transparent 3.44827586206897%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 56.7049808429119%, transparent 56.7049808429119%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 7.27969348659004%, transparent 7.27969348659004%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 21.8390804597701%, transparent 21.8390804597701%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]},{"accessor":"% Of All Windows","name":"% Of All Windows","type":"numeric","cell":["6.5%","4.2%","3.4%","56.7%","7.3%","21.8%"],"footer":{"name":"b","attribs":{},"children":["100%"]}}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"563da72f0ac0c770f581cdec8f997aa2","key":"563da72f0ac0c770f581cdec8f997aa2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="summary-by-feature" class="section level3">
<h3>Summary By Feature</h3>
<pre class="r"><code>df &lt;- merged_results %&gt;% 
  select(
    overlaps_ref, status, all_of(fdr_column), feature
  ) %&gt;% 
  as_tibble() %&gt;% 
  group_by(feature, status) %&gt;% 
  tally() %&gt;% 
  ungroup() %&gt;% 
  complete(feature, status, fill = list(n = 0)) %&gt;% 
  pivot_wider(names_from = &quot;status&quot;, values_from = &quot;n&quot;) %&gt;% 
  mutate(
    Total = Up + Down + Unchanged,
    `% Of All Windows` = Total / length(merged_results),
    `% Changed` = 1 - Unchanged / Total
  ) %&gt;% 
  arrange(feature) %&gt;% 
  dplyr::select(
    Feature = feature,
    any_of(str_to_title(names(colours$direction))),
    `% Changed`, Total, `% Of All Windows`
  )
cp &lt;- htmltools::em(
  glue(
    &quot;Overall results for changed {target} binding after {treat_levels[[2]]} &quot;,
    &quot;treament, broken down by which external feature contains the largest &quot;, 
    &quot;overlap with each merged window.&quot;
  )
)
tbl &lt;- df %&gt;%
  reactable(
    columns = list(
      Feature = colDef(footer = htmltools::tags$b(&quot;Total&quot;)),
      Up = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / (length(merged_results) - sum(df$Unchanged))
          color &lt;- up_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      Down = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / (length(merged_results) - sum(df$Unchanged))
          color &lt;- down_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      Unchanged = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          normalized &lt;- value / length(merged_results)#sum(df$Unchanged)
          color &lt;- unch_col(normalized)
          list(background = color)
        },
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      `% Changed` = colDef(
        cell = function(value) percent(value, 0.1),
        footer = htmltools::tags$b(
          percent(sum(1 - sum(df$Unchanged) / sum(df$Total)), 0.1)
        )
      ),
      Total = colDef(
        cell = function(value) comma(value, 1),
        style = function(value) {
          bar_style(width = value / length(merged_results), fill = &quot;#B3B3B3&quot;)
        },
        align = &quot;left&quot;,
        footer = function(values) htmltools::tags$b(comma(sum(values)))
      ),
      `% Of All Windows` = colDef(
        cell = function(value) percent(value, 0.1),
        footer = htmltools::tags$b(&quot;100%&quot;)
      )
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Overall results for changed AR binding after DHT treament, broken down by which external feature contains the largest overlap with each merged window.</em>
</div>
<div id="htmlwidget-5b91c458dbccbc3445fd" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5b91c458dbccbc3445fd">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Feature":["Promoter","Enhancer","Super Enhancer","No Feature"],"Up":[26,128,31,64],"Down":[0,0,0,0],"Unchanged":[1,5,3,3],"% Changed":[0.962962962962963,0.962406015037594,0.911764705882353,0.955223880597015],"Total":[27,133,34,67],"% Of All Windows":[0.103448275862069,0.509578544061303,0.130268199233716,0.256704980842912]},"columns":[{"accessor":"Feature","name":"Feature","type":"factor","footer":{"name":"b","attribs":{},"children":["Total"]}},{"accessor":"Up","name":"Up","type":"numeric","cell":["26","128","31","64"],"footer":{"name":"b","attribs":{},"children":["249"]},"style":[{"background":"#F9E4E7"},{"background":"#E37B8C"},{"background":"#F8DFE3"},{"background":"#F1BDC5"}]},{"accessor":"Down","name":"Down","type":"numeric","cell":["0","0","0","0"],"footer":{"name":"b","attribs":{},"children":["0"]},"style":[{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FFFFFF"}]},{"accessor":"Unchanged","name":"Unchanged","type":"numeric","cell":["1","5","3","3"],"footer":{"name":"b","attribs":{},"children":["12"]},"style":[{"background":"#FEFEFE"},{"background":"#FCFCFC"},{"background":"#FDFDFD"},{"background":"#FDFDFD"}]},{"accessor":"% Changed","name":"% Changed","type":"numeric","cell":["96.3%","96.2%","91.2%","95.5%"],"footer":{"name":"b","attribs":{},"children":["95.4%"]}},{"accessor":"Total","name":"Total","type":"numeric","cell":["27","133","34","67"],"footer":{"name":"b","attribs":{},"children":["261"]},"align":"left","style":[{"backgroundImage":"linear-gradient(90deg, #B3B3B3 10.3448275862069%, transparent 10.3448275862069%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 50.9578544061303%, transparent 50.9578544061303%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 13.0268199233716%, transparent 13.0268199233716%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, #B3B3B3 25.6704980842912%, transparent 25.6704980842912%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]},{"accessor":"% Of All Windows","name":"% Of All Windows","type":"numeric","cell":["10.3%","51.0%","13.0%","25.7%"],"footer":{"name":"b","attribs":{},"children":["100%"]}}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"5e15ae5aa3ca4bb79b431800f5f67cb7","key":"5e15ae5aa3ca4bb79b431800f5f67cb7"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="most-highly-ranked" class="section level3">
<h3>Most Highly Ranked</h3>
<pre class="r"><code>show_n &lt;- min(200, length(merged_results))
scaling_vals &lt;- list(
  logFC = c(-1, 1)*max(abs(merged_results$logFC)),
  AveExpr = range(merged_results$AveExpr),
  Width = max(width(merged_results))
)
cp &lt;- htmltools::em(
  glue(
    &quot;The {show_n} most highly-ranked merged windows by FDR. &quot;,
    &quot;Regions were assigned based on which genomic region showed the largest &quot;,
    &quot;overlap with the merged window. &quot;,
    ifelse(
      has_features, 
      glue(&quot;Features are as provided in the file {basename(config$external$features)}&quot;),
      glue(&quot;&quot;)
    ),
    &quot;For windows mapped to large numbers of genes, hovering your mouse over the &quot;, 
    &quot;cell will reveal the full set of genes. &quot;,
    ifelse(
      any_detected,
      &quot;Only genes considered as detected in the RNA-Seq data are shown. &quot;,
      &quot;&quot;
    ),
    &quot;The Macs2 Peak column is filterable using T/F values&quot;
  )
)
gene_col &lt;- ifelse(any_detected, &quot;detected&quot;, &quot;gene_name&quot;)
tbl &lt;- merged_results %&gt;%
  mutate(w = width) %&gt;% 
  arrange(!!sym(fdr_column)) %&gt;% 
  plyranges::slice(seq_len(show_n)) %&gt;% 
  select(
    w, AveExpr, logFC, FDR = !!sym(fdr_column), 
    overlaps_ref, Region = region, any_of(&quot;feature&quot;), Genes = !!sym(gene_col)
  ) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::rename(
    Range = range, `Width (kb)` = w, `Macs2 Peak` = overlaps_ref
  ) %&gt;% 
  rename_all(str_replace_all, &quot;feature&quot;, &quot;Feature&quot;) %&gt;% 
  mutate(Genes = vapply(Genes, paste, character(1), collapse = &quot;; &quot;)) %&gt;% 
  reactable(
    filterable = TRUE,
    showPageSizeOptions = TRUE,
    pageSizeOptions = c(10, 20, 50, show_n), defaultPageSize = 10,
    borderless  = TRUE,
    columns = list(
      Range = colDef(
        minWidth = 150,
        cell = function(value) {
          str_replace_all(value, &quot;:&quot;, &quot;: &quot;)
        }
      ),
      `Width (kb)` = colDef(
        cell = function(value) round(value / 1e3, 1),
        style = function(value) {
          x &lt;- value / scaling_vals$Width
          colour &lt;- expr_col(x)
          list(
            background = colour, 
            borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;
          )
        },
        maxWidth = 70
      ),
      AveExpr = colDef(
        cell = function(value) round(value, 2),
        style = function(value) {
          x &lt;- (value - min(scaling_vals$AveExpr)) / diff(scaling_vals$AveExpr)
          colour = expr_col(x)
          list(background = colour)
        },
        maxWidth = 80
      ),
      logFC = colDef(
        cell = function(value) round(value, 2),
        style = function(value) {
          x &lt;- (value - min(scaling_vals$logFC)) / diff(scaling_vals$logFC)
          colour &lt;- lfc_col(x)
          list(background = colour)
        },
        maxWidth = 70
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value),
        style = list(borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;),
        maxWidth = 80
      ),
      `Macs2 Peak` = colDef(
        cell = function(value) ifelse(value, &quot;\u2714 Yes&quot;, &quot;\u2716 No&quot;),
        style = function(value) {
          color &lt;- ifelse(value, &quot;#008000&quot;, &quot;#e00000&quot;)
          list(color = color, borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;)
        },
        maxWidth = 70
      ),
      Region = colDef(maxWidth = 150),
      Genes = colDef(
        cell = function(value) with_tooltip(value),
        minWidth = 150
      )
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>The 200 most highly-ranked merged windows by FDR. Regions were assigned based on which genomic region showed the largest overlap with the merged window. Features are as provided in the file h3k27ac_features.gtfFor windows mapped to large numbers of genes, hovering your mouse over the cell will reveal the full set of genes. Only genes considered as detected in the RNA-Seq data are shown. The Macs2 Peak column is filterable using T/F values</em>
</div>
<div id="htmlwidget-8f163e56c39a4ec81081" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8f163e56c39a4ec81081">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Range":["chr10:14613701-14614700","chr10:34188201-34189500","chr10:63858801-63859900","chr10:89407301-89408400","chr10:62726701-62727700","chr10:80502201-80503100","chr10:80241301-80242300","chr10:88424401-88425300","chr10:106047801-106048700","chr10:22254201-22255100","chr10:94490801-94491800","chr10:45496901-45497700","chr10:22944001-22945000","chr10:79257701-79259300","chr10:112896701-112897700","chr10:63697001-63697800","chr10:82227401-82228300","chr10:22755601-22756400","chr10:24158301-24159100","chr10:74877401-74878300","chr10:80489301-80490300","chr10:74008401-74009200","chr10:88664401-88665000","chr10:24173601-24174500","chr10:90132701-90133600","chr10:74547501-74548400","chr10:101653901-101654800","chr10:8576801-8577900","chr10:43689901-43690700","chr10:94663201-94664100","chr10:6297101-6298000","chr10:32982001-32983000","chr10:22375501-22376300","chr10:62042501-62043200","chr10:93318901-93319800","chr10:123880401-123881100","chr10:88851001-88851700","chr10:24552301-24552800","chr10:34758101-34759500","chr10:21520301-21520800","chr10:67094801-67095800","chr10:21177401-21178300","chr10:30086401-30087200","chr10:81101701-81102300","chr10:90248701-90249600","chr10:104272101-104272800","chr10:27276601-27277600","chr10:75474501-75475200","chr10:105308401-105309100","chr10:123348901-123349400","chr10:62715601-62716500","chr10:35979601-35980100","chr10:25459301-25460100","chr10:21472901-21473800","chr10:105711501-105712100","chr10:51767401-51768200","chr10:94662101-94662700","chr10:77492801-77493600","chr10:84985701-84986100","chr10:8049001-8049600","chr10:102180301-102180900","chr10:64566701-64567400","chr10:76781801-76782300","chr10:34441101-34441900","chr10:94422801-94423400","chr10:33483001-33483400","chr10:47727401-47728100","chr10:24518701-24519500","chr10:112217801-112218500","chr10:51578301-51579200","chr10:17710601-17711300","chr10:71145601-71147100","chr10:76546001-76546300","chr10:84952401-84953000","chr10:27774301-27774800","chr10:76720301-76720900","chr10:22471701-22472200","chr10:79266801-79267600","chr10:61296301-61297000","chr10:98623401-98624500","chr10:88766901-88767700","chr10:74014601-74015400","chr10:500601-501400","chr10:62408601-62409000","chr10:5533901-5534800","chr10:110481601-110482100","chr10:73151401-73152000","chr10:71409801-71410500","chr10:18614901-18615800","chr10:76447501-76448300","chr10:22457201-22457800","chr10:105778101-105778800","chr10:22971801-22972700","chr10:9269801-9270500","chr10:95513201-95514000","chr10:80185701-80186400","chr10:95203701-95204500","chr10:8656201-8656900","chr10:102101501-102101800","chr10:127280301-127280900","chr10:81100401-81101000","chr10:44976301-44976800","chr10:93686201-93687100","chr10:102202301-102202900","chr10:62884301-62884900","chr10:93729501-93730000","chr10:62484701-62485400","chr10:121702401-121702800","chr10:95194701-95195500","chr10:109345801-109346500","chr10:102685401-102686000","chr10:5813901-5814600","chr10:57898901-57899700","chr10:31491201-31492000","chr10:34947501-34948500","chr10:7275301-7276000","chr10:5308001-5308900","chr10:68879301-68880000","chr10:76887201-76887700","chr10:34914901-34915700","chr10:22159501-22160300","chr10:75335901-75336600","chr10:93315001-93315400","chr10:38130201-38130900","chr10:61591701-61592000","chr10:61595201-61595600","chr10:94471601-94472400","chr10:54012001-54012800","chr10:73350001-73350400","chr10:63776501-63777300","chr10:84223201-84223600","chr10:34872201-34873100","chr10:63866701-63867300","chr10:61900501-61901000","chr10:6407201-6407500","chr10:35127201-35128100","chr10:62491101-62491500","chr10:29396501-29397100","chr10:58143501-58144100","chr10:8832001-8832800","chr10:61751601-61751900","chr10:95143701-95144400","chr10:96242701-96243000","chr10:27830801-27831300","chr10:70556001-70556500","chr10:69307201-69307500","chr10:92647401-92647800","chr10:68876301-68876600","chr10:45774201-45774700","chr10:31393701-31394400","chr10:62233401-62234000","chr10:66627301-66628100","chr10:839201-839500","chr10:82271901-82272400","chr10:30898101-30898800","chr10:76707701-76708400","chr10:17507901-17508400","chr10:38486201-38486600","chr10:108268501-108269100","chr10:52271601-52272100","chr10:69865701-69866000","chr10:79959501-79960100","chr10:8903701-8904000","chr10:62027401-62028200","chr10:24705401-24705800","chr10:76707201-76707500","chr10:86104901-86105400","chr10:3852501-3852800","chr10:8054701-8055200","chr10:5596501-5596900","chr10:85576701-85577200","chr10:102851601-102852200","chr10:79245801-79246600","chr10:13728201-13728500","chr10:8170501-8171200","chr10:89404401-89405100","chr10:127335001-127335300","chr10:17645401-17646200","chr10:63054201-63054600","chr10:109509001-109509600","chr10:11564801-11565400","chr10:21184601-21184900","chr10:59519401-59519800","chr10:21559601-21560100","chr10:14968101-14968600","chr10:70393701-70394500","chr10:101686901-101687400","chr10:89502801-89503200","chr10:89405801-89406300","chr10:24630701-24631000","chr10:23256901-23257500","chr10:7273601-7274000","chr10:3930101-3930700","chr10:14729601-14729900","chr10:90399901-90400600","chr10:81102701-81103000","chr10:579401-579700","chr10:8915001-8915300","chr10:29530001-29530600","chr10:51549401-51549700"],"Width (kb)":[1000,1300,1100,1100,1000,900,1000,900,900,900,1000,800,1000,1600,1000,800,900,800,800,900,1000,800,600,900,900,900,900,1100,800,900,900,1000,800,700,900,700,700,500,1400,500,1000,900,800,600,900,700,1000,700,700,500,900,500,800,900,600,800,600,800,400,600,600,700,500,800,600,400,700,800,700,900,700,1500,300,600,500,600,500,800,700,1100,800,800,800,400,900,500,600,700,900,800,600,700,900,700,800,700,800,700,300,600,600,500,900,600,600,500,700,400,800,700,600,700,800,800,1000,700,900,700,500,800,800,700,400,700,300,400,800,800,400,800,400,900,600,500,300,900,400,600,600,800,300,700,300,500,500,300,400,300,500,700,600,800,300,500,700,700,500,400,600,500,300,600,300,800,400,300,500,300,500,400,500,600,800,300,700,700,300,800,400,600,600,300,400,500,500,800,500,400,500,300,600,400,600,300,700,300,300,300,600,300],"AveExpr":[5.3201200429273,5.37707645340377,4.50674078647199,4.82522690249826,4.44540408215808,4.73784928763067,4.96432305856007,4.35262384486275,4.61654696062504,5.13851678941485,4.70514405637545,4.6908549996882,4.63374515484984,4.51716375522066,3.98116027892362,4.7485027822701,4.45324783026835,4.60330917845029,4.68294055883999,4.92206789616084,4.47462757199201,4.80194249718722,4.09193008101031,4.80651052677372,4.39801219765201,4.22295593980663,4.4785533567648,4.90507126723556,4.37258852938574,4.34410837058883,4.93268396592569,4.6697186489796,4.81497394399403,4.07685307464518,4.52745990639854,3.68264192296992,4.14378244428038,4.58015078314191,4.78444892037662,4.29222299709003,4.5082412691929,4.8285192082578,4.27707977582152,4.34044175888549,4.15035114932681,3.81388629007929,4.80908225007569,3.7461273679589,4.13639936355562,3.80729780507614,4.43986120638913,4.56134797061997,4.22500206298374,4.87179324089823,4.07914365369807,4.19786157760769,4.17685141244557,4.12528635028063,4.61942906021546,3.93442983727142,4.29964401642138,4.25511681853706,4.25567008916729,4.80627295063068,4.28577588746777,4.5749039073466,3.70564080886012,4.62638466192373,3.84591383533386,4.37561705909699,4.19349573112935,4.41446234828929,4.19835517094981,4.61362671485119,3.95724492244422,4.38265091059229,4.34250379743884,3.90386075806292,3.88939679268045,4.38136010846606,3.98621755019015,3.97100963174868,4.32807383043071,3.63253477580796,4.69052502608947,3.63110636628349,3.77286365742178,4.09764331464468,4.34189440176928,4.07503752050376,4.52291519251852,4.03083586304459,4.37290378743341,4.37736553265857,4.23006646398268,4.1153610977844,4.15122366873538,4.46793674407363,3.78361696449347,3.5319589944706,3.98134739197461,3.76118585660385,4.21799315811666,3.95909161772374,3.84727031205029,3.73631369475429,4.29630773001526,3.68200771893078,4.36879003344438,4.09220366540246,4.03437393764978,4.44035784563884,4.19782000962401,4.45450739828208,4.73416128945042,4.24896292731221,4.31467415364129,4.00313556722473,4.11298234034589,4.46185962523497,4.24983147752891,4.10476051362531,3.94505960402409,4.02683543853216,3.8160696660921,3.87730736772289,4.3626801078142,3.91936761284219,3.91397689426185,4.57186296824101,3.91446888706944,4.51502387266374,4.29567742318217,3.95888000729096,4.01319850553859,4.63723209774619,3.84535129220405,4.35335990056811,3.95029252413088,4.42219706917223,3.78593002094713,4.05193318528509,3.79037481422056,4.64794577689752,4.08998188824912,3.82210429516488,3.97969848379618,3.93836102310549,3.87136382048779,4.34092167655033,4.18393332071848,4.0542569615755,4.07896574687407,3.90335282973956,4.1633910942782,4.21761434037998,4.30890344199455,4.0459038366977,4.09539358218734,4.11663575169883,3.92009268991777,4.03846748684318,4.18313458293987,4.22402026977224,4.19111907196415,3.82814589081089,3.89231457271865,3.89879981058166,4.24446077259313,3.99900352240824,4.2597132366351,3.92438796580818,4.35312051284388,4.04005962764488,4.20348660213771,3.97528984405497,3.63885336654862,4.34235619600137,3.88047535454389,3.88179507473952,4.06186690839455,4.18292266252944,3.92923703704093,4.21867347673537,4.06194718750934,4.4464358546369,3.84587109234903,3.8321723598846,4.38975475066051,4.11183025431666,4.18335090793781,4.17495999122174,4.2282261636868,4.21273069338946,4.11735883304043,3.82877157700976,3.96969513549078,4.58101948925963,3.78119037154831,3.8672618972749],"logFC":[3.10309599362528,2.83951286640157,4.07709708390607,3.61132134204222,3.70473713810074,3.34673153446189,2.81443719539463,3.62519677931071,3.21866691009175,2.52879993668892,2.96624358294173,3.2877454481593,2.91304713789901,3.01008651020359,3.15240713122391,2.68558056564443,2.84756910186243,2.79397794291622,3.04752718741374,2.43511123915287,2.96305935268528,2.60624758328843,2.96439517674535,2.5068056211567,2.73813041350568,2.84816147241278,2.83070241274043,2.49550034355316,2.67576603870393,2.75500359188612,2.47784856154276,2.5356567575974,2.3879308309196,2.59127452899744,2.67568192932518,3.22427203507525,2.52937937675992,2.43358355436509,2.25698854820795,2.46969994378333,2.46687171867629,2.12365217227419,2.34274874414691,2.43598091988713,2.53525026046549,2.65224915976785,2.11075101400487,2.74037674620388,2.37261342788184,2.74249742744126,2.17659476737095,2.11093755887568,2.37056601438742,1.91136982899302,2.40547786618877,2.30707682455537,2.1804626989252,2.19164614188699,2.00352295709603,2.27110926734237,2.15307413953738,2.18525158996295,2.31158108349062,1.87732869381513,2.10771999688213,2.00508376834837,2.64263494478283,1.95470650411572,2.4514731995631,2.03615881218067,2.09758931685888,1.99564050368416,2.25775035268143,1.88559188056441,2.19434954202659,2.03541455469429,2.06925131639603,2.30458315766566,2.19107231169201,1.9610199403969,2.09101131999492,2.07884659633099,1.92626039437112,2.49642287867853,1.97361924664318,2.45229930594365,2.3903793504459,2.11949838787381,2.10500927617667,1.95050747345285,1.88455360297065,2.24094790550358,2.0406455687202,1.82897508777361,1.85430136248337,1.87627902376815,1.97871733661106,1.82570763472475,2.13722133788698,2.54109052343588,1.9106865041775,2.12037519751514,1.83015475075135,2.05143834983356,2.13748507440111,2.29877650672699,1.94658062443563,2.51640720506845,1.81182408934524,1.84180739894574,1.86918030774489,1.97653304918451,2.16901601724481,1.81763024997459,1.6356441356313,1.84001768142644,1.79701050143101,1.93900777654243,1.84793114237971,1.84284682712846,1.76977568856753,1.80190999496968,1.82070818798063,1.96502454640432,1.98857363150815,1.90262925127815,1.77200611011145,1.85433071232379,1.80823048825556,1.58513527751856,1.80921447387075,1.61531864094455,1.64977329998145,1.7821011572294,1.7907489697567,1.52098131990397,1.88469535674135,1.61853941160716,1.77418074747259,1.62554807661003,1.81367453009343,1.64003459251677,1.8225641166403,1.45917366595117,1.70205114728832,1.79222310616213,1.7491012453808,1.69656364134248,1.6838010823013,1.5608412302051,1.56616636490174,1.62391420386323,1.55820077474496,1.66509602169889,1.52225805720709,1.52313835672817,1.63345152222567,1.61389504418548,1.86337374332336,1.50338423690736,1.62877457233941,1.53846633077394,1.55464417634487,1.51840665376758,1.54990033807674,1.6718872682612,1.60267946263066,1.61374094874901,1.54056936290121,1.57859599492996,1.56653113106034,1.52661773931929,1.4576166165839,1.64767805088659,1.46040207952593,1.54717068616168,1.86189497936651,1.34305084286478,1.56138314153311,1.74171464840529,1.4086585107758,1.44853760980126,1.50556353292312,1.39510008195185,1.3940071085284,1.32643660113727,1.52844728843873,1.58004166282653,1.29798137080064,1.36871387417465,1.34603347053911,1.34203744652103,1.37345303274514,1.29260339826996,1.420288384777,1.50285145274612,1.35844085881131,1.17645691686426,1.61878335657104,1.40954174743863],"FDR":[2.12626042128879e-14,2.12626042128879e-14,2.12626042128879e-14,2.12626042128879e-14,1.64941610125004e-13,3.20588871619051e-13,3.32760937745241e-12,3.32760937745241e-12,3.32760937745241e-12,5.12695703874189e-12,9.32146815416757e-12,1.13643975902101e-11,1.5406507200969e-11,7.59276558037684e-11,7.59276558037684e-11,8.47197537770809e-11,8.47197537770809e-11,8.63476549061855e-11,8.63476549061855e-11,9.93450439428839e-11,1.00964219377202e-10,1.23351928564355e-10,1.53335503547426e-10,2.29376449130966e-10,3.20860628000733e-10,3.43668297018441e-10,3.43668297018441e-10,3.62557289657214e-10,5.33690575283001e-10,5.96920069133482e-10,6.65285654192699e-10,1.2110123820612e-09,1.69545323703119e-09,4.45582914855555e-09,4.88329987389701e-09,5.08152243941276e-09,5.8604029126942e-09,6.05870200466413e-09,7.8468750865984e-09,9.42575130339088e-09,9.87863349412524e-09,1.45138172908309e-08,1.63719387586718e-08,1.66723773834204e-08,1.98785190356995e-08,1.98785190356995e-08,2.855509767691e-08,2.89260226741862e-08,2.89260226741862e-08,2.92933017370981e-08,4.6461285594811e-08,5.88202765702112e-08,6.77754034265974e-08,7.26546254449901e-08,7.78674095580539e-08,8.24877913264316e-08,9.81668788499057e-08,1.02155603478465e-07,1.08805537614046e-07,1.17550826352877e-07,1.17682947185657e-07,1.25380450066555e-07,1.29157839437716e-07,1.3419434981774e-07,1.3419434981774e-07,1.38301610406995e-07,1.81286700640553e-07,1.83053152653404e-07,2.06668703577201e-07,2.26455735552181e-07,2.29084082141275e-07,2.4116930267785e-07,2.74966589924919e-07,2.96369144882056e-07,3.02806154401558e-07,3.02806154401558e-07,3.05788845793728e-07,3.06931635424808e-07,3.24202558697682e-07,3.69351142732784e-07,5.4720075614595e-07,5.90555365314553e-07,6.31871006260004e-07,6.46693770060355e-07,6.91421350054666e-07,6.91421350054666e-07,6.97877885317158e-07,7.48413722068056e-07,7.8530320314654e-07,1.00431057859263e-06,1.10331748373286e-06,1.17892405408806e-06,1.43559726318258e-06,1.58241220591375e-06,1.59639176680404e-06,1.68922526954069e-06,1.6969327462773e-06,1.69817104651356e-06,1.70628766678098e-06,1.80512823922039e-06,2.04626564130826e-06,2.10776216035581e-06,2.23637635195961e-06,2.2557255791606e-06,2.25971435032308e-06,2.25971435032308e-06,2.26209899755007e-06,2.26209899755007e-06,2.26844443737633e-06,2.26844443737633e-06,2.45198660627782e-06,2.5032771780183e-06,2.63327384312539e-06,2.72269941015869e-06,2.80022317983534e-06,2.93933465902377e-06,3.22703923152865e-06,3.3507316970903e-06,3.94301587928146e-06,4.56197725082516e-06,4.70449771578718e-06,4.82863052131375e-06,5.49632514850223e-06,5.62514696910187e-06,5.88560292384865e-06,7.02994800449355e-06,7.37375662380084e-06,7.75933665009741e-06,9.58861138842237e-06,1.01132212390446e-05,1.01644294744738e-05,1.08421949939283e-05,1.08566640027625e-05,1.14654065551056e-05,1.27646081516785e-05,1.44586481566711e-05,1.54487646779762e-05,1.86831900619993e-05,1.86831900619993e-05,1.99056790371933e-05,2.08298872380438e-05,2.18961901014319e-05,2.34666314623584e-05,2.47034577404246e-05,2.64917813908113e-05,2.67938468793441e-05,2.68101785728888e-05,3.2871826370285e-05,3.56674664746497e-05,3.58702600881843e-05,3.59819739972153e-05,3.6027770456247e-05,4.48262818709026e-05,4.78150694091146e-05,5.59932238636148e-05,5.72396090320697e-05,5.80967615455169e-05,6.03819606916328e-05,6.28889109145303e-05,6.4056306701958e-05,6.4056306701958e-05,6.4056306701958e-05,6.69991312747405e-05,7.04582776554282e-05,7.05245778630897e-05,7.37939040698132e-05,7.37939040698132e-05,8.11228792313015e-05,8.21802229360029e-05,9.99120389944694e-05,0.000101562922962217,0.000127406891238986,0.000137519708909903,0.000142535539273041,0.000157690160828685,0.000158597395040635,0.000160456119953097,0.000188917601204766,0.000193581884296193,0.000194851646539729,0.000206118108401862,0.000206118108401862,0.000209027046308284,0.000216759306384451,0.000217660128989283,0.000251350999639211,0.000278124152441991,0.000304516337193517,0.000307734702994675,0.000311314288469314,0.000328192236888058,0.00036577529644492,0.000365791752445114,0.000450130676000313,0.000492860950507291,0.000496000947588018,0.000555290966406338,0.000563370186757098,0.000571375505454023,0.000600092713293699],"Macs2 Peak":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,false,true,true,true,false,true,false,false,true,true,false,true,false,true,false,false,false,true,true,false,true,true,false,true,false,true,true,false,false,false,true,true,true,true,false,false,true,false,true,false,true,true,true,true,false,true,false,false,false,false,false,false,true,true,true,false,true,false,true,true,false,true,false,false,true,false,false,true,false,true,false,false,true,false,false,false,true,false,false,false,false,false],"Region":["Promoter (-1500/+500bp)","Intergenic (<10kb)","Intergenic (<10kb)","Intron","Intron","Intergenic (<10kb)","Intron","Intron","Intron","Intron","Intergenic (>10kb)","Promoter (-1500/+500bp)","Intron","Promoter (-1500/+500bp)","Intergenic (>10kb)","Intron","Intron","Intron","Intron","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Intron","Intron","Intron","Intron","Intron","Intergenic (>10kb)","Exon","Intron","Intergenic (<10kb)","Intron","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intron","Intron","Intron","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intergenic (<10kb)","Intron","Intron","Intergenic (<10kb)","Intron","Promoter (-1500/+500bp)","Intron","Intron","Intergenic (<10kb)","Intron","Intergenic (<10kb)","Intergenic (>10kb)","Intron","Intron","Intron","Intergenic (>10kb)","Intron","Intron","Promoter (-1500/+500bp)","Exon","Intron","Intergenic (<10kb)","Intron","Intron","Intron","Intron","Intron","Intron","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Intergenic (>10kb)","Exon","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intron","Intron","Intergenic (>10kb)","Intron","Intron","Intergenic (<10kb)","Intron","Upstream Promoter (<5kb)","Intergenic (>10kb)","Intron","Intron","Intergenic (<10kb)","Intron","Intron","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intron","Intron","Intergenic (<10kb)","Intron","Intron","Intergenic (<10kb)","Intergenic (<10kb)","Intron","Intron","Intergenic (>10kb)","Intron","Intron","Exon","Intron","Intergenic (>10kb)","Intron","Upstream Promoter (<5kb)","Intergenic (>10kb)","Intron","Intron","Intron","Exon","Intron","Intron","Intron","Intron","Promoter (-1500/+500bp)","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intron","Intron","Upstream Promoter (<5kb)","Exon","Intron","Intron","Intron","Intron","Intergenic (<10kb)","Promoter (-1500/+500bp)","Intergenic (>10kb)","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Intergenic (>10kb)","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intron","Exon","Intergenic (<10kb)","Intron","Intron","Intron","Intergenic (>10kb)","Intron","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intergenic (<10kb)","Intron","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intron","Promoter (-1500/+500bp)","Intron","Intergenic (>10kb)","Intron","Promoter (-1500/+500bp)","Intron","Intron","Intron","Intron","Promoter (-1500/+500bp)","Intergenic (>10kb)","Intron","Intron","Intron","Intergenic (>10kb)","Intron","Intron","Promoter (-1500/+500bp)","Intergenic (>10kb)","Intron","Intron","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intron","Promoter (-1500/+500bp)","Intron","Intron","Intron","Intron","Intron","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Promoter (-1500/+500bp)"],"Feature":["Promoter","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Promoter","Enhancer","Enhancer","Enhancer","Promoter","Enhancer","Promoter","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Super Enhancer","Enhancer","No Feature","Enhancer","No Feature","Enhancer","No Feature","Super Enhancer","Enhancer","Enhancer","No Feature","Super Enhancer","Enhancer","Super Enhancer","Enhancer","Promoter","Super Enhancer","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Promoter","Enhancer","No Feature","Enhancer","Promoter","Promoter","Enhancer","Enhancer","No Feature","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","No Feature","Enhancer","Promoter","Promoter","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Super Enhancer","Enhancer","Super Enhancer","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Super Enhancer","Super Enhancer","Enhancer","Enhancer","Promoter","No Feature","No Feature","Enhancer","No Feature","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","Super Enhancer","No Feature","Super Enhancer","Enhancer","Promoter","Enhancer","Enhancer","Enhancer","No Feature","No Feature","Enhancer","No Feature","Super Enhancer","No Feature","Enhancer","No Feature","Enhancer","No Feature","Enhancer","Super Enhancer","Super Enhancer","No Feature","Enhancer","No Feature","Enhancer","Promoter","Super Enhancer","No Feature","Enhancer","Enhancer","Super Enhancer","No Feature","No Feature","Enhancer","Enhancer","No Feature","Enhancer","Promoter","Super Enhancer","No Feature","Promoter","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","No Feature","Enhancer","No Feature","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Super Enhancer","No Feature","Enhancer","Enhancer","Promoter","No Feature","Enhancer","No Feature","Super Enhancer","Enhancer","No Feature","Enhancer","Enhancer","Promoter","No Feature","Enhancer","Super Enhancer","No Feature","No Feature","Enhancer","Enhancer","No Feature","Enhancer","No Feature","No Feature","No Feature","No Feature","No Feature","No Feature","Enhancer","Promoter","Enhancer","Enhancer","No Feature","Enhancer","Super Enhancer","Enhancer","Super Enhancer","No Feature","Promoter","Enhancer","Enhancer","No Feature","Promoter"],"Genes":["FAM107B","","ARID5B; RTKN2","MINPP1; PAPSS2","RHOBTB1; ARID5B","LINC00595","LINC00595","LDB3","GSTO1; GSTO2; CFAP43; ITPRIP","DNAJC1; ARMC3","KIF11; HHEX; EXOC6; EIF2S2P3","ZNF22; C10orf25; RASSF4; AGAP7P; MSMB; NCOA4; TIMM23","PIP4K2A","KCNMA1","ADRA2A","ARID5B","DYDC2; PRXL2A; TSPAN14; CFAP70; PPP3CB-AS1; PPP3CB; USP54; CNNM2; NT5C2","PIP4K2A","KIAA1217","NUDT13; FAM149B1; P4HA1; AC016394.3; ECD; DNAJC9","LINC00595","ANAPC16; DDIT4; ASCC1; DNAJB12","BMPR1A; SNCG; MMRN2; ADIRF-AS1; LDB3","KIAA1217","RNLS; PTEN; ATAD1; KLLN","MCU","ABCC2; DNMBP","","RET; CSGALNACT2; RASGEF1A","EXOC6; MYOF","PFKFB3","CCDC7","DNAJC1; ARMC3","ANK3","HECTD2; PPP1R3C","TACC2","SHLD2; GLUD1","KIAA1217","PARD3","NEBL","CTNNA3","NEBL","SVIL","PPIF; FAM149B1; DNAJC9; AC016394.4; MRPS16; CFAP70; LINC00595","RNLS; PTEN; ATAD1; KLLN","SUFU","ANKRD26","AC022400.6","NEURL1","FGFR2","RHOBTB1","","","NEBL","SLK; SH3PXD2A; STN1; COL17A1","WASHC2A; AL442003.1","EXOC6; MYOF","","","TAF3","SCD; OLMALINC; SEC31B","ADO","KAT6B; VCL; ADK; AP3M1","PARD3","KIF11; HHEX; IDE; EIF2S2P3","NRP1; PARD3","AGAP14P","KIAA1217","DUSP5","MSMB; NCOA4; AGAP7P; TIMM23; CXCL12; RASSF4; ZNF22; C10orf25; ALOX5; MARCHF8; ZFAND4; AL356056.2; SYT15; FO681492.1; AGAP14P","STAM; STAM-AS1; CCNY","HK1; TSPAN15; TACR2","ADK; KAT6B","","RAB18","KAT6B; ADK","","KCNMA1","BICC1","LCOR","BMPR1A; SNCG; SHLD2; MMRN2; ADIRF-AS1; GLUD1","ANAPC16; DDIT4; ASCC1; DNAJB12","DIP2C","ANK3","CALML5; CALML3-AS1","","","FAM241B","CACNB2","ADK","","SLK; STN1; COL17A1","PIP4K2A","ATP5F1C; TAF3; GATA3","FRA10AC1; PLCE1; NOC3L; TBC1D12","LINC00595","CEP55; MYOF","","SCD; OLMALINC; CWF19L1; BLOC1S2; SEC31B; SLF2","ALDOAP2","PPIF; FAM149B1; DNAJC9; AC016394.4; MRPS16; CFAP70; LINC00595","CXCL12","TNKS2; BTAF1; FGFBP3","SCD; OLMALINC; HIF1AN; SEC31B; NDUFB8","","BTAF1","CDK1; ANK3","SEC23IP; MCMBP","CEP55; MYOF","","PAX2; SLF2; SEMA4G; TWNK; LZTS2; MRPL43; PDZD7","GDI2","","","PARD3; NRP1","SFMBT2","AKR1C4","CTNNA3","KAT6B; SAMD8; VDAC2; DUSP13; ADK","PARD3","DNAJC1","USP54; PRXL2A; CNNM2","HECTD2; PPP1R3C","ZNF248","SLC16A9; CCDC6; ANK3","SLC16A9; CCDC6; ANK3","KIF11; HHEX; EIF2S2P3","PRKG1","","ARID5B","","PARD3","ARID5B; RTKN2","ANK3","RBM17","","ANK3","","ZWINT","","CCDC6; ANK3","RPL17P34; MYOF; CEP55","TBC1D12","RAB18","CCAR1; STOX1","CTNNA3; ANXA2P3","RPP30; ANKRD1; KIF20B; PCGF5; PPP1R3C","CTNNA3","ALOX5; MSMB; NCOA4; TIMM23","ZNF438","ANK3; CDK1","ANXA2P3","LARP4B","PRXL2A; TSPAN14; FAM149B1; ECD; DNAJC9; CNNM2; NT5C2","SVIL2P","KAT6B; ADK","ST8SIA6-AS1; ST8SIA6; CCNY","AL117339.5","","SGMS1","MYPN","LINC00595; ZMIZ1-AS1; ZMIZ1","","ANK3","KIAA1217","KAT6B; ADK","CCSER2","KLF6","TAF3; GATA3","AL732437.3","","TWNK; LZTS2; SFXN3; KAZALD1; PDZD7","KCNMA1","FRMD4A","","MINPP1; PAPSS2","EDRF1; ALDOAP2","CACNB2; CCNY","","","USP6NL; ECHDC3","NEBL","","","DCLRE1C","TET1; COX20P1; CCAR1","DNMBP","PAPSS2; ATAD1","MINPP1; PAPSS2","KIAA1217","ARMC3; DNAJC1; COMMD3; BMI1; PIP4K2A","SFMBT2","","FAM107B","","PPIF; FAM149B1; DNAJC9; AC016394.4; MRPS16; CFAP70; LINC00595","DIP2C; LARP4B","","","MSMB; CXCL12; RASSF4; ZNF22; C10orf25; MARCHF8; ZFAND4; AL356056.2; SYT15; FO681492.1; AGAP14P"]},"columns":[{"accessor":"Range","name":"Range","type":"character","cell":["chr10: 14613701-14614700","chr10: 34188201-34189500","chr10: 63858801-63859900","chr10: 89407301-89408400","chr10: 62726701-62727700","chr10: 80502201-80503100","chr10: 80241301-80242300","chr10: 88424401-88425300","chr10: 106047801-106048700","chr10: 22254201-22255100","chr10: 94490801-94491800","chr10: 45496901-45497700","chr10: 22944001-22945000","chr10: 79257701-79259300","chr10: 112896701-112897700","chr10: 63697001-63697800","chr10: 82227401-82228300","chr10: 22755601-22756400","chr10: 24158301-24159100","chr10: 74877401-74878300","chr10: 80489301-80490300","chr10: 74008401-74009200","chr10: 88664401-88665000","chr10: 24173601-24174500","chr10: 90132701-90133600","chr10: 74547501-74548400","chr10: 101653901-101654800","chr10: 8576801-8577900","chr10: 43689901-43690700","chr10: 94663201-94664100","chr10: 6297101-6298000","chr10: 32982001-32983000","chr10: 22375501-22376300","chr10: 62042501-62043200","chr10: 93318901-93319800","chr10: 123880401-123881100","chr10: 88851001-88851700","chr10: 24552301-24552800","chr10: 34758101-34759500","chr10: 21520301-21520800","chr10: 67094801-67095800","chr10: 21177401-21178300","chr10: 30086401-30087200","chr10: 81101701-81102300","chr10: 90248701-90249600","chr10: 104272101-104272800","chr10: 27276601-27277600","chr10: 75474501-75475200","chr10: 105308401-105309100","chr10: 123348901-123349400","chr10: 62715601-62716500","chr10: 35979601-35980100","chr10: 25459301-25460100","chr10: 21472901-21473800","chr10: 105711501-105712100","chr10: 51767401-51768200","chr10: 94662101-94662700","chr10: 77492801-77493600","chr10: 84985701-84986100","chr10: 8049001-8049600","chr10: 102180301-102180900","chr10: 64566701-64567400","chr10: 76781801-76782300","chr10: 34441101-34441900","chr10: 94422801-94423400","chr10: 33483001-33483400","chr10: 47727401-47728100","chr10: 24518701-24519500","chr10: 112217801-112218500","chr10: 51578301-51579200","chr10: 17710601-17711300","chr10: 71145601-71147100","chr10: 76546001-76546300","chr10: 84952401-84953000","chr10: 27774301-27774800","chr10: 76720301-76720900","chr10: 22471701-22472200","chr10: 79266801-79267600","chr10: 61296301-61297000","chr10: 98623401-98624500","chr10: 88766901-88767700","chr10: 74014601-74015400","chr10: 500601-501400","chr10: 62408601-62409000","chr10: 5533901-5534800","chr10: 110481601-110482100","chr10: 73151401-73152000","chr10: 71409801-71410500","chr10: 18614901-18615800","chr10: 76447501-76448300","chr10: 22457201-22457800","chr10: 105778101-105778800","chr10: 22971801-22972700","chr10: 9269801-9270500","chr10: 95513201-95514000","chr10: 80185701-80186400","chr10: 95203701-95204500","chr10: 8656201-8656900","chr10: 102101501-102101800","chr10: 127280301-127280900","chr10: 81100401-81101000","chr10: 44976301-44976800","chr10: 93686201-93687100","chr10: 102202301-102202900","chr10: 62884301-62884900","chr10: 93729501-93730000","chr10: 62484701-62485400","chr10: 121702401-121702800","chr10: 95194701-95195500","chr10: 109345801-109346500","chr10: 102685401-102686000","chr10: 5813901-5814600","chr10: 57898901-57899700","chr10: 31491201-31492000","chr10: 34947501-34948500","chr10: 7275301-7276000","chr10: 5308001-5308900","chr10: 68879301-68880000","chr10: 76887201-76887700","chr10: 34914901-34915700","chr10: 22159501-22160300","chr10: 75335901-75336600","chr10: 93315001-93315400","chr10: 38130201-38130900","chr10: 61591701-61592000","chr10: 61595201-61595600","chr10: 94471601-94472400","chr10: 54012001-54012800","chr10: 73350001-73350400","chr10: 63776501-63777300","chr10: 84223201-84223600","chr10: 34872201-34873100","chr10: 63866701-63867300","chr10: 61900501-61901000","chr10: 6407201-6407500","chr10: 35127201-35128100","chr10: 62491101-62491500","chr10: 29396501-29397100","chr10: 58143501-58144100","chr10: 8832001-8832800","chr10: 61751601-61751900","chr10: 95143701-95144400","chr10: 96242701-96243000","chr10: 27830801-27831300","chr10: 70556001-70556500","chr10: 69307201-69307500","chr10: 92647401-92647800","chr10: 68876301-68876600","chr10: 45774201-45774700","chr10: 31393701-31394400","chr10: 62233401-62234000","chr10: 66627301-66628100","chr10: 839201-839500","chr10: 82271901-82272400","chr10: 30898101-30898800","chr10: 76707701-76708400","chr10: 17507901-17508400","chr10: 38486201-38486600","chr10: 108268501-108269100","chr10: 52271601-52272100","chr10: 69865701-69866000","chr10: 79959501-79960100","chr10: 8903701-8904000","chr10: 62027401-62028200","chr10: 24705401-24705800","chr10: 76707201-76707500","chr10: 86104901-86105400","chr10: 3852501-3852800","chr10: 8054701-8055200","chr10: 5596501-5596900","chr10: 85576701-85577200","chr10: 102851601-102852200","chr10: 79245801-79246600","chr10: 13728201-13728500","chr10: 8170501-8171200","chr10: 89404401-89405100","chr10: 127335001-127335300","chr10: 17645401-17646200","chr10: 63054201-63054600","chr10: 109509001-109509600","chr10: 11564801-11565400","chr10: 21184601-21184900","chr10: 59519401-59519800","chr10: 21559601-21560100","chr10: 14968101-14968600","chr10: 70393701-70394500","chr10: 101686901-101687400","chr10: 89502801-89503200","chr10: 89405801-89406300","chr10: 24630701-24631000","chr10: 23256901-23257500","chr10: 7273601-7274000","chr10: 3930101-3930700","chr10: 14729601-14729900","chr10: 90399901-90400600","chr10: 81102701-81103000","chr10: 579401-579700","chr10: 8915001-8915300","chr10: 29530001-29530600","chr10: 51549401-51549700"],"minWidth":150},{"accessor":"Width (kb)","name":"Width (kb)","type":"numeric","cell":["1","1.3","1.1","1.1","1","0.9","1","0.9","0.9","0.9","1","0.8","1","1.6","1","0.8","0.9","0.8","0.8","0.9","1","0.8","0.6","0.9","0.9","0.9","0.9","1.1","0.8","0.9","0.9","1","0.8","0.7","0.9","0.7","0.7","0.5","1.4","0.5","1","0.9","0.8","0.6","0.9","0.7","1","0.7","0.7","0.5","0.9","0.5","0.8","0.9","0.6","0.8","0.6","0.8","0.4","0.6","0.6","0.7","0.5","0.8","0.6","0.4","0.7","0.8","0.7","0.9","0.7","1.5","0.3","0.6","0.5","0.6","0.5","0.8","0.7","1.1","0.8","0.8","0.8","0.4","0.9","0.5","0.6","0.7","0.9","0.8","0.6","0.7","0.9","0.7","0.8","0.7","0.8","0.7","0.3","0.6","0.6","0.5","0.9","0.6","0.6","0.5","0.7","0.4","0.8","0.7","0.6","0.7","0.8","0.8","1","0.7","0.9","0.7","0.5","0.8","0.8","0.7","0.4","0.7","0.3","0.4","0.8","0.8","0.4","0.8","0.4","0.9","0.6","0.5","0.3","0.9","0.4","0.6","0.6","0.8","0.3","0.7","0.3","0.5","0.5","0.3","0.4","0.3","0.5","0.7","0.6","0.8","0.3","0.5","0.7","0.7","0.5","0.4","0.6","0.5","0.3","0.6","0.3","0.8","0.4","0.3","0.5","0.3","0.5","0.4","0.5","0.6","0.8","0.3","0.7","0.7","0.3","0.8","0.4","0.6","0.6","0.3","0.4","0.5","0.5","0.8","0.5","0.4","0.5","0.3","0.6","0.4","0.6","0.3","0.7","0.3","0.3","0.3","0.6","0.3"],"maxWidth":70,"style":[{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#D79986","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DDBB9E","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DDBB9E","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#D35C79","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DDBB9E","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#D5877C","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#D3717A","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DDBB9E","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E1CBAD","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#E8DABB","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#EFE9C9","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#B3C7AE","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#9FBCA4","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#DBDDC0","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#C7D2B8","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#81B29B","borderRight":"1px solid rgba(0, 0, 0, 0.1)"}]},{"accessor":"AveExpr","name":"AveExpr","type":"numeric","cell":["5.32","5.38","4.51","4.83","4.45","4.74","4.96","4.35","4.62","5.14","4.71","4.69","4.63","4.52","3.98","4.75","4.45","4.6","4.68","4.92","4.47","4.8","4.09","4.81","4.4","4.22","4.48","4.91","4.37","4.34","4.93","4.67","4.81","4.08","4.53","3.68","4.14","4.58","4.78","4.29","4.51","4.83","4.28","4.34","4.15","3.81","4.81","3.75","4.14","3.81","4.44","4.56","4.23","4.87","4.08","4.2","4.18","4.13","4.62","3.93","4.3","4.26","4.26","4.81","4.29","4.57","3.71","4.63","3.85","4.38","4.19","4.41","4.2","4.61","3.96","4.38","4.34","3.9","3.89","4.38","3.99","3.97","4.33","3.63","4.69","3.63","3.77","4.1","4.34","4.08","4.52","4.03","4.37","4.38","4.23","4.12","4.15","4.47","3.78","3.53","3.98","3.76","4.22","3.96","3.85","3.74","4.3","3.68","4.37","4.09","4.03","4.44","4.2","4.45","4.73","4.25","4.31","4","4.11","4.46","4.25","4.1","3.95","4.03","3.82","3.88","4.36","3.92","3.91","4.57","3.91","4.52","4.3","3.96","4.01","4.64","3.85","4.35","3.95","4.42","3.79","4.05","3.79","4.65","4.09","3.82","3.98","3.94","3.87","4.34","4.18","4.05","4.08","3.9","4.16","4.22","4.31","4.05","4.1","4.12","3.92","4.04","4.18","4.22","4.19","3.83","3.89","3.9","4.24","4","4.26","3.92","4.35","4.04","4.2","3.98","3.64","4.34","3.88","3.88","4.06","4.18","3.93","4.22","4.06","4.45","3.85","3.83","4.39","4.11","4.18","4.17","4.23","4.21","4.12","3.83","3.97","4.58","3.78","3.87"],"maxWidth":80,"style":[{"background":"#D36679"},{"background":"#D35C79"},{"background":"#EBE2C2"},{"background":"#DCB79B"},{"background":"#EDE8C8"},{"background":"#DFC3A6"},{"background":"#D8A38B"},{"background":"#DDDEC1"},{"background":"#E5D3B5"},{"background":"#D5887C"},{"background":"#E0C8AA"},{"background":"#E0CAAC"},{"background":"#E4D1B3"},{"background":"#EBE0C1"},{"background":"#9BBBA3"},{"background":"#DEC2A5"},{"background":"#EEE8C8"},{"background":"#E5D5B6"},{"background":"#E1CBAD"},{"background":"#D8AA8F"},{"background":"#EDE6C6"},{"background":"#DCBA9E"},{"background":"#B0C5AC"},{"background":"#DCBA9D"},{"background":"#E5E3C4"},{"background":"#C6D1B7"},{"background":"#EDE5C6"},{"background":"#D9AC91"},{"background":"#E0E0C2"},{"background":"#DBDDC0"},{"background":"#D8A88E"},{"background":"#E1CDAE"},{"background":"#DCB89C"},{"background":"#ADC3AB"},{"background":"#EADFC0"},{"background":"#40A293"},{"background":"#B9CAB1"},{"background":"#E7D8B9"},{"background":"#DDBDA0"},{"background":"#D2D8BD"},{"background":"#EBE2C2"},{"background":"#DCB79A"},{"background":"#D0D7BB"},{"background":"#DBDDC0"},{"background":"#BACAB1"},{"background":"#70AD96"},{"background":"#DCB99D"},{"background":"#5BA793"},{"background":"#B7C9B0"},{"background":"#6EAC96"},{"background":"#ECE7C7"},{"background":"#E8DBBC"},{"background":"#C7D2B8"},{"background":"#DAB195"},{"background":"#ADC4AB"},{"background":"#C2CFB5"},{"background":"#BECDB3"},{"background":"#B5C8AF"},{"background":"#E4D3B4"},{"background":"#8FB79F"},{"background":"#D4D9BD"},{"background":"#CCD5BA"},{"background":"#CCD5BA"},{"background":"#DCBA9D"},{"background":"#D1D8BC"},{"background":"#E7D9BA"},{"background":"#4AA493"},{"background":"#E4D2B4"},{"background":"#78AF99"},{"background":"#E1E1C3"},{"background":"#C1CFB5"},{"background":"#E8E5C6"},{"background":"#C2CFB5"},{"background":"#E5D4B5"},{"background":"#95B9A1"},{"background":"#E2E1C3"},{"background":"#DBDDC0"},{"background":"#87B49D"},{"background":"#83B39C"},{"background":"#E2E1C3"},{"background":"#9DBBA3"},{"background":"#99BAA2"},{"background":"#D9DCBF"},{"background":"#2B9D93"},{"background":"#E0CAAC"},{"background":"#2A9D93"},{"background":"#65A993"},{"background":"#B1C5AD"},{"background":"#DBDDC0"},{"background":"#ADC3AB"},{"background":"#EAE0C0"},{"background":"#A5BFA7"},{"background":"#E0E0C2"},{"background":"#E1E1C3"},{"background":"#C8D2B8"},{"background":"#B4C7AE"},{"background":"#BACBB1"},{"background":"#EEE7C7"},{"background":"#68AA94"},{"background":"#009593"},{"background":"#9BBBA3"},{"background":"#62A893"},{"background":"#C5D1B7"},{"background":"#96B9A1"},{"background":"#79AF99"},{"background":"#57A693"},{"background":"#D3D9BD"},{"background":"#40A293"},{"background":"#E0E0C2"},{"background":"#B0C5AC"},{"background":"#A6BFA7"},{"background":"#ECE7C7"},{"background":"#C2CFB5"},{"background":"#EEE8C8"},{"background":"#DFC4A6"},{"background":"#CBD4B9"},{"background":"#D6DBBE"},{"background":"#A0BCA4"},{"background":"#B3C7AE"},{"background":"#EEE8C8"},{"background":"#CBD4B9"},{"background":"#B2C6AD"},{"background":"#92B8A0"},{"background":"#A4BFA6"},{"background":"#70AD96"},{"background":"#80B29B"},{"background":"#DFDFC2"},{"background":"#8BB59E"},{"background":"#8AB59E"},{"background":"#E7D9BA"},{"background":"#8AB59E"},{"background":"#EBE1C1"},{"background":"#D3D9BD"},{"background":"#96B9A1"},{"background":"#A2BDA5"},{"background":"#E3D1B2"},{"background":"#78AF99"},{"background":"#DDDEC1"},{"background":"#93B8A0"},{"background":"#E9E5C6"},{"background":"#69AA94"},{"background":"#A9C1A9"},{"background":"#6AAB95"},{"background":"#E3CFB1"},{"background":"#AFC5AC"},{"background":"#72AD97"},{"background":"#9BBAA3"},{"background":"#90B79F"},{"background":"#7FB19B"},{"background":"#DBDDC0"},{"background":"#C0CEB4"},{"background":"#A9C1A9"},{"background":"#ADC4AB"},{"background":"#87B49D"},{"background":"#BCCCB2"},{"background":"#C5D1B7"},{"background":"#D5DABE"},{"background":"#A8C1A8"},{"background":"#B0C5AC"},{"background":"#B4C7AE"},{"background":"#8BB59E"},{"background":"#A6C0A7"},{"background":"#BFCEB4"},{"background":"#C7D2B8"},{"background":"#C1CEB5"},{"background":"#74AE97"},{"background":"#84B39C"},{"background":"#86B49D"},{"background":"#CAD4B9"},{"background":"#9FBCA4"},{"background":"#CDD5BA"},{"background":"#8DB69E"},{"background":"#DDDEC1"},{"background":"#A7C0A8"},{"background":"#C3D0B6"},{"background":"#9ABAA2"},{"background":"#2D9E93"},{"background":"#DBDDC0"},{"background":"#81B29B"},{"background":"#82B29B"},{"background":"#AAC2A9"},{"background":"#BFCEB4"},{"background":"#8EB69F"},{"background":"#C6D1B7"},{"background":"#AAC2A9"},{"background":"#EDE8C8"},{"background":"#78AF99"},{"background":"#75AE98"},{"background":"#E3E2C4"},{"background":"#B3C7AE"},{"background":"#BFCEB4"},{"background":"#BECDB3"},{"background":"#C7D2B8"},{"background":"#C5D0B7"},{"background":"#B4C7AE"},{"background":"#74AE97"},{"background":"#98BAA2"},{"background":"#E7D8B9"},{"background":"#67AA94"},{"background":"#7EB19A"}]},{"accessor":"logFC","name":"logFC","type":"numeric","cell":["3.1","2.84","4.08","3.61","3.7","3.35","2.81","3.63","3.22","2.53","2.97","3.29","2.91","3.01","3.15","2.69","2.85","2.79","3.05","2.44","2.96","2.61","2.96","2.51","2.74","2.85","2.83","2.5","2.68","2.76","2.48","2.54","2.39","2.59","2.68","3.22","2.53","2.43","2.26","2.47","2.47","2.12","2.34","2.44","2.54","2.65","2.11","2.74","2.37","2.74","2.18","2.11","2.37","1.91","2.41","2.31","2.18","2.19","2","2.27","2.15","2.19","2.31","1.88","2.11","2.01","2.64","1.95","2.45","2.04","2.1","2","2.26","1.89","2.19","2.04","2.07","2.3","2.19","1.96","2.09","2.08","1.93","2.5","1.97","2.45","2.39","2.12","2.11","1.95","1.88","2.24","2.04","1.83","1.85","1.88","1.98","1.83","2.14","2.54","1.91","2.12","1.83","2.05","2.14","2.3","1.95","2.52","1.81","1.84","1.87","1.98","2.17","1.82","1.64","1.84","1.8","1.94","1.85","1.84","1.77","1.8","1.82","1.97","1.99","1.9","1.77","1.85","1.81","1.59","1.81","1.62","1.65","1.78","1.79","1.52","1.88","1.62","1.77","1.63","1.81","1.64","1.82","1.46","1.7","1.79","1.75","1.7","1.68","1.56","1.57","1.62","1.56","1.67","1.52","1.52","1.63","1.61","1.86","1.5","1.63","1.54","1.55","1.52","1.55","1.67","1.6","1.61","1.54","1.58","1.57","1.53","1.46","1.65","1.46","1.55","1.86","1.34","1.56","1.74","1.41","1.45","1.51","1.4","1.39","1.33","1.53","1.58","1.3","1.37","1.35","1.34","1.37","1.29","1.42","1.5","1.36","1.18","1.62","1.41"],"maxWidth":70,"style":[{"background":"#D63C55"},{"background":"#DA4D63"},{"background":"#CA0020"},{"background":"#D01D39"},{"background":"#CE1734"},{"background":"#D32D47"},{"background":"#DA4E65"},{"background":"#CF1C38"},{"background":"#D5354E"},{"background":"#DE6074"},{"background":"#D8455C"},{"background":"#D4314B"},{"background":"#D9485F"},{"background":"#D7425A"},{"background":"#D63952"},{"background":"#DC576C"},{"background":"#D94C63"},{"background":"#DA5066"},{"background":"#D74058"},{"background":"#DF6679"},{"background":"#D8455C"},{"background":"#DD5B70"},{"background":"#D8455C"},{"background":"#DE6275"},{"background":"#DB5369"},{"background":"#D94C63"},{"background":"#DA4D64"},{"background":"#DE6276"},{"background":"#DC576C"},{"background":"#DB5268"},{"background":"#DE6477"},{"background":"#DE6074"},{"background":"#DF697C"},{"background":"#DD5C71"},{"background":"#DC576C"},{"background":"#D5354E"},{"background":"#DE6074"},{"background":"#DF6679"},{"background":"#E17183"},{"background":"#DE6477"},{"background":"#DE6478"},{"background":"#E37A8A"},{"background":"#E06C7E"},{"background":"#DF6679"},{"background":"#DE6074"},{"background":"#DC596D"},{"background":"#E37A8B"},{"background":"#DB5369"},{"background":"#E06A7D"},{"background":"#DB5368"},{"background":"#E27687"},{"background":"#E37A8B"},{"background":"#E06A7D"},{"background":"#E68796"},{"background":"#DF687B"},{"background":"#E16E80"},{"background":"#E27687"},{"background":"#E27587"},{"background":"#E48191"},{"background":"#E17082"},{"background":"#E37889"},{"background":"#E27687"},{"background":"#E06E80"},{"background":"#E68998"},{"background":"#E37B8B"},{"background":"#E48191"},{"background":"#DC596E"},{"background":"#E58494"},{"background":"#DF6578"},{"background":"#E47F8F"},{"background":"#E37B8C"},{"background":"#E58291"},{"background":"#E17183"},{"background":"#E68997"},{"background":"#E27586"},{"background":"#E47F8F"},{"background":"#E47D8D"},{"background":"#E16E80"},{"background":"#E27587"},{"background":"#E58493"},{"background":"#E37C8C"},{"background":"#E37C8D"},{"background":"#E58695"},{"background":"#DE6276"},{"background":"#E58393"},{"background":"#DF6578"},{"background":"#DF697C"},{"background":"#E37A8B"},{"background":"#E37B8B"},{"background":"#E58594"},{"background":"#E68997"},{"background":"#E17284"},{"background":"#E47F8F"},{"background":"#E78C9A"},{"background":"#E68B99"},{"background":"#E68998"},{"background":"#E58392"},{"background":"#E78C9B"},{"background":"#E3798A"},{"background":"#DD6074"},{"background":"#E68796"},{"background":"#E37A8B"},{"background":"#E78C9A"},{"background":"#E47E8E"},{"background":"#E3798A"},{"background":"#E16F81"},{"background":"#E58594"},{"background":"#DE6175"},{"background":"#E78D9B"},{"background":"#E78B9A"},{"background":"#E68A98"},{"background":"#E58392"},{"background":"#E27788"},{"background":"#E78D9B"},{"background":"#E998A5"},{"background":"#E78B9A"},{"background":"#E78E9C"},{"background":"#E58594"},{"background":"#E68B99"},{"background":"#E78B9A"},{"background":"#E7909E"},{"background":"#E78E9C"},{"background":"#E78D9B"},{"background":"#E58493"},{"background":"#E58292"},{"background":"#E68896"},{"background":"#E7909E"},{"background":"#E68B99"},{"background":"#E78D9C"},{"background":"#EA9BA8"},{"background":"#E78D9C"},{"background":"#EA99A6"},{"background":"#E997A4"},{"background":"#E78F9D"},{"background":"#E78E9D"},{"background":"#EB9FAB"},{"background":"#E68997"},{"background":"#E999A6"},{"background":"#E7909D"},{"background":"#E999A6"},{"background":"#E78D9B"},{"background":"#E998A5"},{"background":"#E78D9B"},{"background":"#ECA3AF"},{"background":"#E894A1"},{"background":"#E78E9C"},{"background":"#E8919F"},{"background":"#E894A2"},{"background":"#E995A2"},{"background":"#EA9DA9"},{"background":"#EA9DA9"},{"background":"#E999A6"},{"background":"#EA9DA9"},{"background":"#E996A3"},{"background":"#EB9FAB"},{"background":"#EB9FAB"},{"background":"#E998A5"},{"background":"#EA9AA6"},{"background":"#E68A99"},{"background":"#EBA0AC"},{"background":"#E999A5"},{"background":"#EB9EAA"},{"background":"#EA9DA9"},{"background":"#EBA0AB"},{"background":"#EA9EAA"},{"background":"#E996A3"},{"background":"#EA9AA7"},{"background":"#EA9AA6"},{"background":"#EA9EAA"},{"background":"#EA9CA8"},{"background":"#EA9DA9"},{"background":"#EB9FAB"},{"background":"#ECA3AF"},{"background":"#E997A4"},{"background":"#ECA3AF"},{"background":"#EA9EAA"},{"background":"#E68A99"},{"background":"#EDAAB5"},{"background":"#EA9DA9"},{"background":"#E8929F"},{"background":"#ECA6B1"},{"background":"#ECA4AF"},{"background":"#EBA0AC"},{"background":"#ECA7B2"},{"background":"#ECA7B2"},{"background":"#EDACB6"},{"background":"#EB9FAB"},{"background":"#EA9CA8"},{"background":"#EEADB8"},{"background":"#EDA9B4"},{"background":"#EDAAB5"},{"background":"#EDABB5"},{"background":"#EDA9B3"},{"background":"#EEAEB8"},{"background":"#ECA6B1"},{"background":"#EBA1AC"},{"background":"#EDAAB4"},{"background":"#EFB5BE"},{"background":"#E999A6"},{"background":"#ECA6B1"}]},{"accessor":"FDR","name":"FDR","type":"numeric","cell":["2.13e-14","2.13e-14","2.13e-14","2.13e-14","1.65e-13","3.21e-13","3.33e-12","3.33e-12","3.33e-12","5.13e-12","9.32e-12","1.14e-11","1.54e-11","7.59e-11","7.59e-11","8.47e-11","8.47e-11","8.63e-11","8.63e-11","9.93e-11","1.01e-10","1.23e-10","1.53e-10","2.29e-10","3.21e-10","3.44e-10","3.44e-10","3.63e-10","5.34e-10","5.97e-10","6.65e-10","1.21e-09","1.70e-09","4.46e-09","4.88e-09","5.08e-09","5.86e-09","6.06e-09","7.85e-09","9.43e-09","9.88e-09","1.45e-08","1.64e-08","1.67e-08","1.99e-08","1.99e-08","2.86e-08","2.89e-08","2.89e-08","2.93e-08","4.65e-08","5.88e-08","6.78e-08","7.27e-08","7.79e-08","8.25e-08","9.82e-08","1.02e-07","1.09e-07","1.18e-07","1.18e-07","1.25e-07","1.29e-07","1.34e-07","1.34e-07","1.38e-07","1.81e-07","1.83e-07","2.07e-07","2.26e-07","2.29e-07","2.41e-07","2.75e-07","2.96e-07","3.03e-07","3.03e-07","3.06e-07","3.07e-07","3.24e-07","3.69e-07","5.47e-07","5.91e-07","6.32e-07","6.47e-07","6.91e-07","6.91e-07","6.98e-07","7.48e-07","7.85e-07","1.00e-06","1.10e-06","1.18e-06","1.44e-06","1.58e-06","1.60e-06","1.69e-06","1.70e-06","1.70e-06","1.71e-06","1.81e-06","2.05e-06","2.11e-06","2.24e-06","2.26e-06","2.26e-06","2.26e-06","2.26e-06","2.26e-06","2.27e-06","2.27e-06","2.45e-06","2.50e-06","2.63e-06","2.72e-06","2.80e-06","2.94e-06","3.23e-06","3.35e-06","3.94e-06","4.56e-06","4.70e-06","4.83e-06","5.50e-06","5.63e-06","5.89e-06","7.03e-06","7.37e-06","7.76e-06","9.59e-06","1.01e-05","1.02e-05","1.08e-05","1.09e-05","1.15e-05","1.28e-05","1.45e-05","1.54e-05","1.87e-05","1.87e-05","1.99e-05","2.08e-05","2.19e-05","2.35e-05","2.47e-05","2.65e-05","2.68e-05","2.68e-05","3.29e-05","3.57e-05","3.59e-05","3.60e-05","3.60e-05","4.48e-05","4.78e-05","5.60e-05","5.72e-05","5.81e-05","6.04e-05","6.29e-05","6.41e-05","6.41e-05","6.41e-05","6.70e-05","7.05e-05","7.05e-05","7.38e-05","7.38e-05","8.11e-05","8.22e-05","9.99e-05","1.02e-04","1.27e-04","1.38e-04","1.43e-04","1.58e-04","1.59e-04","1.60e-04","1.89e-04","1.94e-04","1.95e-04","2.06e-04","2.06e-04","2.09e-04","2.17e-04","2.18e-04","2.51e-04","2.78e-04","3.05e-04","3.08e-04","3.11e-04","3.28e-04","3.66e-04","3.66e-04","4.50e-04","4.93e-04","4.96e-04","5.55e-04","5.63e-04","5.71e-04","6.00e-04"],"maxWidth":80,"style":{"borderRight":"1px solid rgba(0, 0, 0, 0.1)"}},{"accessor":"Macs2 Peak","name":"Macs2 Peak","type":"logical","cell":["✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✖ No","✔ Yes","✖ No","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✖ No","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✖ No","✔ Yes","✔ Yes","✖ No","✔ Yes","✔ Yes","✔ Yes","✖ No","✔ Yes","✖ No","✖ No","✔ Yes","✔ Yes","✖ No","✔ Yes","✖ No","✔ Yes","✖ No","✖ No","✖ No","✔ Yes","✔ Yes","✖ No","✔ Yes","✔ Yes","✖ No","✔ Yes","✖ No","✔ Yes","✔ Yes","✖ No","✖ No","✖ No","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✖ No","✖ No","✔ Yes","✖ No","✔ Yes","✖ No","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✖ No","✔ Yes","✖ No","✖ No","✖ No","✖ No","✖ No","✖ No","✔ Yes","✔ Yes","✔ Yes","✖ No","✔ Yes","✖ No","✔ Yes","✔ Yes","✖ No","✔ Yes","✖ No","✖ No","✔ Yes","✖ No","✖ No","✔ Yes","✖ No","✔ Yes","✖ No","✖ No","✔ Yes","✖ No","✖ No","✖ No","✔ Yes","✖ No","✖ No","✖ No","✖ No","✖ No"],"maxWidth":70,"style":[{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#e00000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"}]},{"accessor":"Region","name":"Region","type":"factor","maxWidth":150},{"accessor":"Feature","name":"Feature","type":"factor"},{"accessor":"Genes","name":"Genes","type":"character","cell":[{"name":"span","attribs":{"title":"FAM107B"},"children":["FAM107B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ARID5B; RTKN2"},"children":["ARID5B; RTKN2"]},{"name":"span","attribs":{"title":"MINPP1; PAPSS2"},"children":["MINPP1; PAPSS2"]},{"name":"span","attribs":{"title":"RHOBTB1; ARID5B"},"children":["RHOBTB1; ARID5B"]},{"name":"span","attribs":{"title":"LINC00595"},"children":["LINC00595"]},{"name":"span","attribs":{"title":"LINC00595"},"children":["LINC00595"]},{"name":"span","attribs":{"title":"LDB3"},"children":["LDB3"]},{"name":"span","attribs":{"title":"GSTO1; GSTO2; CFAP43; ITPRIP"},"children":["GSTO1; GSTO2; CFAP43; ITPRIP"]},{"name":"span","attribs":{"title":"DNAJC1; ARMC3"},"children":["DNAJC1; ARMC3"]},{"name":"span","attribs":{"title":"KIF11; HHEX; EXOC6; EIF2S2P3"},"children":["KIF11; HHEX; EXOC6; EIF2S2P3"]},{"name":"span","attribs":{"title":"ZNF22; C10orf25; RASSF4; AGAP7P; MSMB; NCOA4; TIMM23"},"children":["ZNF22; C10orf25; RASSF4; AG..."]},{"name":"span","attribs":{"title":"PIP4K2A"},"children":["PIP4K2A"]},{"name":"span","attribs":{"title":"KCNMA1"},"children":["KCNMA1"]},{"name":"span","attribs":{"title":"ADRA2A"},"children":["ADRA2A"]},{"name":"span","attribs":{"title":"ARID5B"},"children":["ARID5B"]},{"name":"span","attribs":{"title":"DYDC2; PRXL2A; TSPAN14; CFAP70; PPP3CB-AS1; PPP3CB; USP54; CNNM2; NT5C2"},"children":["DYDC2; PRXL2A; TSPAN14; CFA..."]},{"name":"span","attribs":{"title":"PIP4K2A"},"children":["PIP4K2A"]},{"name":"span","attribs":{"title":"KIAA1217"},"children":["KIAA1217"]},{"name":"span","attribs":{"title":"NUDT13; FAM149B1; P4HA1; AC016394.3; ECD; DNAJC9"},"children":["NUDT13; FAM149B1; P4HA1; AC..."]},{"name":"span","attribs":{"title":"LINC00595"},"children":["LINC00595"]},{"name":"span","attribs":{"title":"ANAPC16; DDIT4; ASCC1; DNAJB12"},"children":["ANAPC16; DDIT4; ASCC1; DNAJB12"]},{"name":"span","attribs":{"title":"BMPR1A; SNCG; MMRN2; ADIRF-AS1; LDB3"},"children":["BMPR1A; SNCG; MMRN2; ADIRF-..."]},{"name":"span","attribs":{"title":"KIAA1217"},"children":["KIAA1217"]},{"name":"span","attribs":{"title":"RNLS; PTEN; ATAD1; KLLN"},"children":["RNLS; PTEN; ATAD1; KLLN"]},{"name":"span","attribs":{"title":"MCU"},"children":["MCU"]},{"name":"span","attribs":{"title":"ABCC2; DNMBP"},"children":["ABCC2; DNMBP"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"RET; CSGALNACT2; RASGEF1A"},"children":["RET; CSGALNACT2; RASGEF1A"]},{"name":"span","attribs":{"title":"EXOC6; MYOF"},"children":["EXOC6; MYOF"]},{"name":"span","attribs":{"title":"PFKFB3"},"children":["PFKFB3"]},{"name":"span","attribs":{"title":"CCDC7"},"children":["CCDC7"]},{"name":"span","attribs":{"title":"DNAJC1; ARMC3"},"children":["DNAJC1; ARMC3"]},{"name":"span","attribs":{"title":"ANK3"},"children":["ANK3"]},{"name":"span","attribs":{"title":"HECTD2; PPP1R3C"},"children":["HECTD2; PPP1R3C"]},{"name":"span","attribs":{"title":"TACC2"},"children":["TACC2"]},{"name":"span","attribs":{"title":"SHLD2; GLUD1"},"children":["SHLD2; GLUD1"]},{"name":"span","attribs":{"title":"KIAA1217"},"children":["KIAA1217"]},{"name":"span","attribs":{"title":"PARD3"},"children":["PARD3"]},{"name":"span","attribs":{"title":"NEBL"},"children":["NEBL"]},{"name":"span","attribs":{"title":"CTNNA3"},"children":["CTNNA3"]},{"name":"span","attribs":{"title":"NEBL"},"children":["NEBL"]},{"name":"span","attribs":{"title":"SVIL"},"children":["SVIL"]},{"name":"span","attribs":{"title":"PPIF; FAM149B1; DNAJC9; AC016394.4; MRPS16; CFAP70; LINC00595"},"children":["PPIF; FAM149B1; DNAJC9; AC0..."]},{"name":"span","attribs":{"title":"RNLS; PTEN; ATAD1; KLLN"},"children":["RNLS; PTEN; ATAD1; KLLN"]},{"name":"span","attribs":{"title":"SUFU"},"children":["SUFU"]},{"name":"span","attribs":{"title":"ANKRD26"},"children":["ANKRD26"]},{"name":"span","attribs":{"title":"AC022400.6"},"children":["AC022400.6"]},{"name":"span","attribs":{"title":"NEURL1"},"children":["NEURL1"]},{"name":"span","attribs":{"title":"FGFR2"},"children":["FGFR2"]},{"name":"span","attribs":{"title":"RHOBTB1"},"children":["RHOBTB1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"NEBL"},"children":["NEBL"]},{"name":"span","attribs":{"title":"SLK; SH3PXD2A; STN1; COL17A1"},"children":["SLK; SH3PXD2A; STN1; COL17A1"]},{"name":"span","attribs":{"title":"WASHC2A; AL442003.1"},"children":["WASHC2A; AL442003.1"]},{"name":"span","attribs":{"title":"EXOC6; MYOF"},"children":["EXOC6; MYOF"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"TAF3"},"children":["TAF3"]},{"name":"span","attribs":{"title":"SCD; OLMALINC; SEC31B"},"children":["SCD; OLMALINC; SEC31B"]},{"name":"span","attribs":{"title":"ADO"},"children":["ADO"]},{"name":"span","attribs":{"title":"KAT6B; VCL; ADK; AP3M1"},"children":["KAT6B; VCL; ADK; AP3M1"]},{"name":"span","attribs":{"title":"PARD3"},"children":["PARD3"]},{"name":"span","attribs":{"title":"KIF11; HHEX; IDE; EIF2S2P3"},"children":["KIF11; HHEX; IDE; EIF2S2P3"]},{"name":"span","attribs":{"title":"NRP1; PARD3"},"children":["NRP1; PARD3"]},{"name":"span","attribs":{"title":"AGAP14P"},"children":["AGAP14P"]},{"name":"span","attribs":{"title":"KIAA1217"},"children":["KIAA1217"]},{"name":"span","attribs":{"title":"DUSP5"},"children":["DUSP5"]},{"name":"span","attribs":{"title":"MSMB; NCOA4; AGAP7P; TIMM23; CXCL12; RASSF4; ZNF22; C10orf25; ALOX5; MARCHF8; ZFAND4; AL356056.2; SYT15; FO681492.1; AGAP14P"},"children":["MSMB; NCOA4; AGAP7P; TIMM23..."]},{"name":"span","attribs":{"title":"STAM; STAM-AS1; CCNY"},"children":["STAM; STAM-AS1; CCNY"]},{"name":"span","attribs":{"title":"HK1; TSPAN15; TACR2"},"children":["HK1; TSPAN15; TACR2"]},{"name":"span","attribs":{"title":"ADK; KAT6B"},"children":["ADK; KAT6B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"RAB18"},"children":["RAB18"]},{"name":"span","attribs":{"title":"KAT6B; ADK"},"children":["KAT6B; ADK"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"KCNMA1"},"children":["KCNMA1"]},{"name":"span","attribs":{"title":"BICC1"},"children":["BICC1"]},{"name":"span","attribs":{"title":"LCOR"},"children":["LCOR"]},{"name":"span","attribs":{"title":"BMPR1A; SNCG; SHLD2; MMRN2; ADIRF-AS1; GLUD1"},"children":["BMPR1A; SNCG; SHLD2; MMRN2;..."]},{"name":"span","attribs":{"title":"ANAPC16; DDIT4; ASCC1; DNAJB12"},"children":["ANAPC16; DDIT4; ASCC1; DNAJB12"]},{"name":"span","attribs":{"title":"DIP2C"},"children":["DIP2C"]},{"name":"span","attribs":{"title":"ANK3"},"children":["ANK3"]},{"name":"span","attribs":{"title":"CALML5; CALML3-AS1"},"children":["CALML5; CALML3-AS1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"FAM241B"},"children":["FAM241B"]},{"name":"span","attribs":{"title":"CACNB2"},"children":["CACNB2"]},{"name":"span","attribs":{"title":"ADK"},"children":["ADK"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"SLK; STN1; COL17A1"},"children":["SLK; STN1; COL17A1"]},{"name":"span","attribs":{"title":"PIP4K2A"},"children":["PIP4K2A"]},{"name":"span","attribs":{"title":"ATP5F1C; TAF3; GATA3"},"children":["ATP5F1C; TAF3; GATA3"]},{"name":"span","attribs":{"title":"FRA10AC1; PLCE1; NOC3L; TBC1D12"},"children":["FRA10AC1; PLCE1; NOC3L; TBC..."]},{"name":"span","attribs":{"title":"LINC00595"},"children":["LINC00595"]},{"name":"span","attribs":{"title":"CEP55; MYOF"},"children":["CEP55; MYOF"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"SCD; OLMALINC; CWF19L1; BLOC1S2; SEC31B; SLF2"},"children":["SCD; OLMALINC; CWF19L1; BLO..."]},{"name":"span","attribs":{"title":"ALDOAP2"},"children":["ALDOAP2"]},{"name":"span","attribs":{"title":"PPIF; FAM149B1; DNAJC9; AC016394.4; MRPS16; CFAP70; LINC00595"},"children":["PPIF; FAM149B1; DNAJC9; AC0..."]},{"name":"span","attribs":{"title":"CXCL12"},"children":["CXCL12"]},{"name":"span","attribs":{"title":"TNKS2; BTAF1; FGFBP3"},"children":["TNKS2; BTAF1; FGFBP3"]},{"name":"span","attribs":{"title":"SCD; OLMALINC; HIF1AN; SEC31B; NDUFB8"},"children":["SCD; OLMALINC; HIF1AN; SEC3..."]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"BTAF1"},"children":["BTAF1"]},{"name":"span","attribs":{"title":"CDK1; ANK3"},"children":["CDK1; ANK3"]},{"name":"span","attribs":{"title":"SEC23IP; MCMBP"},"children":["SEC23IP; MCMBP"]},{"name":"span","attribs":{"title":"CEP55; MYOF"},"children":["CEP55; MYOF"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PAX2; SLF2; SEMA4G; TWNK; LZTS2; MRPL43; PDZD7"},"children":["PAX2; SLF2; SEMA4G; TWNK; L..."]},{"name":"span","attribs":{"title":"GDI2"},"children":["GDI2"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PARD3; NRP1"},"children":["PARD3; NRP1"]},{"name":"span","attribs":{"title":"SFMBT2"},"children":["SFMBT2"]},{"name":"span","attribs":{"title":"AKR1C4"},"children":["AKR1C4"]},{"name":"span","attribs":{"title":"CTNNA3"},"children":["CTNNA3"]},{"name":"span","attribs":{"title":"KAT6B; SAMD8; VDAC2; DUSP13; ADK"},"children":["KAT6B; SAMD8; VDAC2; DUSP13..."]},{"name":"span","attribs":{"title":"PARD3"},"children":["PARD3"]},{"name":"span","attribs":{"title":"DNAJC1"},"children":["DNAJC1"]},{"name":"span","attribs":{"title":"USP54; PRXL2A; CNNM2"},"children":["USP54; PRXL2A; CNNM2"]},{"name":"span","attribs":{"title":"HECTD2; PPP1R3C"},"children":["HECTD2; PPP1R3C"]},{"name":"span","attribs":{"title":"ZNF248"},"children":["ZNF248"]},{"name":"span","attribs":{"title":"SLC16A9; CCDC6; ANK3"},"children":["SLC16A9; CCDC6; ANK3"]},{"name":"span","attribs":{"title":"SLC16A9; CCDC6; ANK3"},"children":["SLC16A9; CCDC6; ANK3"]},{"name":"span","attribs":{"title":"KIF11; HHEX; EIF2S2P3"},"children":["KIF11; HHEX; EIF2S2P3"]},{"name":"span","attribs":{"title":"PRKG1"},"children":["PRKG1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ARID5B"},"children":["ARID5B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PARD3"},"children":["PARD3"]},{"name":"span","attribs":{"title":"ARID5B; RTKN2"},"children":["ARID5B; RTKN2"]},{"name":"span","attribs":{"title":"ANK3"},"children":["ANK3"]},{"name":"span","attribs":{"title":"RBM17"},"children":["RBM17"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ANK3"},"children":["ANK3"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ZWINT"},"children":["ZWINT"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"CCDC6; ANK3"},"children":["CCDC6; ANK3"]},{"name":"span","attribs":{"title":"RPL17P34; MYOF; CEP55"},"children":["RPL17P34; MYOF; CEP55"]},{"name":"span","attribs":{"title":"TBC1D12"},"children":["TBC1D12"]},{"name":"span","attribs":{"title":"RAB18"},"children":["RAB18"]},{"name":"span","attribs":{"title":"CCAR1; STOX1"},"children":["CCAR1; STOX1"]},{"name":"span","attribs":{"title":"CTNNA3; ANXA2P3"},"children":["CTNNA3; ANXA2P3"]},{"name":"span","attribs":{"title":"RPP30; ANKRD1; KIF20B; PCGF5; PPP1R3C"},"children":["RPP30; ANKRD1; KIF20B; PCGF..."]},{"name":"span","attribs":{"title":"CTNNA3"},"children":["CTNNA3"]},{"name":"span","attribs":{"title":"ALOX5; MSMB; NCOA4; TIMM23"},"children":["ALOX5; MSMB; NCOA4; TIMM23"]},{"name":"span","attribs":{"title":"ZNF438"},"children":["ZNF438"]},{"name":"span","attribs":{"title":"ANK3; CDK1"},"children":["ANK3; CDK1"]},{"name":"span","attribs":{"title":"ANXA2P3"},"children":["ANXA2P3"]},{"name":"span","attribs":{"title":"LARP4B"},"children":["LARP4B"]},{"name":"span","attribs":{"title":"PRXL2A; TSPAN14; FAM149B1; ECD; DNAJC9; CNNM2; NT5C2"},"children":["PRXL2A; TSPAN14; FAM149B1; ..."]},{"name":"span","attribs":{"title":"SVIL2P"},"children":["SVIL2P"]},{"name":"span","attribs":{"title":"KAT6B; ADK"},"children":["KAT6B; ADK"]},{"name":"span","attribs":{"title":"ST8SIA6-AS1; ST8SIA6; CCNY"},"children":["ST8SIA6-AS1; ST8SIA6; CCNY"]},{"name":"span","attribs":{"title":"AL117339.5"},"children":["AL117339.5"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"SGMS1"},"children":["SGMS1"]},{"name":"span","attribs":{"title":"MYPN"},"children":["MYPN"]},{"name":"span","attribs":{"title":"LINC00595; ZMIZ1-AS1; ZMIZ1"},"children":["LINC00595; ZMIZ1-AS1; ZMIZ1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ANK3"},"children":["ANK3"]},{"name":"span","attribs":{"title":"KIAA1217"},"children":["KIAA1217"]},{"name":"span","attribs":{"title":"KAT6B; ADK"},"children":["KAT6B; ADK"]},{"name":"span","attribs":{"title":"CCSER2"},"children":["CCSER2"]},{"name":"span","attribs":{"title":"KLF6"},"children":["KLF6"]},{"name":"span","attribs":{"title":"TAF3; GATA3"},"children":["TAF3; GATA3"]},{"name":"span","attribs":{"title":"AL732437.3"},"children":["AL732437.3"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"TWNK; LZTS2; SFXN3; KAZALD1; PDZD7"},"children":["TWNK; LZTS2; SFXN3; KAZALD1..."]},{"name":"span","attribs":{"title":"KCNMA1"},"children":["KCNMA1"]},{"name":"span","attribs":{"title":"FRMD4A"},"children":["FRMD4A"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"MINPP1; PAPSS2"},"children":["MINPP1; PAPSS2"]},{"name":"span","attribs":{"title":"EDRF1; ALDOAP2"},"children":["EDRF1; ALDOAP2"]},{"name":"span","attribs":{"title":"CACNB2; CCNY"},"children":["CACNB2; CCNY"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"USP6NL; ECHDC3"},"children":["USP6NL; ECHDC3"]},{"name":"span","attribs":{"title":"NEBL"},"children":["NEBL"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"DCLRE1C"},"children":["DCLRE1C"]},{"name":"span","attribs":{"title":"TET1; COX20P1; CCAR1"},"children":["TET1; COX20P1; CCAR1"]},{"name":"span","attribs":{"title":"DNMBP"},"children":["DNMBP"]},{"name":"span","attribs":{"title":"PAPSS2; ATAD1"},"children":["PAPSS2; ATAD1"]},{"name":"span","attribs":{"title":"MINPP1; PAPSS2"},"children":["MINPP1; PAPSS2"]},{"name":"span","attribs":{"title":"KIAA1217"},"children":["KIAA1217"]},{"name":"span","attribs":{"title":"ARMC3; DNAJC1; COMMD3; BMI1; PIP4K2A"},"children":["ARMC3; DNAJC1; COMMD3; BMI1..."]},{"name":"span","attribs":{"title":"SFMBT2"},"children":["SFMBT2"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"FAM107B"},"children":["FAM107B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PPIF; FAM149B1; DNAJC9; AC016394.4; MRPS16; CFAP70; LINC00595"},"children":["PPIF; FAM149B1; DNAJC9; AC0..."]},{"name":"span","attribs":{"title":"DIP2C; LARP4B"},"children":["DIP2C; LARP4B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"MSMB; CXCL12; RASSF4; ZNF22; C10orf25; MARCHF8; ZFAND4; AL356056.2; SYT15; FO681492.1; AGAP14P"},"children":["MSMB; CXCL12; RASSF4; ZNF22..."]}],"minWidth":150}],"filterable":true,"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[10,20,50,200],"paginationType":"numbers","showPageInfo":true,"minRows":1,"borderless":true,"dataKey":"66cc36c112d7421fb53f6caccfc79a0e","key":"66cc36c112d7421fb53f6caccfc79a0e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
<div id="inspection-of-top-ranked-regions" class="section level2 tabset">
<h2 class="tabset">Inspection of Top-Ranked Regions</h2>
<pre class="r"><code>## Define a GRL with the key ranges.
## Then we can step through it &amp; make all of the requisite plots
grl_to_plot &lt;- GRangesList(
  top_up_by_fdr = merged_results %&gt;% 
    filter(logFC &gt; 0) %&gt;% 
    filter(!!sym(fdr_column) == min(!!sym(fdr_column))),
  top_up_by_lfc = merged_results %&gt;% 
    filter(logFC == max(logFC)),
  top_up_by_expr = merged_results %&gt;% 
    filter(logFC &gt; 0, !!sym(fdr_column) &lt; fdr_alpha) %&gt;% 
    filter(AveExpr == max(AveExpr)),
  top_up_no_macs2 = merged_results %&gt;% 
    filter(logFC &gt; 0, !!sym(fdr_column) &lt; fdr_alpha, !overlaps_ref) %&gt;% 
    arrange(!!sym(fdr_column)),
  top_down_by_fdr = merged_results %&gt;% 
    filter(logFC &lt; 0) %&gt;% 
    filter(!!sym(fdr_column) == min(!!sym(fdr_column))),
  top_down_by_lfc = merged_results %&gt;% 
    filter(logFC == min(logFC)),
  top_down_by_expr = merged_results %&gt;% 
    filter(logFC &lt; 0, !!sym(fdr_column) &lt; fdr_alpha) %&gt;% 
    filter(AveExpr == max(AveExpr)),
  top_up_no_macs2 = merged_results %&gt;% 
    filter(logFC &lt; 0, !!sym(fdr_column) &lt; fdr_alpha, !overlaps_ref) %&gt;% 
    arrange(!!sym(fdr_column)) 
) %&gt;% 
  unlist() %&gt;% 
  .[!duplicated(.)] %&gt;% 
  splitAsList(names(.)) %&gt;% 
  lapply(setNames, c()) %&gt;% 
  lapply(function(x) x[1]) %&gt;% 
  GRangesList()</code></pre>
<pre class="r"><code>## The coverage
bwfl &lt;- list2(
  &quot;{target}&quot; := file.path(
    bw_path, glue(&quot;{treat_levels}_merged_treat_pileup.bw&quot;)
  ) %&gt;% 
    BigWigFileList() %&gt;% 
    setNames(treat_levels)
)
line_col &lt;- list2(&quot;{target}&quot; := treat_colours)
## Coverage annotations
annot &lt;- merged_results %&gt;% 
  splitAsList(.$status) %&gt;% 
  .[vapply(., length, integer(1)) &gt; 0] %&gt;% 
  endoapply(granges) %&gt;% 
  list() %&gt;% 
  setNames(target)
## Coverage y-limits
ind &lt;- filtered_counts %&gt;% 
  assay(&quot;counts&quot;) %&gt;% 
  apply(MARGIN = 2, which.max) %&gt;%
  unique()
max_ranges &lt;- rowRanges(filtered_counts[ind])
y_lim &lt;- bwfl[[target]] %&gt;%
  lapply(import.bw, which = max_ranges) %&gt;%
  lapply(function(x) c(0, max(x$score))) %&gt;% 
  unlist() %&gt;% 
  range() %&gt;% 
  list() %&gt;% 
  setNames(target)

## The features track
feat_gr &lt;- gene_regions %&gt;% 
  lapply(granges) %&gt;% 
  GRangesList()
feature_colours &lt;- colours$regions
if (has_features) {
  feat_gr &lt;- feat_gr %&gt;% 
    c(
      splitAsList(external_features, external_features$feature)
    )
  feature_colours &lt;- c(feature_colours, colours$features)
}

## The genes track
hfgc_genes &lt;- trans_models
gene_col &lt;- &quot;grey&quot;
if (any_detected){
  rna_lfc_col &lt;- colnames(rnaseq)[str_detect(str_to_lower(colnames(rnaseq)), &quot;logfc&quot;)][1]
  rna_fdr_col &lt;- colnames(rnaseq)[str_detect(str_to_lower(colnames(rnaseq)), &quot;fdr|adjp&quot;)][1]
  if (!is.na(rna_lfc_col) &amp; !is.na(rna_fdr_col)) {
    hfgc_genes &lt;- trans_models %&gt;% 
      mutate(
        status = case_when(
          !gene %in% rnaseq$gene_id ~ &quot;Undetected&quot;,
          gene %in% dplyr::filter(
            rnaseq, !!sym(rna_lfc_col) &gt; 0, !!sym(rna_fdr_col) &lt; fdr_alpha
          )$gene_id ~ &quot;Up&quot;,
          gene %in% dplyr::filter(
            rnaseq, !!sym(rna_lfc_col) &lt; 0, !!sym(rna_fdr_col) &lt; fdr_alpha
          )$gene_id ~ &quot;Down&quot;,
          gene %in% dplyr::filter(
            rnaseq, !!sym(rna_fdr_col) &gt;= fdr_alpha
          )$gene_id ~ &quot;Unchanged&quot;,
        )
      ) %&gt;% 
      splitAsList(.$status) %&gt;% 
      lapply(select, -status) %&gt;% 
      GRangesList()
    gene_col &lt;- colours$direction %&gt;% 
      setNames(str_to_title(names(.)))
  }
}

## External Coverage (Optional)
if (!is.null(config$external$coverage)) {
  ext_cov_path &lt;- config$external$coverage %&gt;% 
    lapply(unlist) %&gt;% 
    lapply(function(x) setNames(here::here(x), names(x)))
  bwfl &lt;- c(
    bwfl[target],
    lapply(ext_cov_path, function(x) BigWigFileList(x) %&gt;% setNames(names(x)))
  )
  line_col &lt;- c(
    line_col[target],
    ext_cov_path %&gt;% 
      lapply(
        function(x) {
          missing &lt;- setdiff(names(x), names(treat_colours))
          cmn &lt;- intersect(names(x), names(treat_colours))
          col &lt;- setNames(character(length(names(x))), names(x))
          if (length(cmn) &gt; 0) col[cmn] &lt;- treat_colours[cmn]
          if (length(missing) &gt; 0) 
            col[missing] &lt;- hcl.colors(
              max(5, length(missing)), &quot;Zissou 1&quot;)[seq_along(missing)]
          col
        }
      )
  )
  
  y_ranges &lt;- grl_to_plot %&gt;% 
    unlist() %&gt;% 
    granges() %&gt;% 
    resize(w = 10 * width(.), fix = &#39;center&#39;)
  
  y_lim &lt;- c(
    y_lim[target],
    bwfl[names(bwfl) != target] %&gt;% 
      lapply(
        function(x) {
          GRangesList(lapply(x, import.bw, which = y_ranges)) %&gt;% 
            unlist() %&gt;% 
            filter(score == max(score)) %&gt;% 
            mcols() %&gt;% 
            .[[&quot;score&quot;]] %&gt;% 
            c(0) %&gt;% 
            range()
        }
      )
  )
  
}</code></pre>
<pre class="r"><code>makeCaption &lt;- function(.gr) {
  if (is.null(.gr)) return(NULL)
  dir &lt;- ifelse(.gr$direction == &quot;Down&quot;, &#39;decreased&#39;, &#39;increased&#39;)
  reg &lt;- case_when(
    str_detect(.gr$region, &quot;Inter&quot;) ~ paste(&quot;an&quot;, .gr$region, &quot;region&quot;),
    str_detect(.gr$region, &quot;Upstream&quot;) ~ paste(&quot;an&quot;, .gr$region),
    str_detect(.gr$region, &quot;(Ex|Intr)on&quot;) ~ paste(&quot;an&quot;, .gr$region),
    str_detect(.gr$region, &quot;^Prom&quot;) ~ paste(&quot;a&quot;, .gr$region)
  )
  feat &lt;- c()
  if (has_features) feat &lt;- case_when(
    str_detect(.gr$feature, &quot;^[AEIOU]&quot;) ~ paste(&quot;an&quot;, .gr$feature),
    !str_detect(.gr$feature, &quot;^[AEIOU]&quot;) ~ paste(&quot;a&quot;, .gr$feature)
  )
  gn &lt;- unlist(.gr$gene_name)
  cp &lt;- c(
    glue(
      &quot;*The {width(.gr)}bp region showing {dir} {target} binding in response to &quot;, 
      &quot;{treat_levels[[2]]} treatment (FDR = {sprintf(&#39;%.2e&#39;, mcols(.gr)[[fdr_column]])}). &quot;,
      &quot;The range mostly overlapped with {reg}, with all &quot;,
      &quot;defined regions shown as a contiguous bar. &quot;,
      ifelse(
        has_features,
        glue(
          &quot;Using the features supplied in {basename(config$external$features)}, &quot;,
          &quot;this mostly overlapped {feat}, shown as a separate block &quot;,
          &quot;with the gene-centric regions. &quot;
        ),
        glue(&quot;&quot;)
      ),
    ),
    ifelse(
      .gr$overlaps_ref,
      paste(
        &quot;A consensus peak overlapping this region was identified by&quot;,
        &quot;`macs2 callpeak` when using merged samples.&quot;
      ),
      &quot;No consensus peak was identified using `macs2 callpeak`.&quot;
    ),
    ifelse(
      length(gn) &gt; 0,
      paste0(
        &quot;Using the above mapping strategy, this range is likely to regulate &quot;,
        collapseGenes(gn, format = &quot;&quot;)
      ),
      &quot;No genes were able to be assigned to this region.&quot;
    ),
    paste(
      &quot;For each sample, the y-axis limits represent the values from the window&quot;, 
      &quot;with the highest signal.*&quot;
    )
  )
  paste(cp, collapse = &quot; &quot;)
}</code></pre>
<div id="normalised-sliding-windows" class="section level3">
<h3>Normalised Sliding Windows</h3>
<pre class="r"><code>grl_to_plot %&gt;% 
  lapply(
    function(x){
      filtered_counts %&gt;% 
        subsetByOverlaps(x) %&gt;% 
        assay(&quot;qsmooth&quot;) %&gt;% 
        as_tibble(rownames = &quot;window&quot;) %&gt;% 
        pivot_longer(
          cols = all_of(colnames(filtered_counts)),
          names_to = &quot;sample&quot;,
          values_to = &quot;logCPM&quot;
        ) %&gt;% 
        mutate(range = as.character(x)) %&gt;% 
        list()
    }
  ) %&gt;% 
  as_tibble() %&gt;% 
  pivot_longer(everything()) %&gt;% 
  unnest(everything()) %&gt;% 
  mutate(
    direction = str_extract(name, &quot;down|up&quot;),
    by = str_extract(name, &quot;by_.+&quot;),
    across(
      all_of(c(&quot;name&quot;, &quot;direction&quot;, &quot;by&quot;)), str_sep_to_title
    ),
    name = str_remove_all(name, &quot;Top &quot;) %&gt;% 
      str_replace_all(&quot;Lfc&quot;, &quot;logFC&quot;) %&gt;% 
      str_replace_all(&quot;Fdr&quot;, &quot;FDR&quot;) %&gt;% 
      str_replace_all(&quot;Expr&quot;, &quot;Highest Signal&quot;) %&gt;% 
      str_replace_all(&quot;By (.+)&quot;, &quot;(\\1)&quot;) %&gt;% 
      str_replace_all(&quot;No Macs2&quot;, &quot;(No Macs2 Peak)&quot;),
    window = as.integer(window)
  ) %&gt;% 
  left_join(samples, by = &quot;sample&quot;) %&gt;% 
  ggplot(
    aes(window, logCPM, colour = treat, linetype = !!sym(rep_col))
  ) +
  geom_line(
    data = . %&gt;% 
      group_by(name) %&gt;% 
      dplyr::filter(max(window) &gt; 1)
  ) + 
  geom_point(
    data = . %&gt;% 
      group_by(name) %&gt;% 
      dplyr::filter(max(window) == 1),
    show.legend = FALSE
  ) + 
  facet_wrap(~name + range, scales = &quot;free_x&quot;) +
  scale_colour_manual(values = treat_colours) + 
  labs(
    x = &quot;Sliding Window\n(Unmerged)&quot;, y = &quot;SQ-Normalised logCPM&quot;, colour = &quot;Treat&quot;,
    linetype = str_sep_to_title(rep_col)
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-qsmooth-top-ranges-1.png" alt="*Most highly ranked ranges for both gained and decreased AR binding in repsonse to DHT treatment. The smooth-quantile normalised values are shown across the initial set of sliding windows before merging. Ranges were chosen as the most extreme for FDR, Binding Strength (Signal) and logFC. Windows are shown free of the genomic context.*" width="960" />
<p class="caption">
<em>Most highly ranked ranges for both gained and decreased AR binding in repsonse to DHT treatment. The smooth-quantile normalised values are shown across the initial set of sliding windows before merging. Ranges were chosen as the most extreme for FDR, Binding Strength (Signal) and logFC. Windows are shown free of the genomic context.</em>
</p>
</div>
</div>
<div id="decreased-binding-most-extreme" class="section level3">
<h3>Decreased Binding (Most Extreme)</h3>
<pre class="r"><code>plotHFGC(
  grl_to_plot$top_down_by_lfc,
  hic = hic,
  features = feat_gr,featcol = feature_colours,
  genes = hfgc_genes, genecol = gene_col,
  coverage = bwfl, linecol = line_col,
  annotation = annot, 
  annotcol = direction_colours,
  cytobands = bands_df,
  collapseTranscripts = FALSE,
  zoom = 10, 
  max = 10 * width(grl_to_plot$top_down_by_lfc),
  ylim = y_lim,
  featsize = 2,
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-top_down_by_lfc-1.png" alt="*The 400bp region showing increased AR binding in response to DHT treatment (FDR = 6.69e-01). The range mostly overlapped with an Intergenic (&gt;10kb) region, with all defined regions shown as a contiguous bar. Using the features supplied in h3k27ac_features.gtf, this mostly overlapped an Enhancer, shown as a separate block with the gene-centric regions.  No consensus peak was identified using `macs2 callpeak`. Using the above mapping strategy, this range is likely to regulate AL139125.1, AL158210.1, LINC02649, LINC02656, LINP1, PRKCQ, RBM17 and SFMBT2 For each sample, the y-axis limits represent the values from the window with the highest signal.*" width="960" />
<p class="caption">
<em>The 400bp region showing increased AR binding in response to DHT treatment (FDR = 6.69e-01). The range mostly overlapped with an Intergenic (&gt;10kb) region, with all defined regions shown as a contiguous bar. Using the features supplied in h3k27ac_features.gtf, this mostly overlapped an Enhancer, shown as a separate block with the gene-centric regions. No consensus peak was identified using <code>macs2 callpeak</code>. Using the above mapping strategy, this range is likely to regulate AL139125.1, AL158210.1, LINC02649, LINC02656, LINP1, PRKCQ, RBM17 and SFMBT2 For each sample, the y-axis limits represent the values from the window with the highest signal.</em>
</p>
</div>
</div>
<div id="increased-binding-lowest-fdr" class="section level3">
<h3>Increased Binding (Lowest FDR)</h3>
<pre class="r"><code>plotHFGC(
  grl_to_plot$top_up_by_fdr,
  hic = hic,
  features = feat_gr,featcol = feature_colours,
  genes = hfgc_genes, genecol = gene_col,
  coverage = bwfl, linecol = line_col,
  annotation = annot, 
  annotcol = colours$direction %&gt;% 
    setNames(str_to_title(names(.))) %&gt;% 
    .[unique(unlist(lapply(annot, names)))],
  cytobands = bands_df,
  collapseTranscripts = FALSE,
  zoom = 10,
  max = 10 * width(grl_to_plot$top_up_by_fdr),
  ylim = y_lim,
  featsize = 2,
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-top_up_by_fdr-1.png" alt="*The 1000bp region showing increased AR binding in response to DHT treatment (FDR = 2.13e-14). The range mostly overlapped with a Promoter (-1500/+500bp), with all defined regions shown as a contiguous bar. Using the features supplied in h3k27ac_features.gtf, this mostly overlapped a Promoter, shown as a separate block with the gene-centric regions.  A consensus peak overlapping this region was identified by `macs2 callpeak` when using merged samples. Using the above mapping strategy, this range is likely to regulate FAM107B For each sample, the y-axis limits represent the values from the window with the highest signal.*" width="960" />
<p class="caption">
<em>The 1000bp region showing increased AR binding in response to DHT treatment (FDR = 2.13e-14). The range mostly overlapped with a Promoter (-1500/+500bp), with all defined regions shown as a contiguous bar. Using the features supplied in h3k27ac_features.gtf, this mostly overlapped a Promoter, shown as a separate block with the gene-centric regions. A consensus peak overlapping this region was identified by <code>macs2 callpeak</code> when using merged samples. Using the above mapping strategy, this range is likely to regulate FAM107B For each sample, the y-axis limits represent the values from the window with the highest signal.</em>
</p>
</div>
</div>
<div id="significant-increased-binding-no-consensus-peak" class="section level3">
<h3>Significant Increased Binding (No Consensus Peak)</h3>
<pre class="r"><code>plotHFGC(
  grl_to_plot$top_up_no_macs2,
  hic = hic,
  features = feat_gr,featcol = feature_colours,
  genes = hfgc_genes, genecol = gene_col,
  coverage = bwfl, linecol = line_col,
  annotation = annot, 
  annotcol = colours$direction %&gt;% 
    setNames(str_to_title(names(.))) %&gt;% 
    .[unique(unlist(lapply(annot, names)))],
  cytobands = bands_df,
  collapseTranscripts = FALSE,
  zoom = 10,
  max = 10 * width(grl_to_plot$top_up_no_macs2),
  ylim = y_lim,
  featsize = 2,
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-top_up_no_macs2-1.png" alt="*The 800bp region showing increased AR binding in response to DHT treatment (FDR = 5.91e-07). The range mostly overlapped with an Intergenic (&gt;10kb) region, with all defined regions shown as a contiguous bar. Using the features supplied in h3k27ac_features.gtf, this mostly overlapped a Super Enhancer, shown as a separate block with the gene-centric regions.  No consensus peak was identified using `macs2 callpeak`. Using the above mapping strategy, this range is likely to regulate ANAPC16, ASCC1, DDIT4, DDIT4-AS1, DNAJB12, RPL15P14, SNORA36 and Y_RNA For each sample, the y-axis limits represent the values from the window with the highest signal.*" width="960" />
<p class="caption">
<em>The 800bp region showing increased AR binding in response to DHT treatment (FDR = 5.91e-07). The range mostly overlapped with an Intergenic (&gt;10kb) region, with all defined regions shown as a contiguous bar. Using the features supplied in h3k27ac_features.gtf, this mostly overlapped a Super Enhancer, shown as a separate block with the gene-centric regions. No consensus peak was identified using <code>macs2 callpeak</code>. Using the above mapping strategy, this range is likely to regulate ANAPC16, ASCC1, DDIT4, DDIT4-AS1, DNAJB12, RPL15P14, SNORA36 and Y_RNA For each sample, the y-axis limits represent the values from the window with the highest signal.</em>
</p>
</div>
</div>
</div>
</div>
<div id="enrichment-testing" class="section level1 tabset">
<h1 class="tabset">Enrichment Testing</h1>
<pre class="r"><code>msigdb &lt;- msigdbr(species = &quot;Homo sapiens&quot;) %&gt;% 
  dplyr::filter(
    gs_cat %in% unlist(params$msigdb$gs_cat) |
      gs_subcat %in% unlist(params$msigdb$gs_subcat),
    str_detect(ensembl_gene, &quot;^E&quot;)
  ) %&gt;% 
  dplyr::rename(gene_id = ensembl_gene, gene_name = gene_symbol) %&gt;% # For easier integration 
  dplyr::select(-starts_with(&quot;human&quot;), -contains(&quot;entrez&quot;)) %&gt;% 
  dplyr::filter(gene_id %in% genes_gr$gene_id) %&gt;% 
  mutate(gs_url = str_extract(gs_url, &quot;^[^|]+&quot;))
gs_by_gsid &lt;- msigdb %&gt;% 
  split(.$gs_name) %&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unique)
gs_by_geneid &lt;- msigdb %&gt;% 
  split(.$gene_id) %&gt;% 
  lapply(pull, &quot;gs_name&quot;) %&gt;% 
  lapply(unique)</code></pre>
<p>As an initial exploration, the retained windows were compared to pre-defined gene-sets. These were taken from the <code>MSigDB</code> database and the gene-sets used for enrichment testing were:</p>
<pre class="r"><code>msigdb %&gt;% 
  distinct(gs_cat, gs_subcat, gs_name) %&gt;%
  group_by(gs_cat, gs_subcat) %&gt;% 
  summarise(`Gene Sets` = dplyr::n(),.groups = &quot;drop&quot;) %&gt;% 
  dplyr::rename(Category = gs_cat, `Sub-Category` = gs_subcat) %&gt;% 
  mutate(
    Description = case_when(
      Category == &quot;H&quot; ~ &quot;Hallmark Gene-Sets&quot;,
      Category == &quot;C1&quot; ~ &quot;Positional Gene Sets&quot;,
      Category == &quot;C2&quot; ~ str_replace_all(`Sub-Category`, &quot;CP:(.+)&quot;, &quot;Curated Gene-Sets: \\1&quot;),
      str_detect(`Sub-Category`, &quot;TFT&quot;) ~ str_replace_all(`Sub-Category`, &quot;TFT:(.+)&quot;, &quot;Transcription Factor Target Prediction Gene-Sets: \\1&quot;),
      str_detect(`Sub-Category`, &quot;MIR&quot;) ~ str_replace_all(`Sub-Category`, &quot;MIR:(.+)&quot;, &quot;microRNA Target Gene-Sets: \\1&quot;),
      str_detect(`Sub-Category`, &quot;CGN&quot;) ~ &quot;Cancer Gene Neighbourhoods&quot;,
      str_detect(`Sub-Category`, &quot;CM&quot;) ~ &quot;Cancer Modules&quot;,
      str_detect(`Sub-Category`, &quot;GO:BP&quot;) ~ &quot;Gene Ontology: Bological Process&quot;,
      str_detect(`Sub-Category`, &quot;GO:MF&quot;) ~ &quot;Gene Ontology: Molecular Function&quot;,
      str_detect(`Sub-Category`, &quot;GO:CC&quot;) ~ &quot;Gene Ontology: Cellular Component&quot;,
      str_detect(`Sub-Category`, &quot;HPO&quot;) ~ &quot;Human Phenotype Ontology&quot;,
      Category == &quot;C6&quot; ~ &quot;Oncogenic Signature Gene Sets&quot;,
      `Sub-Category` == &quot;IMMUNESIGDB&quot; ~ &quot;ImmuneSigDB Gene Sets&quot;,
      `Sub-Category` == &quot;VAX&quot; ~ &quot;Vaccine Response Gene Sets&quot;,
      Category == &quot;C8&quot; ~ &quot;Cell Type Signature Gene Sets&quot;
    ),
    Category = factor(Category, levels = c(&quot;H&quot;, paste0(&quot;C&quot;, 1:8)))
  ) %&gt;% 
  droplevels() %&gt;% 
  arrange(Category) %&gt;% 
  pander(
    justify = &quot;llrl&quot;, 
    caption = &quot;*Summary of Gene-Sets used for Enrichment Testing*&quot;
  )</code></pre>
<table style="width:99%;">
<caption><em>Summary of Gene-Sets used for Enrichment Testing</em></caption>
<colgroup>
<col width="15%" />
<col width="25%" />
<col width="16%" />
<col width="41%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Category</th>
<th align="left">Sub-Category</th>
<th align="right">Gene Sets</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">H</td>
<td align="left"></td>
<td align="right">50</td>
<td align="left">Hallmark Gene-Sets</td>
</tr>
<tr class="even">
<td align="left">C2</td>
<td align="left">CP:KEGG</td>
<td align="right">186</td>
<td align="left">Curated Gene-Sets: KEGG</td>
</tr>
<tr class="odd">
<td align="left">C2</td>
<td align="left">CP:REACTOME</td>
<td align="right">1,615</td>
<td align="left">Curated Gene-Sets: REACTOME</td>
</tr>
<tr class="even">
<td align="left">C2</td>
<td align="left">CP:WIKIPATHWAYS</td>
<td align="right">664</td>
<td align="left">Curated Gene-Sets: WIKIPATHWAYS</td>
</tr>
<tr class="odd">
<td align="left">C3</td>
<td align="left">TFT:GTRD</td>
<td align="right">517</td>
<td align="left">Transcription Factor Target Prediction Gene-Sets: GTRD</td>
</tr>
</tbody>
</table>
<p>Retained windows were tested for enrichment of these gene-sets using:</p>
<ol style="list-style-type: decimal">
<li>Any window mapped to a gene from these gene-sets</li>
<li>Any window with evidence of differential binding mapped to a gene from these gene-sets</li>
</ol>
<p>In the first case, mapped genes were tested for enrichment against all annotated genes. In the second case, i.e. Differentially Bound Windows, the control set of genes were those mapped to a window (i.e. those test set from step 1). All enrichment testing ws performed using <code>goseq</code> with gene-length as the bias term to offset biased sampling of genes</p>
<div id="windows-with-detected-ar" class="section level2">
<h2>Windows With Detected AR</h2>
<pre class="r"><code>pwf_mapped &lt;- genes_gr %&gt;% 
  mutate(w = width(.)) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::select(gene_id, w) %&gt;% 
  arrange(desc(w)) %&gt;% 
  distinct(gene_id, .keep_all = TRUE) %&gt;% 
  mutate(mapped = gene_id %in% unlist(merged_results$gene_id)) %&gt;% 
  with(
    nullp(
      structure(mapped, names = gene_id),
      genome = config$genome$build,
      bias.data = log10(w),
      plot.fit = FALSE
    )
  )
goseq_mapped &lt;- goseq(
  pwf_mapped, config$genome$build, gene2cat = gs_by_geneid
) %&gt;% 
  dplyr::rename(gs_name = category, pval = over_represented_pvalue) %&gt;% 
  dplyr::select(-starts_with(&quot;under&quot;)) %&gt;% 
  as_tibble() %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(numDEInCat &gt; 0) %&gt;% 
  mutate(fdr = p.adjust(pval, &quot;fdr&quot;))</code></pre>
<pre class="r"><code>cp &lt;- htmltools::em(
  glue(
    &quot;All {sum(goseq_mapped$fdr &lt; fdr_alpha)} gene sets considered as &quot;, 
    &quot;significantly enriched (FDR &lt; {fdr_alpha}) amongst the merged windows &quot;, 
    &quot;with detectable {target} binding. Genes mapped to a merged window were &quot;,
    &quot;compared to those not mapped to any merged windows.&quot;
  )
)
tbl &lt;- goseq_mapped %&gt;%
  dplyr::filter(fdr &lt; fdr_alpha) %&gt;% 
  left_join(
    dplyr::select(msigdb, gs_name, gene_name, gene_id, gs_url, gs_description),
    by = &quot;gs_name&quot;
  ) %&gt;% 
  dplyr::filter(gene_id %in% unlist(merged_results$gene_id)) %&gt;% 
  dplyr::select(-gene_id) %&gt;% 
  chop(gene_name) %&gt;% 
  mutate(
    gene_name = vapply(gene_name, paste, character(1), collapse = &quot;; &quot;),
    `%` = numDEInCat / numInCat
  ) %&gt;% 
  nest(gs_name = all_of(c(&quot;gs_name&quot;, &quot;gs_url&quot;))) %&gt;% 
  dplyr::select(
    `Gene Set` = gs_name, Description = gs_description,
    `%`, numDEInCat, numInCat, 
    p = pval, FDR = fdr, 
    `Mapped Genes` = gene_name
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list(
      &quot;Gene Set&quot; = colDef(
        minWidth = 150,
        cell = function(value) htmltools::tags$a(
          href = value$gs_url, target = &quot;_blank&quot;, 
          str_replace_all(value$gs_name, &quot;_&quot;, &quot; &quot;)
        ),
        html = TRUE
      ),
      Description = colDef(
        minWidth = 150,
        cell = function(value) with_tooltip(value, width = 100)
      ),
      numDEInCat = colDef(name = &quot;Total Mapped&quot;, maxWidth = 80),
      numInCat = colDef(
        name = &quot;Gene Set Size&quot;,
        maxWidth = 80,
        cell = function(value) comma(value, 1)
      ),
      &quot;%&quot; = colDef(
        name = &quot;% Mapped&quot;,
        cell = function(value) percent(value, 0.1),
        maxWidth = 80
      ),
      p = colDef(
        cell = function(value) {
          ifelse(
            value &lt; 0.001, sprintf(&quot;%.2e&quot;, value), sprintf(&quot;%.3f&quot;, value)
          )
        },
        maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) {
          ifelse(
            value &lt; 0.001, sprintf(&quot;%.2e&quot;, value), sprintf(&quot;%.3f&quot;, value)
          )
        },
        maxWidth = 80
      ),
      &quot;Mapped Genes&quot; = colDef(
        cell = function(value) with_tooltip(value, width = 100),
        minWidth = 150
      )
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>All 1 gene sets considered as significantly enriched (FDR &lt; 0.05) amongst the merged windows with detectable AR binding. Genes mapped to a merged window were compared to those not mapped to any merged windows.</em>
</div>
<div id="htmlwidget-5a2be105c359c454a1fa" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5a2be105c359c454a1fa">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Gene Set":[{"gs_name":["AUTS2_TARGET_GENES"],"gs_url":["http://gtrd.biouml.org/"]}],"Description":["Genes containing one or more binding sites for UniProt:Q8WXX7 (AUTS2) in their promoter regions (TSS -1000,+100 bp) as identified by GTRD version 20.06 ChIP-seq harmonization."],"%":[0.0507726269315673],"numDEInCat":[23],"numInCat":[453],"p":[3.5737236310504e-08],"FDR":[4.73518381114178e-05],"Mapped Genes":["ARHGAP12; ASCC1; BMI1; COMMD3; DDIT4; DNAJB12; FAM241B; GATA3-AS1; HECTD2; IDE; LCOR; MRPL43; NRP1; ODAD2; PARD3; PARD3-AS1; PFKP; PIP4K2A; STN1; SVIL; TWNK; ZFAND4; ZMIZ1"]},"columns":[{"accessor":"Gene Set","name":"Gene Set","type":"list","cell":[{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["AUTS2 TARGET GENES"]}],"html":true,"minWidth":150},{"accessor":"Description","name":"Description","type":"character","cell":[{"name":"span","attribs":{"title":"Genes containing one or more binding sites for UniProt:Q8WXX7 (AUTS2) in their promoter regions (TSS -1000,+100 bp) as identified by GTRD version 20.06 ChIP-seq harmonization."},"children":["Genes containing one or more binding sites for UniProt:Q8WXX7 (AUTS2) in their promoter regions (..."]}],"minWidth":150},{"accessor":"%","name":"% Mapped","type":"numeric","cell":["5.1%"],"maxWidth":80},{"accessor":"numDEInCat","name":"Total Mapped","type":"numeric","maxWidth":80},{"accessor":"numInCat","name":"Gene Set Size","type":"numeric","cell":["453"],"maxWidth":80},{"accessor":"p","name":"p","type":"numeric","cell":["3.57e-08"],"maxWidth":80},{"accessor":"FDR","name":"FDR","type":"numeric","cell":["4.74e-05"],"maxWidth":80},{"accessor":"Mapped Genes","name":"Mapped Genes","type":"character","cell":[{"name":"span","attribs":{"title":"ARHGAP12; ASCC1; BMI1; COMMD3; DDIT4; DNAJB12; FAM241B; GATA3-AS1; HECTD2; IDE; LCOR; MRPL43; NRP1; ODAD2; PARD3; PARD3-AS1; PFKP; PIP4K2A; STN1; SVIL; TWNK; ZFAND4; ZMIZ1"},"children":["ARHGAP12; ASCC1; BMI1; COMMD3; DDIT4; DNAJB12; FAM241B; GATA3-AS1; HECTD2; IDE; LCOR; MRPL43; NRP..."]}],"minWidth":150}],"filterable":true,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"f60ccb583c4a77a73fd07f2730bf7dbe","key":"f60ccb583c4a77a73fd07f2730bf7dbe"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="windows-with-differentially-bound-ar" class="section level2">
<h2>Windows With Differentially Bound AR</h2>
<pre class="r"><code>pwf_diff &lt;- genes_gr %&gt;% 
  mutate(w = width(.)) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::select(gene_id, w) %&gt;% 
  dplyr::filter(gene_id %in% unlist(merged_results$gene_id)) %&gt;% 
  arrange(desc(w)) %&gt;% 
  distinct(gene_id, .keep_all = TRUE) %&gt;% 
  mutate(
    diff = gene_id %in% unlist(
      subset(merged_results, status != &quot;Unchanged&quot;)$gene_id
    )
  ) %&gt;% 
  with(
    nullp(
      structure(diff, names = gene_id),
      genome = config$genome$build,
      bias.data = log10(w),
      plot.fit = FALSE
    )
  )
goseq_diff &lt;- goseq(
  pwf_diff, config$genome$build, gene2cat = gs_by_geneid
) %&gt;% 
  dplyr::rename(gs_name = category, pval = over_represented_pvalue) %&gt;% 
  dplyr::select(-starts_with(&quot;under&quot;)) %&gt;% 
  as_tibble() %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(numDEInCat &gt; 0) %&gt;% 
  mutate(fdr = p.adjust(pval, &quot;fdr&quot;))</code></pre>
<p>No enrichment was found amongst genes mapped to sites showing any differential binding.</p>
</div>
<div id="windows-with-increased-ar-binding" class="section level2">
<h2>Windows With Increased AR Binding</h2>
<pre class="r"><code>pwf_up &lt;- genes_gr %&gt;% 
  mutate(w = width(.)) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::select(gene_id, w) %&gt;% 
  dplyr::filter(gene_id %in% unlist(merged_results$gene_id)) %&gt;% 
  arrange(desc(w)) %&gt;% 
  distinct(gene_id, .keep_all = TRUE) %&gt;% 
  mutate(
    diff = gene_id %in% unlist(
      subset(merged_results, status == &quot;Up&quot;)$gene_id
    )
  ) %&gt;% 
  with(
    nullp(
      structure(diff, names = gene_id),
      genome = config$genome$build,
      bias.data = log10(w),
      plot.fit = FALSE
    )
  )
goseq_up &lt;- goseq(
  pwf_up, config$genome$build, gene2cat = gs_by_geneid
) %&gt;% 
  dplyr::rename(gs_name = category, pval = over_represented_pvalue) %&gt;% 
  dplyr::select(-starts_with(&quot;under&quot;)) %&gt;% 
  as_tibble() %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(numDEInCat &gt; 0) %&gt;% 
  mutate(fdr = p.adjust(pval, &quot;fdr&quot;))</code></pre>
<p>No enrichment was found amongst genes mapped to sites with increased binding</p>
</div>
<div id="windows-with-decreased-ar-binding" class="section level2">
<h2>Windows With Decreased AR Binding</h2>
<pre class="r"><code>pwf_down &lt;- genes_gr %&gt;% 
  mutate(w = width(.)) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::select(gene_id, w) %&gt;% 
  dplyr::filter(gene_id %in% unlist(merged_results$gene_id)) %&gt;% 
  arrange(desc(w)) %&gt;% 
  distinct(gene_id, .keep_all = TRUE) %&gt;% 
  mutate(
    diff = gene_id %in% unlist(
      subset(merged_results, status == &quot;Down&quot;)$gene_id
    )
  ) %&gt;% 
  with(
    nullp(
      structure(diff, names = gene_id),
      genome = config$genome$build,
      bias.data = log10(w),
      plot.fit = FALSE
    )
  )
goseq_down &lt;- goseq(
  pwf_down, config$genome$build, gene2cat = gs_by_geneid
) %&gt;% 
  dplyr::rename(gs_name = category, pval = over_represented_pvalue) %&gt;% 
  dplyr::select(-starts_with(&quot;under&quot;)) %&gt;% 
  as_tibble() %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(numDEInCat &gt; 0) %&gt;% 
  mutate(fdr = p.adjust(pval, &quot;fdr&quot;))</code></pre>
<p>No enrichment was found amongst genes mapped to sites with decreased binding</p>
</div>
</div>
<div id="comparison-with-rna-seq" class="section level1">
<h1>Comparison With RNA Seq</h1>
<pre class="r"><code>library(fgsea)
rna_status &lt;- rnaseq %&gt;% 
  mutate(
    de_status = case_when(
      !!sym(rna_fdr_col) &lt; fdr_alpha &amp; !!sym(rna_lfc_col) &lt; 0 ~ &quot;Down&quot;,
      !!sym(rna_fdr_col) &lt; fdr_alpha &amp; !!sym(rna_lfc_col) &gt; 0 ~ &quot;Up&quot;,
      !!sym(rna_fdr_col) &gt;= fdr_alpha ~ &quot;Unchanged&quot;
    )
  ) %&gt;% 
  dplyr::select(gene_id, gene_name, de_status) %&gt;% 
  bind_rows(
    genes_gr %&gt;% 
      subset(!gene_id %in% rnaseq$gene_id) %&gt;% 
      select(gene_id, gene_name) %&gt;% 
      mcols() %&gt;% 
      as_tibble() %&gt;% 
      mutate(de_status = &quot;Undetected&quot;)
  ) %&gt;% 
  mutate(
    de_status = factor(
      de_status, levels = str_to_title(names(colours$direction))
    )
  ) %&gt;% 
  arrange(gene_id)
rna_p_col &lt;- colnames(rnaseq)[
  str_detect(str_to_lower(colnames(rnaseq)), &quot;pval|p\\.val&quot;)
][1]
stopifnot(length(rna_p_col) == 1)
diff_windows &lt;- merged_results %&gt;% 
  splitAsList(.$status) %&gt;% 
  lapply(select, gene_id) %&gt;% 
  lapply(mcols) %&gt;% 
  lapply(as_tibble) %&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unlist) %&gt;% 
  lapply(unique)</code></pre>
<div id="relationship-to-detected-genes" class="section level2 tabset">
<h2 class="tabset">Relationship To Detected Genes</h2>
<div id="detected-genes-by-ar-binding-region" class="section level3">
<h3>Detected Genes By AR Binding Region</h3>
<p>Firstly, the distribution of merged windows, where AR was considered as present, was compared to genes within the RNA-Seq dataset. Genes were simply considered as detected if present in the RNA-Seq data, or undetected if not present. Gene-centric regions were as defined previously.</p>
<pre class="r"><code>w &lt;- 0.8
min_p &lt;- 0.05
merged_results %&gt;% 
  mutate(
    any_detected = ifelse(
      vapply(detected, length, integer(1)) &gt; 1,
      &quot;Mapped to Detected Genes&quot;,
      &quot;Mapped to Undetected Genes&quot;
    )
  ) %&gt;% 
  plotPie(fill = &quot;region&quot;, x = &quot;any_detected&quot;, label_size = 4, width = w) +
  geom_text(
    aes(xlab, ylab, label =lab),
    data = . %&gt;% 
      mutate(
        xlab = x + w*(r + 0.1)*sin(label_radians),
        ylab = 1 + w*(r + 0.1)*cos(label_radians),
        lab = glue(&quot;{region}\n{percent(p, 0.1)}&quot;) %&gt;% 
          str_wrap(10)
      ) %&gt;% 
      dplyr::filter(p * N &gt; min_p * max(N)),
    size = 3
  ) +
  geom_segment(
    aes(x_inner, y_inner, xend = x_outer, yend = y_outer),
     data = . %&gt;% 
      mutate(
        x_inner = x + w*r*sin(label_radians),
        y_inner = 1 + w*r*cos(label_radians),
        x_outer = x + w*(r + 0.01)*sin(label_radians),
        y_outer = 1 + w*(r + 0.01)*cos(label_radians),
      ) %&gt;% 
      dplyr::filter(p * N &gt; min_p * max(N))
  ) +
  scale_fill_manual(
    values = colours$regions %&gt;% 
      setNames(regions[names(.)]) 
  ) +
  labs(x = &quot;&quot;, fill = &quot;Region&quot;) +
  theme(panel.grid = element_blank())</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-region-detected-1.png" alt="*Distribution of AR-bound windows by region, according to whether the window is mapped to a detected gene in the RNA-Seq dataset.*" width="960" />
<p class="caption">
<em>Distribution of AR-bound windows by region, according to whether the window is mapped to a detected gene in the RNA-Seq dataset.</em>
</p>
</div>
</div>
<div id="detected-genes-by-feature" class="section level3">
<h3>Detected Genes By Feature</h3>
<pre class="r"><code>merged_results %&gt;% 
  mutate(
    any_detected = ifelse(
      vapply(detected, length, integer(1)) &gt; 1,
      &quot;Mapped to Detected Genes&quot;,
      &quot;Mapped to Undetected Genes&quot;
    )
  ) %&gt;% 
  plotPie(fill = &quot;feature&quot;, x = &quot;any_detected&quot;, label_size = 4, width = w) +
  geom_text(
    aes(xlab, ylab, label =lab),
    data = . %&gt;% 
      mutate(
        xlab = x + w*(r + 0.1)*sin(label_radians),
        ylab = 1 + w*(r + 0.1)*cos(label_radians),
        lab = glue(&quot;{feature}\n{percent(p, 0.1)}&quot;) %&gt;% 
          str_wrap(10)
      ) %&gt;% 
      dplyr::filter(p * N &gt; min_p * max(N)),
    size = 3
  ) +
  geom_segment(
    aes(x_inner, y_inner, xend = x_outer, yend = y_outer),
     data = . %&gt;% 
      mutate(
        x_inner = x + w*r*sin(label_radians),
        y_inner = 1 + w*r*cos(label_radians),
        x_outer = x + w*(r + 0.01)*sin(label_radians),
        y_outer = 1 + w*(r + 0.01)*cos(label_radians),
      ) %&gt;% 
      dplyr::filter(p * N &gt; min_p * max(N))
  ) +
  scale_fill_manual(
    values = colours$features %&gt;% 
      setNames(str_sep_to_title(names(.)))
  ) +
  labs(x = &quot;&quot;, fill = &quot;External Feature&quot;) +
  theme(panel.grid = element_blank())</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-feature-detected-1.png" alt="*Distribution of AR-bound windows by externally-defined features from h3k27ac_features.gtf, according to whether the window is mapped to a detected gene in the RNA-Seq dataset.*" width="960" />
<p class="caption">
<em>Distribution of AR-bound windows by externally-defined features from h3k27ac_features.gtf, according to whether the window is mapped to a detected gene in the RNA-Seq dataset.</em>
</p>
</div>
</div>
</div>
<div id="relationship-to-differentially-expressed-genes" class="section level2 tabset">
<h2 class="tabset">Relationship To Differentially Expressed Genes</h2>
<pre class="r"><code>rna_dir_ranks &lt;- rnaseq %&gt;% 
  mutate(
    ranking_stat = -sign(!!sym(rna_lfc_col))*log10(!!sym(rna_p_col)) %&gt;% 
      setNames(gene_id)
  ) %&gt;% 
  arrange(ranking_stat) %&gt;% 
  dplyr::filter(!!sym(rna_p_col) &lt; 1) %&gt;% 
  pull(&quot;ranking_stat&quot;) 
rna_sig_ranks &lt;- rna_dir_ranks %&gt;% 
  abs() %&gt;% 
  sort()
dir_gs &lt;- merged_results %&gt;% 
  select(status, starts_with(&quot;gene&quot;)) %&gt;% 
  as_tibble() %&gt;% 
  mutate(group = glue(&quot;{target} {status}&quot;)) %&gt;% 
  split(.$group)%&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unlist) %&gt;% 
  lapply(unique) %&gt;% 
  .[vapply(., length, integer(1)) &gt; 20]
reg_dir_gs &lt;- merged_results %&gt;% 
  select(
    overlaps_ref, status, any_of(c(&quot;region&quot;, &quot;feature&quot;)), starts_with(&quot;gene&quot;)
  ) %&gt;% 
  as_tibble() %&gt;% 
  mutate(group = glue(&quot;{region} / {target} {status}&quot;)) %&gt;% 
  split(.$group)%&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unlist) %&gt;% 
  lapply(unique) %&gt;% 
  .[vapply(., length, integer(1)) &gt; 20]
if (has_features) {
  feat_dir_gs &lt;- merged_results %&gt;% 
  select(
    overlaps_ref, status, any_of(c(&quot;feature&quot;)), starts_with(&quot;gene&quot;)
  ) %&gt;% 
  as_tibble() %&gt;% 
  mutate(group = glue(&quot;{feature} / {target} {status}&quot;)) %&gt;% 
  split(.$group)%&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unlist) %&gt;% 
  lapply(unique) %&gt;% 
  .[vapply(., length, integer(1)) &gt; 20]
}</code></pre>
<div id="p-values-by-ar-status" class="section level3">
<h3>P-Values By AR Status</h3>
<pre class="r"><code>y &lt;- ggplot_build(
  tibble(p = rnaseq[[rna_p_col]]) %&gt;% 
    ggplot(aes(p, stat(density))) + 
    geom_histogram(bins = 100) 
) %&gt;% .[[&quot;data&quot;]] %&gt;% 
  .[[1]] %&gt;% 
  .[[&quot;y&quot;]] %&gt;% 
  max()
rnaseq %&gt;% 
  mutate(
    mapped = case_when(
      gene_id %in% unlist(diff_windows[names(diff_windows) %in% c(&quot;Up&quot;, &quot;Down&quot;)]) ~ paste(target, &quot;Differentially Bound&quot;),
      gene_id %in% unlist(diff_windows[names(diff_windows) %in% c(&quot;Unchanged&quot;)]) ~ paste(target, &quot;Unchanged&quot;),
      TRUE ~ paste(&quot;No&quot;, target, &quot;Detected&quot;)
    )
  ) %&gt;% 
  ggplot(
    aes(!!sym(rna_p_col), stat(density))
  ) +
  geom_histogram(
    colour = &quot;black&quot;, fill = &quot;grey&quot;, bins = 100
  ) +
  geom_text(
    aes(0.5, y, label = lab),
    data = . %&gt;% 
      group_by(mapped) %&gt;% 
      tally() %&gt;% 
      mutate(lab = glue(&quot;N = {comma(n, 1)}&quot;))
  ) +
  facet_wrap(~mapped, nrow = 1) +
  scale_y_continuous(expand = expansion(c(0, 0.05)))</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-p-target-1.png" alt="*P-Values for differential expression partitioned by AR ChIP peak status. Genes were considered as being mapped to a differentially bound peak if one or more peaks was considered as differentially bound.*" width="960" />
<p class="caption">
<em>P-Values for differential expression partitioned by AR ChIP peak status. Genes were considered as being mapped to a differentially bound peak if one or more peaks was considered as differentially bound.</em>
</p>
</div>
</div>
</div>
<div id="directional-gsea" class="section level2 tabset">
<h2 class="tabset">Directional GSEA</h2>
<div id="all-windows" class="section level3">
<h3>All Windows</h3>
<pre class="r"><code>gsea_dir &lt;- fgsea(dir_gs, rna_dir_ranks)
gsea_dir_sig &lt;- gsea_dir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; fdr_alpha) %&gt;% 
  as_tibble() 
p &lt;- gsea_dir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(dir_gs[[x]], rna_dir_ranks) +
        ggtitle(x) +
        theme(
          plot.title = element_text(hjust = 0.5, size = 10)
        )
    }
  )</code></pre>
<p>No association was found between AR binding and <em>directional</em> significance in differentially expressed genes.</p>
</div>
<div id="windows-by-region" class="section level3">
<h3>Windows By Region</h3>
<pre class="r"><code>gsea_reg_dir &lt;- fgsea(reg_dir_gs, rna_dir_ranks)
gsea_reg_dir_sig &lt;- gsea_reg_dir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; fdr_alpha) %&gt;% 
  as_tibble() 
p &lt;- gsea_reg_dir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(reg_dir_gs[[x]], rna_dir_ranks) +
        ggtitle(x) +
        theme(
          plot.title = element_text(hjust = 0.5, size = 10)
        )
    }
  )</code></pre>
<p>No association was found between AR binding and <em>directional</em> significance in differentially expressed genes, when incorporating genomic region.</p>
</div>
<div id="windows-by-feature" class="section level3">
<h3>Windows By Feature</h3>
<pre class="r"><code>gsea_feat_dir &lt;- fgsea(feat_dir_gs, rna_dir_ranks)
gsea_feat_dir_sig &lt;- gsea_feat_dir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; fdr_alpha) %&gt;% 
  as_tibble() 
p &lt;- gsea_feat_dir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(feat_dir_gs[[x]], rna_dir_ranks) +
        ggtitle(x) +
        theme(
          plot.title = element_text(hjust = 0.5, size = 10)
        )
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on which &quot;,
    &quot;feature was the best overlap, and the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_feat_dir_sig)} sets of windows were &quot;,
    &quot;associated with changes in gene expression, using the sign of &quot;, 
    &quot;fold-change and ranking statistic to initially rank the &quot;, 
    &quot;{comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_feat_dir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    Direction = ifelse(NES &gt; 0, &quot;\u21E7 Up-regulated&quot;, &quot;\u21E9 Down-regulated&quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    pathway, !!sym(target), Windows = size, Direction, 
    p = pval, FDR = padj, `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      pathway = colDef(
        minWidth = 100, name = &quot;Region&quot;
      ),
      &quot;{target}&quot; := colDef(
        maxWidth = 90,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
          colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80),
      Direction = colDef(
        name = &quot;Gene Direction&quot;,
        maxWidth = 120,
        style = function(value) {
          colour &lt;- ifelse(
            str_detect(value, &quot;Up&quot;), 
            colours$direction[[&quot;up&quot;]], 
            colours$direction[[&quot;down&quot;]]
          )
          list(color = colour)
        },
      ),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on which feature was the best overlap, and the direction of AR binding with DHT treatment. 1 sets of windows were associated with changes in gene expression, using the sign of fold-change and ranking statistic to initially rank the 15,388 genes considered as detected.</em>
</div>
<div id="htmlwidget-00dd38dfd8d49b973bb1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-00dd38dfd8d49b973bb1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"pathway":["Promoter"],"AR":["Up"],"Windows":[53],"Direction":["⇧ Up-regulated"],"p":[0.00127111767952208],"FDR":[0.00635558839761041],"Edge Size":[14],"Leading Edge":["KCNMA1; PPIF; MYPN; CALML5; FAM107B; ANK3; USP54; GLUD1; IDI1; AC022400.6; IDI2-AS1; AL732437.3; WDR37; C10orf25"]},"columns":[{"accessor":"pathway","name":"Region","type":"character","minWidth":100},{"accessor":"AR","name":"AR","type":"character","cell":["⇧ Up"],"maxWidth":90,"style":[{"color":"#CA0020"}]},{"accessor":"Windows","name":"Windows","type":"numeric","maxWidth":80},{"accessor":"Direction","name":"Gene Direction","type":"character","maxWidth":120,"style":[{"color":"#CA0020"}]},{"accessor":"p","name":"p","type":"numeric","cell":["1.27e-03"],"maxWidth":80},{"accessor":"FDR","name":"FDR","type":"numeric","cell":["6.36e-03"],"maxWidth":80},{"accessor":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"accessor":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"KCNMA1; PPIF; MYPN; CALML5; FAM107B; ANK3; USP54; GLUD1; IDI1; AC022400.6; IDI2-AS1; AL732437.3; WDR37; C10orf25"},"children":["KCNMA1; PPIF; MYPN; CALML5; FAM107B; ANK3; USP5..."]}],"minWidth":150}],"filterable":true,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"261fe2f2de25c3070f319e7a8892493c","key":"261fe2f2de25c3070f319e7a8892493c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/barcode-gsea-feat-dir-sig-1.png" alt="*Barcode plots for the top 1 sets of windows associated with __directional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 1 sets of windows associated with <strong>directional</strong> changes in gene expression.</em>
</p>
</div>
</div>
</div>
<div id="non-directional-gsea" class="section level2 tabset">
<h2 class="tabset">Non-Directional GSEA</h2>
<div id="all-windows-1" class="section level3">
<h3>All Windows</h3>
<pre class="r"><code>gsea_nondir &lt;- fgsea(dir_gs, rna_sig_ranks, scoreType = &quot;pos&quot;)
gsea_nondir_sig &lt;- gsea_nondir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; fdr_alpha) %&gt;% 
  as_tibble() 
p &lt;- gsea_nondir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(dir_gs[[x]], rna_sig_ranks) +
        ggtitle(x) +
        theme(plot.title = element_text(hjust = 0.5, size = 10))
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on  &quot;,
    &quot;the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_nondir_sig)} sets of windows were &quot;,
    &quot;associated with changes in gene expression, using only the p-value to &quot;, 
    &quot;rank the {comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_nondir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    !!sym(target), Windows = size, p = pval, FDR = padj, 
    `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      &quot;{target}&quot; := colDef(
        maxWidth = 120,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
           colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on  the direction of AR binding with DHT treatment. 1 sets of windows were associated with changes in gene expression, using only the p-value to rank the 15,388 genes considered as detected.</em>
</div>
<div id="htmlwidget-7b88dadd0944b31f873d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7b88dadd0944b31f873d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"AR":["Up"],"Windows":[216],"p":[0.000654860097235212],"FDR":[0.00130972019447042],"Edge Size":[74],"Leading Edge":["ADRA2A; KCNMA1; PPIF; MYPN; ZWINT; SVIL; CEP55; KIF20B; NEBL; ASB13; RHOBTB1; CALML5; RET; KIF11; OLMALINC; ALOX5; CDK1; SCD; MMRN2; FAM107B; ANK3; RASGEF1A; RTKN2; USP54; LINC00595; SNCG; HECTD2; ZMYND11; GATA3; FGFR2; DDIT4; TET1; GLUD1; SVIL2P; ADIRF-AS1; USP6NL; STOX1; CTNNA3; HHEX; STN1; FRMPD2; IDI1; NOC3L; SLF2; SLC16A12; P4HA1; CACNB2; FAM241B; SEMA4G; ASCC1; NUTM2A; ZMIZ1-AS1; AC022400.6; GSTO1; PDZD7; IDI2-AS1; DCLRE1C; CNNM2; AKR1C4; PPP3CB-AS1; PLCE1; TWNK; DNAJC1; SLC16A9; PRKG1; TSPAN15; MPP7; SYT15; SFMBT2; ABCC2; KAZALD1; DNAJC9; DUSP5; AL732437.3"]},"columns":[{"accessor":"AR","name":"AR","type":"character","cell":["⇧ Up"],"maxWidth":120,"style":[{"color":"#CA0020"}]},{"accessor":"Windows","name":"Windows","type":"numeric","maxWidth":80},{"accessor":"p","name":"p","type":"numeric","cell":["6.55e-04"],"maxWidth":80},{"accessor":"FDR","name":"FDR","type":"numeric","cell":["1.31e-03"],"maxWidth":80},{"accessor":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"accessor":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"ADRA2A; KCNMA1; PPIF; MYPN; ZWINT; SVIL; CEP55; KIF20B; NEBL; ASB13; RHOBTB1; CALML5; RET; KIF11; OLMALINC; ALOX5; CDK1; SCD; MMRN2; FAM107B; ANK3; RASGEF1A; RTKN2; USP54; LINC00595; SNCG; HECTD2; ZMYND11; GATA3; FGFR2; DDIT4; TET1; GLUD1; SVIL2P; ADIRF-AS1; USP6NL; STOX1; CTNNA3; HHEX; STN1; FRMPD2; IDI1; NOC3L; SLF2; SLC16A12; P4HA1; CACNB2; FAM241B; SEMA4G; ASCC1; NUTM2A; ZMIZ1-AS1; AC022400.6; GSTO1; PDZD7; IDI2-AS1; DCLRE1C; CNNM2; AKR1C4; PPP3CB-AS1; PLCE1; TWNK; DNAJC1; SLC16A9; PRKG1; TSPAN15; MPP7; SYT15; SFMBT2; ABCC2; KAZALD1; DNAJC9; DUSP5; AL732437.3"},"children":["ADRA2A; KCNMA1; PPIF; MYPN; ZWINT; SVIL; CEP55;..."]}],"minWidth":150}],"filterable":true,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"270cecaf8458a97bd80c884a4e76c170","key":"270cecaf8458a97bd80c884a4e76c170"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/barcode-gsea-nondir-sig-1.png" alt="*Barcode plots for the top 1 sets of windows associated with __non-directional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 1 sets of windows associated with <strong>non-directional</strong> changes in gene expression.</em>
</p>
</div>
</div>
<div id="windows-by-region-1" class="section level3">
<h3>Windows By Region</h3>
<pre class="r"><code>gsea_reg_nondir &lt;- fgsea(reg_dir_gs, rna_sig_ranks, scoreType = &quot;pos&quot;)
gsea_reg_nondir_sig &lt;- gsea_reg_nondir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; fdr_alpha) %&gt;% 
  as_tibble() 
p &lt;- gsea_reg_nondir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(reg_dir_gs[[x]], rna_sig_ranks) +
        ggtitle(x) +
        theme(plot.title = element_text(hjust = 0.5, size = 10))
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on which &quot;,
    &quot;region was the best overlap, and the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_reg_nondir_sig)} sets of windows were &quot;,
    &quot;associated with changes in gene expression, using only the p-value to &quot;, 
    &quot;rank the {comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_reg_nondir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    pathway, !!sym(target), Windows = size, p = pval, FDR = padj, 
    `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      pathway = colDef(
        minWidth = 100, name = &quot;Region&quot;
      ),
      &quot;{target}&quot; := colDef(
        maxWidth = 80,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
           colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on which region was the best overlap, and the direction of AR binding with DHT treatment. 2 sets of windows were associated with changes in gene expression, using only the p-value to rank the 15,388 genes considered as detected.</em>
</div>
<div id="htmlwidget-2dac98ed3c2a1c7de304" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2dac98ed3c2a1c7de304">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"pathway":["Intergenic (>10kb)","Intergenic (<10kb)"],"AR":["Up","Up"],"Windows":[54,23],"p":[0.000563272886661975,0.00334833102037108],"FDR":[0.00394291020663382,0.0117191585712988],"Edge Size":[21,9],"Leading Edge":["ADRA2A; ZWINT; SVIL; NEBL; ASB13; RHOBTB1; CALML5; KIF11; ALOX5; ANK3; LINC00595; HECTD2; GATA3; DDIT4; USP6NL; CTNNA3; HHEX; STN1; NOC3L; FAM241B; ASCC1","PPIF; NEBL; CALML5; KIF11; RTKN2; LINC00595; SVIL2P; STOX1; HHEX"]},"columns":[{"accessor":"pathway","name":"Region","type":"character","minWidth":100},{"accessor":"AR","name":"AR","type":"character","cell":["⇧ Up","⇧ Up"],"maxWidth":80,"style":[{"color":"#CA0020"},{"color":"#CA0020"}]},{"accessor":"Windows","name":"Windows","type":"numeric","maxWidth":80},{"accessor":"p","name":"p","type":"numeric","cell":["5.63e-04","3.35e-03"],"maxWidth":80},{"accessor":"FDR","name":"FDR","type":"numeric","cell":["3.94e-03","1.17e-02"],"maxWidth":80},{"accessor":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"accessor":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"ADRA2A; ZWINT; SVIL; NEBL; ASB13; RHOBTB1; CALML5; KIF11; ALOX5; ANK3; LINC00595; HECTD2; GATA3; DDIT4; USP6NL; CTNNA3; HHEX; STN1; NOC3L; FAM241B; ASCC1"},"children":["ADRA2A; ZWINT; SVIL; NEBL; ASB13; RHOBTB1; CALM..."]},{"name":"span","attribs":{"title":"PPIF; NEBL; CALML5; KIF11; RTKN2; LINC00595; SVIL2P; STOX1; HHEX"},"children":["PPIF; NEBL; CALML5; KIF11; RTKN2; LINC00595; SV..."]}],"minWidth":150}],"filterable":true,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"274c4fa2d1d95538d7cde43f7623388a","key":"274c4fa2d1d95538d7cde43f7623388a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/barcode-gsea-reg-nondir-sig-1.png" alt="*Barcode plots for the top 2 sets of windows associated with __non-directional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 2 sets of windows associated with <strong>non-directional</strong> changes in gene expression.</em>
</p>
</div>
</div>
<div id="windows-by-feature-1" class="section level3">
<h3>Windows By Feature</h3>
<pre class="r"><code>gsea_feat_nondir &lt;- fgsea(feat_dir_gs, rna_sig_ranks, scoreType = &quot;pos&quot;)
gsea_feat_nondir_sig &lt;- gsea_feat_nondir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; fdr_alpha) %&gt;% 
  as_tibble() 
p &lt;- gsea_feat_nondir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(feat_dir_gs[[x]], rna_sig_ranks) +
        ggtitle(x) +
        theme(
          plot.title = element_text(hjust = 0.5, size = 10)
        )
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on which &quot;,
    &quot;feature was the best overlap, and the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_feat_nondir_sig)} sets of windows were &quot;,
    &quot;associated with overall changes in gene expression, using only the &quot;, 
    &quot;test statistic to rank the &quot;, 
    &quot;{comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_feat_nondir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    Direction = ifelse(NES &gt; 0, &quot;\u21E7 Up-regulated&quot;, &quot;\u21E9 Down-regulated&quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    pathway, !!sym(target), Windows = size, Direction, 
    p = pval, FDR = padj, `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      pathway = colDef(
        minWidth = 100, name = &quot;Region&quot;
      ),
      &quot;{target}&quot; := colDef(
        maxWidth = 90,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
          colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80),
      Direction = colDef(
        name = &quot;Gene Direction&quot;,
        maxWidth = 120,
        style = function(value) {
          colour &lt;- ifelse(
            str_detect(value, &quot;Up&quot;), 
            colours$direction[[&quot;up&quot;]], 
            colours$direction[[&quot;down&quot;]]
          )
          list(color = colour)
        },
      ),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on which feature was the best overlap, and the direction of AR binding with DHT treatment. 2 sets of windows were associated with overall changes in gene expression, using only the test statistic to rank the 15,388 genes considered as detected.</em>
</div>
<div id="htmlwidget-2d37d657c609fe40f3a2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2d37d657c609fe40f3a2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"pathway":["Super Enhancer","Enhancer"],"AR":["Up","Up"],"Windows":[51,161],"Direction":["⇧ Up-regulated","⇧ Up-regulated"],"p":[6.93762578782546e-05,0.00420146779888697],"FDR":[0.000346881289391273,0.0105036694972174],"Edge Size":[20,54],"Leading Edge":["KCNMA1; CEP55; ASB13; RHOBTB1; CALML5; RET; KIF11; OLMALINC; SCD; MMRN2; FAM107B; RASGEF1A; SNCG; HECTD2; ZMYND11; DDIT4; GLUD1; ADIRF-AS1; HHEX; SLF2","ADRA2A; KCNMA1; ZWINT; SVIL; CEP55; KIF20B; NEBL; RHOBTB1; KIF11; OLMALINC; ALOX5; CDK1; SCD; MMRN2; FAM107B; ANK3; RTKN2; USP54; LINC00595; SNCG; GATA3; FGFR2; TET1; GLUD1; SVIL2P; ADIRF-AS1; USP6NL; STOX1; CTNNA3; HHEX; STN1; NOC3L; SLF2; SLC16A12; P4HA1; CACNB2; FAM241B; SEMA4G; NUTM2A; GSTO1; PDZD7; CNNM2; PPP3CB-AS1; PLCE1; TWNK; DNAJC1; SLC16A9; TSPAN15; SYT15; ABCC2; KAZALD1; DNAJC9; DUSP5; PRR26"]},"columns":[{"accessor":"pathway","name":"Region","type":"character","minWidth":100},{"accessor":"AR","name":"AR","type":"character","cell":["⇧ Up","⇧ Up"],"maxWidth":90,"style":[{"color":"#CA0020"},{"color":"#CA0020"}]},{"accessor":"Windows","name":"Windows","type":"numeric","maxWidth":80},{"accessor":"Direction","name":"Gene Direction","type":"character","maxWidth":120,"style":[{"color":"#CA0020"},{"color":"#CA0020"}]},{"accessor":"p","name":"p","type":"numeric","cell":["6.94e-05","4.20e-03"],"maxWidth":80},{"accessor":"FDR","name":"FDR","type":"numeric","cell":["3.47e-04","1.05e-02"],"maxWidth":80},{"accessor":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"accessor":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"KCNMA1; CEP55; ASB13; RHOBTB1; CALML5; RET; KIF11; OLMALINC; SCD; MMRN2; FAM107B; RASGEF1A; SNCG; HECTD2; ZMYND11; DDIT4; GLUD1; ADIRF-AS1; HHEX; SLF2"},"children":["KCNMA1; CEP55; ASB13; RHOBTB1; CALML5; RET; KIF..."]},{"name":"span","attribs":{"title":"ADRA2A; KCNMA1; ZWINT; SVIL; CEP55; KIF20B; NEBL; RHOBTB1; KIF11; OLMALINC; ALOX5; CDK1; SCD; MMRN2; FAM107B; ANK3; RTKN2; USP54; LINC00595; SNCG; GATA3; FGFR2; TET1; GLUD1; SVIL2P; ADIRF-AS1; USP6NL; STOX1; CTNNA3; HHEX; STN1; NOC3L; SLF2; SLC16A12; P4HA1; CACNB2; FAM241B; SEMA4G; NUTM2A; GSTO1; PDZD7; CNNM2; PPP3CB-AS1; PLCE1; TWNK; DNAJC1; SLC16A9; TSPAN15; SYT15; ABCC2; KAZALD1; DNAJC9; DUSP5; PRR26"},"children":["ADRA2A; KCNMA1; ZWINT; SVIL; CEP55; KIF20B; NEB..."]}],"minWidth":150}],"filterable":true,"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"06861d81c233211e746076e5297007a6","key":"06861d81c233211e746076e5297007a6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/barcode-gsea-feat-nondir-sig-1.png" alt="*Barcode plots for the top 2 sets of windows associated with __nondirectional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 2 sets of windows associated with <strong>nondirectional</strong> changes in gene expression.</em>
</p>
</div>
<!-- Could be done regardless of changes in expression -->
</div>
</div>
<div id="highly-ranked-genes" class="section level2 tabset">
<h2 class="tabset">Highly Ranked Genes</h2>
<pre class="r"><code>all_ids &lt;- unlist(merged_results$gene_id)
db_ids &lt;- unlist(filter(merged_results, !!sym(fdr_column) &lt; fdr_alpha)$gene_id)
top_diff_win &lt;- rnaseq %&gt;% 
  mutate(
    n_windows = vapply(
      gene_id,
      function(x) sum(str_detect(all_ids, x)),
      integer(1)
    ),
    n_db_windows = vapply(
      gene_id,
      function(x) sum(str_detect(db_ids, x)),
      integer(1)
    )
  ) %&gt;% 
  arrange(!!sym(rna_p_col)) %&gt;% 
  dplyr::filter(n_windows &gt; 1) %&gt;% 
  dplyr::slice(1:5)
grl_to_plot &lt;- top_diff_win$gene_id %&gt;% 
  sapply(
    function(x) {
      subset(
        merged_results, 
        vapply(gene_id, function(id) x %in% id, logical(1))
      ) %&gt;% 
        granges() %&gt;% 
        ## Restrict this to only sites within 5Mb of a gene
        subsetByOverlaps(
          resize(subset(genes_gr, gene_id == x), width = 1e7, fix = &#39;center&#39;)
        ) %&gt;% 
        c(
          granges(subset(genes_gr, gene_id == x))
        ) %&gt;% 
        unstrand() %&gt;% 
        sort()
    },
    simplify = FALSE
  ) %&gt;% 
  lapply(range) %&gt;% 
  GRangesList()
hfgc_genes &lt;- hfgc_genes[names(hfgc_genes) != &quot;Undetected&quot;]
if (!is.null(config$external$coverage)) {
  y_ranges &lt;- granges(unlist(grl_to_plot))
  y_lim &lt;- c(
    y_lim[target],
    bwfl[names(bwfl) != target] %&gt;% 
      lapply(
        function(x) {
          GRangesList(lapply(x, import.bw, which = y_ranges)) %&gt;% 
            unlist() %&gt;% 
            filter(score == max(score)) %&gt;% 
            mcols() %&gt;% 
            .[[&quot;score&quot;]] %&gt;% 
            c(0) %&gt;% 
            range()
        }
      )
  )
}
i &lt;- 1</code></pre>
<p>Using the ranked list of gens from the RNA-Seq data, the 5 genes most highly ranked for differential expression, with more than one AR-bound window mapped to it were selected for visualisation.</p>
<div id="kcnma1" class="section level3">
<h3>KCNMA1</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours,
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  fontsize = 10,
  max = width(grl_to_plot[[i]]),
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-gene1-1.png" alt="*Region showing all merged AR-bound windows mapped to PPIF. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of PPIF. HiC Interactions are only shown which directly connect AR to PPIF. Gene-centric regions and external features are shown in the top panel. The estimated logFC for PPIF is 2.52 with an FDR of 1.26e-05. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged AR-bound windows mapped to PPIF. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of PPIF. HiC Interactions are only shown which directly connect AR to PPIF. Gene-centric regions and external features are shown in the top panel. The estimated logFC for PPIF is 2.52 with an FDR of 1.26e-05. Undetected and unchanged genes are shown on separate tracks.</em>
</p>
</div>
<pre class="r"><code>i &lt;- i + 1</code></pre>
</div>
<div id="ppif" class="section level3">
<h3>PPIF</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours,
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  max = width(grl_to_plot[[i]]),
  fontsize = 10,
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-gene2-1.png" alt="*Region showing all merged AR-bound windows mapped to CEP55. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of CEP55. HiC Interactions are only shown which directly connect AR to CEP55. Gene-centric regions and external features are shown in the top panel. The estimated logFC for CEP55 is -2.46 with an FDR of 4.60e-04. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged AR-bound windows mapped to CEP55. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of CEP55. HiC Interactions are only shown which directly connect AR to CEP55. Gene-centric regions and external features are shown in the top panel. The estimated logFC for CEP55 is -2.46 with an FDR of 4.60e-04. Undetected and unchanged genes are shown on separate tracks.</em>
</p>
</div>
<pre class="r"><code>i &lt;- i + 1</code></pre>
</div>
<div id="cep55" class="section level3">
<h3>CEP55</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours,
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  max = width(grl_to_plot[[i]]),
  fontsize = 10,
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-gene3-1.png" alt="*Region showing all merged AR-bound windows mapped to NEBL. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of NEBL. HiC Interactions are only shown which directly connect AR to NEBL. Gene-centric regions and external features are shown in the top panel. The estimated logFC for NEBL is 1.24 with an FDR of 6.67e-04. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged AR-bound windows mapped to NEBL. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of NEBL. HiC Interactions are only shown which directly connect AR to NEBL. Gene-centric regions and external features are shown in the top panel. The estimated logFC for NEBL is 1.24 with an FDR of 6.67e-04. Undetected and unchanged genes are shown on separate tracks.</em>
</p>
</div>
<pre class="r"><code>i &lt;- i + 1</code></pre>
</div>
<div id="nebl" class="section level3">
<h3>NEBL</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours,
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  max = width(grl_to_plot[[i]]),
  fontsize = 10,
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-gene4-1.png" alt="*Region showing all merged AR-bound windows mapped to RHOBTB1. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of RHOBTB1. HiC Interactions are only shown which directly connect AR to RHOBTB1. Gene-centric regions and external features are shown in the top panel. The estimated logFC for RHOBTB1 is -1.28 with an FDR of 9.29e-04. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged AR-bound windows mapped to RHOBTB1. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of RHOBTB1. HiC Interactions are only shown which directly connect AR to RHOBTB1. Gene-centric regions and external features are shown in the top panel. The estimated logFC for RHOBTB1 is -1.28 with an FDR of 9.29e-04. Undetected and unchanged genes are shown on separate tracks.</em>
</p>
</div>
<pre class="r"><code>i &lt;- i + 1</code></pre>
</div>
<div id="rhobtb1" class="section level3">
<h3>RHOBTB1</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours,
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  max = width(grl_to_plot[[i]]),
  fontsize = 10,
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="AR_Veh_DHT_differential_binding_files/figure-html/plot-gene5-1.png" alt="*Region showing all merged AR-bound windows mapped to RHOBTB1. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of RHOBTB1. HiC Interactions are only shown which directly connect AR to RHOBTB1. Gene-centric regions and external features are shown in the top panel. The estimated logFC for RHOBTB1 is -1.28 with an FDR of 9.29e-04. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged AR-bound windows mapped to RHOBTB1. Windows considered to be unchanged for AR are annotated in grey, with other colours indicating AR gain or loss. Mapped windows are only shown if within 5Mb of RHOBTB1. HiC Interactions are only shown which directly connect AR to RHOBTB1. Gene-centric regions and external features are shown in the top panel. The estimated logFC for RHOBTB1 is -1.28 with an FDR of 9.29e-04. Undetected and unchanged genes are shown on separate tracks.</em>
</p>
</div>
<!-- ## Gene Expression GSEA -->
</div>
</div>
</div>
<div id="data-export" class="section level1">
<h1>Data Export</h1>
<pre class="r"><code>merged_results %&gt;% 
  as_tibble() %&gt;%
  unnest(all_of(&quot;gene_id&quot;)) %&gt;%
  mutate(gene_name = id2gene[gene_id]) %&gt;% 
  dplyr::select(
    gene_id, gene_name, range, AveExpr, logFC, P.Value, FDR = !!sym(fdr_column), 
    status, any_of(c(&quot;region&quot;, &quot;feature&quot;)), macs2_peak = overlaps_ref,
  ) %&gt;% 
  mutate(
    distance_to_gene = distance(
      GRanges(range),
      setNames(genes_gr, genes_gr$gene_id)[gene_id]
    )
  ) %&gt;% 
  write_csv(all_out$csv)</code></pre>
<pre class="r"><code>write_rds(merged_results, all_out$results, compress = &quot;gz&quot;)
write_rds(filtered_counts, all_out$windows, compress = &quot;gz&quot;)

file.create(all_out$up_regions)
if (length(sig_ranges$Up) &gt; 0) 
  export.bed(granges(sig_ranges$Up), all_out$up_regions)

file.create(all_out$down_regions)
if (length(sig_ranges$Down) &gt; 0) 
  export.bed(granges(sig_ranges$Down), all_out$down_regions)

save.image(all_out$renv)</code></pre>
<p>During this workflow, the following files were exported:</p>
<ul>
<li><strong>results</strong>: output/AR/Veh_DHT_differential_binding.rds</li>
<li><strong>csv</strong>: output/AR/AR_Veh_DHT_differential_binding.csv</li>
<li><strong>windows</strong>: output/AR/Veh_DHT_filtered_windows.rds</li>
<li><strong>up_regions</strong>: output/AR/Veh_DHT_up.bed</li>
<li><strong>down_regions</strong>: output/AR/Veh_DHT_down.bed</li>
<li><strong>renv</strong>: output/envs/AR_Veh_DHT_differential_binding.RData</li>
</ul>
<!-- end of list -->
<button type="button" class="btn btn-default btn-sessioninfo" data-toggle="collapse" data-target="#sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Session information
</button>
</p>
<div id="sessioninfo" class="collapse">
<p><strong>R version 4.1.1 (2021-08-10)</strong></p>
<p><strong>Platform:</strong> x86_64-conda-linux-gnu (64-bit)</p>
<p><strong>locale:</strong> <em>LC_CTYPE=en_AU.UTF-8</em>, <em>LC_NUMERIC=C</em>, <em>LC_TIME=en_AU.UTF-8</em>, <em>LC_COLLATE=en_AU.UTF-8</em>, <em>LC_MONETARY=en_AU.UTF-8</em>, <em>LC_MESSAGES=en_AU.UTF-8</em>, <em>LC_PAPER=en_AU.UTF-8</em>, <em>LC_NAME=C</em>, <em>LC_ADDRESS=C</em>, <em>LC_TELEPHONE=C</em>, <em>LC_MEASUREMENT=en_AU.UTF-8</em> and <em>LC_IDENTIFICATION=C</em></p>
<p><strong>attached base packages:</strong> <em>stats4</em>, <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>utils</em>, <em>datasets</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>fgsea(v.1.20.0)</em>, <em>extraChIPs(v.0.99.0)</em>, <em>goseq(v.1.46.0)</em>, <em>geneLenDataBase(v.1.30.0)</em>, <em>BiasedUrn(v.1.07)</em>, <em>msigdbr(v.7.5.1)</em>, <em>htmltools(v.0.5.2)</em>, <em>reactable(v.0.2.3)</em>, <em>GenomicInteractions(v.1.28.0)</em>, <em>InteractionSet(v.1.22.0)</em>, <em>ggside(v.0.2.0)</em>, <em>rlang(v.1.0.2)</em>, <em>ggrepel(v.0.9.1)</em>, <em>IHW(v.1.22.0)</em>, <em>statmod(v.1.4.36)</em>, <em>magrittr(v.2.0.3)</em>, <em>qsmooth(v.1.10.0)</em>, <em>quantro(v.1.28.0)</em>, <em>scales(v.1.1.1)</em>, <em>edgeR(v.3.36.0)</em>, <em>limma(v.3.50.1)</em>, <em>csaw(v.1.28.0)</em>, <em>SummarizedExperiment(v.1.24.0)</em>, <em>Biobase(v.2.54.0)</em>, <em>MatrixGenerics(v.1.6.0)</em>, <em>matrixStats(v.0.61.0)</em>, <em>ngsReports(v.1.10.0)</em>, <em>cowplot(v.1.1.1)</em>, <em>Rsamtools(v.2.10.0)</em>, <em>Biostrings(v.2.62.0)</em>, <em>XVector(v.0.34.0)</em>, <em>rtracklayer(v.1.54.0)</em>, <em>plyranges(v.1.14.0)</em>, <em>GenomicRanges(v.1.46.1)</em>, <em>GenomeInfoDb(v.1.30.1)</em>, <em>IRanges(v.2.28.0)</em>, <em>S4Vectors(v.0.32.4)</em>, <em>BiocGenerics(v.0.40.0)</em>, <em>yaml(v.2.3.5)</em>, <em>BiocParallel(v.1.28.3)</em>, <em>pander(v.0.6.5)</em>, <em>glue(v.1.6.2)</em>, <em>forcats(v.0.5.1)</em>, <em>stringr(v.1.4.0)</em>, <em>dplyr(v.1.0.8)</em>, <em>purrr(v.0.3.4)</em>, <em>readr(v.2.1.2)</em>, <em>tidyr(v.1.2.0)</em>, <em>tibble(v.3.1.6)</em>, <em>ggplot2(v.3.3.5)</em> and <em>tidyverse(v.1.3.1)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>rappdirs(v.0.3.3)</em>, <em>bumphunter(v.1.36.0)</em>, <em>minfi(v.1.40.0)</em>, <em>bit64(v.4.0.5)</em>, <em>knitr(v.1.38)</em>, <em>DelayedArray(v.0.20.0)</em>, <em>data.table(v.1.14.2)</em>, <em>rpart(v.4.1.16)</em>, <em>KEGGREST(v.1.34.0)</em>, <em>RCurl(v.1.98-1.6)</em>, <em>GEOquery(v.2.62.2)</em>, <em>AnnotationFilter(v.1.18.0)</em>, <em>doParallel(v.1.0.17)</em>, <em>generics(v.0.1.2)</em>, <em>GenomicFeatures(v.1.46.5)</em>, <em>preprocessCore(v.1.56.0)</em>, <em>EnrichedHeatmap(v.1.24.0)</em>, <em>RSQLite(v.2.2.12)</em>, <em>bit(v.4.0.4)</em>, <em>tzdb(v.0.3.0)</em>, <em>xml2(v.1.3.3)</em>, <em>lubridate(v.1.8.0)</em>, <em>assertthat(v.0.2.1)</em>, <em>xfun(v.0.30)</em>, <em>hms(v.1.1.1)</em>, <em>jquerylib(v.0.1.4)</em>, <em>babelgene(v.22.3)</em>, <em>evaluate(v.0.15)</em>, <em>fansi(v.1.0.3)</em>, <em>restfulr(v.0.0.13)</em>, <em>scrime(v.1.3.5)</em>, <em>progress(v.1.2.2)</em>, <em>dbplyr(v.2.1.1)</em>, <em>readxl(v.1.4.0)</em>, <em>igraph(v.1.3.0)</em>, <em>DBI(v.1.1.2)</em>, <em>htmlwidgets(v.1.5.4)</em>, <em>reshape(v.0.8.8)</em>, <em>ellipsis(v.0.3.2)</em>, <em>crosstalk(v.1.2.0)</em>, <em>backports(v.1.4.1)</em>, <em>annotate(v.1.72.0)</em>, <em>biomaRt(v.2.50.3)</em>, <em>sparseMatrixStats(v.1.6.0)</em>, <em>vctrs(v.0.4.0)</em>, <em>here(v.1.0.1)</em>, <em>ensembldb(v.2.18.4)</em>, <em>cachem(v.1.0.6)</em>, <em>withr(v.2.5.0)</em>, <em>ggforce(v.0.3.3)</em>, <em>Gviz(v.1.38.3)</em>, <em>BSgenome(v.1.62.0)</em>, <em>vroom(v.1.5.7)</em>, <em>checkmate(v.2.0.0)</em>, <em>GenomicAlignments(v.1.30.0)</em>, <em>fdrtool(v.1.2.17)</em>, <em>prettyunits(v.1.1.1)</em>, <em>mclust(v.5.4.9)</em>, <em>cluster(v.2.1.3)</em>, <em>lazyeval(v.0.2.2)</em>, <em>crayon(v.1.5.1)</em>, <em>genefilter(v.1.76.0)</em>, <em>labeling(v.0.4.2)</em>, <em>pkgconfig(v.2.0.3)</em>, <em>slam(v.0.1-50)</em>, <em>tweenr(v.1.0.2)</em>, <em>nlme(v.3.1-157)</em>, <em>ProtGenerics(v.1.26.0)</em>, <em>nnet(v.7.3-17)</em>, <em>lifecycle(v.1.0.1)</em>, <em>filelock(v.1.0.2)</em>, <em>BiocFileCache(v.2.2.1)</em>, <em>modelr(v.0.1.8)</em>, <em>dichromat(v.2.0-0)</em>, <em>polyclip(v.1.10-0)</em>, <em>cellranger(v.1.1.0)</em>, <em>rprojroot(v.2.0.3)</em>, <em>reactR(v.0.4.4)</em>, <em>rngtools(v.1.5.2)</em>, <em>base64(v.2.0)</em>, <em>Matrix(v.1.4-1)</em>, <em>lpsymphony(v.1.22.0)</em>, <em>Rhdf5lib(v.1.16.0)</em>, <em>zoo(v.1.8-9)</em>, <em>reprex(v.2.0.1)</em>, <em>base64enc(v.0.1-3)</em>, <em>GlobalOptions(v.0.1.2)</em>, <em>png(v.0.1-7)</em>, <em>viridisLite(v.0.4.0)</em>, <em>rjson(v.0.2.21)</em>, <em>bitops(v.1.0-7)</em>, <em>rhdf5filters(v.1.6.0)</em>, <em>blob(v.1.2.2)</em>, <em>DelayedMatrixStats(v.1.16.0)</em>, <em>shape(v.1.4.6)</em>, <em>doRNG(v.1.8.2)</em>, <em>nor1mix(v.1.3-0)</em>, <em>jpeg(v.0.1-9)</em>, <em>memoise(v.2.0.1)</em>, <em>plyr(v.1.8.7)</em>, <em>zlibbioc(v.1.40.0)</em>, <em>scatterpie(v.0.1.7)</em>, <em>compiler(v.4.1.1)</em>, <em>BiocIO(v.1.4.0)</em>, <em>RColorBrewer(v.1.1-2)</em>, <em>illuminaio(v.0.36.0)</em>, <em>clue(v.0.3-60)</em>, <em>cli(v.3.2.0)</em>, <em>htmlTable(v.2.4.0)</em>, <em>Formula(v.1.2-4)</em>, <em>MASS(v.7.3-56)</em>, <em>mgcv(v.1.8-40)</em>, <em>tidyselect(v.1.1.2)</em>, <em>stringi(v.1.7.6)</em>, <em>highr(v.0.9)</em>, <em>askpass(v.1.1)</em>, <em>locfit(v.1.5-9.5)</em>, <em>latticeExtra(v.0.6-29)</em>, <em>grid(v.4.1.1)</em>, <em>sass(v.0.4.1)</em>, <em>VariantAnnotation(v.1.40.0)</em>, <em>fastmatch(v.1.1-3)</em>, <em>tools(v.4.1.1)</em>, <em>parallel(v.4.1.1)</em>, <em>circlize(v.0.4.14)</em>, <em>rstudioapi(v.0.13)</em>, <em>foreach(v.1.5.2)</em>, <em>foreign(v.0.8-82)</em>, <em>metapod(v.1.2.0)</em>, <em>gridExtra(v.2.3)</em>, <em>farver(v.2.1.0)</em>, <em>digest(v.0.6.29)</em>, <em>quadprog(v.1.5-8)</em>, <em>Rcpp(v.1.0.8.3)</em>, <em>siggenes(v.1.68.0)</em>, <em>broom(v.0.7.12)</em>, <em>httr(v.1.4.2)</em>, <em>ggdendro(v.0.1.23)</em>, <em>AnnotationDbi(v.1.56.2)</em>, <em>biovizBase(v.1.42.0)</em>, <em>ComplexHeatmap(v.2.10.0)</em>, <em>colorspace(v.2.0-3)</em>, <em>rvest(v.1.0.2)</em>, <em>XML(v.3.99-0.9)</em>, <em>fs(v.1.5.2)</em>, <em>splines(v.4.1.1)</em>, <em>multtest(v.2.50.0)</em>, <em>plotly(v.4.10.0)</em>, <em>xtable(v.1.8-4)</em>, <em>jsonlite(v.1.8.0)</em>, <em>ggfun(v.0.0.6)</em>, <em>R6(v.2.5.1)</em>, <em>Hmisc(v.4.6-0)</em>, <em>pillar(v.1.7.0)</em>, <em>fastmap(v.1.1.0)</em>, <em>DT(v.0.22)</em>, <em>beanplot(v.1.2)</em>, <em>codetools(v.0.2-18)</em>, <em>utf8(v.1.2.2)</em>, <em>lattice(v.0.20-45)</em>, <em>bslib(v.0.3.1)</em>, <em>sva(v.3.42.0)</em>, <em>curl(v.4.3.2)</em>, <em>GO.db(v.3.14.0)</em>, <em>openssl(v.2.0.0)</em>, <em>survival(v.3.3-1)</em>, <em>rmarkdown(v.2.13)</em>, <em>munsell(v.0.5.0)</em>, <em>GetoptLong(v.1.0.5)</em>, <em>rhdf5(v.2.38.1)</em>, <em>GenomeInfoDbData(v.1.2.7)</em>, <em>iterators(v.1.0.14)</em>, <em>HDF5Array(v.1.22.1)</em>, <em>haven(v.2.4.3)</em> and <em>gtable(v.0.3.0)</em></p>
</div>
</div>

<div class="footer">
  Workflow developed by:<br>
  Dr Stephen Pederson<br>
  Dame Roma Mitchell Cancer Research Laboratories<br>
  Adelaide Medical School, University of Adelaide, SA, Australia
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
